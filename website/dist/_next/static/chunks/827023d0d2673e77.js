(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,64495,(e,t,r)=>{var i,s;s=i||(i={}),function(t){var r="object"==typeof globalThis?globalThis:e.g,i=n(s);function n(e,t){return function(r,i){Object.defineProperty(e,r,{configurable:!0,writable:!0,value:i}),t&&t(r,i)}}void 0!==r.Reflect&&(i=n(r.Reflect,i)),t(i,r),void 0===r.Reflect&&(r.Reflect=s)}(function(e,t){var r,i=Object.prototype.hasOwnProperty,s="function"==typeof Symbol,n=s&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",o=s&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",a="function"==typeof Object.create,l=({__proto__:[]})instanceof Array,c=!a&&!l,u={create:a?function(){return V(Object.create(null))}:l?function(){return V({__proto__:null})}:function(){return V({})},has:c?function(e,t){return i.call(e,t)}:function(e,t){return t in e},get:c?function(e,t){return i.call(e,t)?e[t]:void 0}:function(e,t){return e[t]}},h=Object.getPrototypeOf(Function),p="function"==typeof Map&&"function"==typeof Map.prototype.entries?Map:function(){var e={},t=[],r=function(){function e(e,t,r){this._index=0,this._keys=e,this._values=t,this._selector=r}return e.prototype["@@iterator"]=function(){return this},e.prototype[o]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var r=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:r,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();function i(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(i.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),i.prototype.has=function(e){return this._find(e,!1)>=0},i.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},i.prototype.set=function(e,t){var r=this._find(e,!0);return this._values[r]=t,this},i.prototype.delete=function(t){var r=this._find(t,!1);if(r>=0){for(var i=this._keys.length,s=r+1;s<i;s++)this._keys[s-1]=this._keys[s],this._values[s-1]=this._values[s];return this._keys.length--,this._values.length--,E(t,this._cacheKey)&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},i.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},i.prototype.keys=function(){return new r(this._keys,this._values,s)},i.prototype.values=function(){return new r(this._keys,this._values,n)},i.prototype.entries=function(){return new r(this._keys,this._values,a)},i.prototype["@@iterator"]=function(){return this.entries()},i.prototype[o]=function(){return this.entries()},i.prototype._find=function(e,t){if(!E(this._cacheKey,e)){this._cacheIndex=-1;for(var r=0;r<this._keys.length;r++)if(E(this._keys[r],e)){this._cacheIndex=r;break}}return this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},i;function s(e,t){return e}function n(e,t){return t}function a(e,t){return[e,t]}}(),d="function"==typeof Set&&"function"==typeof Set.prototype.entries?Set:function(){function e(){this._map=new p}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.keys()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[o]=function(){return this.keys()},e}(),f="function"==typeof WeakMap?WeakMap:function(){var e=u.create(),t=s();function r(){this._key=s()}return r.prototype.has=function(e){var t=n(e,!1);return void 0!==t&&u.has(t,this._key)},r.prototype.get=function(e){var t=n(e,!1);return void 0!==t?u.get(t,this._key):void 0},r.prototype.set=function(e,t){return n(e,!0)[this._key]=t,this},r.prototype.delete=function(e){var t=n(e,!1);return void 0!==t&&delete t[this._key]},r.prototype.clear=function(){this._key=s()},r;function s(){var t;do t="@@WeakMap@@"+function(){var e=function(e){if("function"==typeof Uint8Array){var t=new Uint8Array(16);return"undefined"!=typeof crypto?crypto.getRandomValues(t):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(t):o(t,16),t}return o(Array(16),16)}(0);e[6]=79&e[6]|64,e[8]=191&e[8]|128;for(var t="",r=0;r<16;++r){var i=e[r];(4===r||6===r||8===r)&&(t+="-"),i<16&&(t+="0"),t+=i.toString(16).toLowerCase()}return t}();while(u.has(e,t))return e[t]=!0,t}function n(e,r){if(!i.call(e,t)){if(!r)return;Object.defineProperty(e,t,{value:u.create()})}return e[t]}function o(e,t){for(var r=0;r<t;++r)e[r]=255*Math.random()|0;return e}}(),y=s?Symbol.for("@reflect-metadata:registry"):void 0,g=(!_(y)&&k(t.Reflect)&&Object.isExtensible(t.Reflect)&&(r=t.Reflect[y]),_(r)&&(r=function(){_(y)||void 0===t.Reflect||y in t.Reflect||"function"!=typeof t.Reflect.defineMetadata||(r=(e=t.Reflect).defineMetadata,i=e.hasOwnMetadata,s=e.getOwnMetadata,n=e.getOwnMetadataKeys,o=e.deleteMetadata,a=new f,l={isProviderFor:function(e,t){var r=a.get(e);return!!(!_(r)&&r.has(t))||!!n(e,t).length&&(_(r)&&(r=new d,a.set(e,r)),r.add(t),!0)},OrdinaryDefineOwnMetadata:r,OrdinaryHasOwnMetadata:i,OrdinaryGetOwnMetadata:s,OrdinaryOwnMetadataKeys:n,OrdinaryDeleteMetadata:o});var e,r,i,s,n,o,a,l,c,u,h,g=new f,m={registerProvider:function(e){if(!Object.isExtensible(m))throw Error("Cannot add provider to a frozen registry.");switch(!0){case l===e:break;case _(c):c=e;break;case c===e:break;case _(u):u=e;break;case u===e:break;default:void 0===h&&(h=new d),h.add(e)}},getProvider:v,setProvider:function(e,t,r){if(!function(e){if(_(e))throw TypeError();return c===e||u===e||!_(h)&&h.has(e)}(r))throw Error("Metadata provider not registered.");var i=v(e,t);if(i!==r){if(!_(i))return!1;var s=g.get(e);_(s)&&(s=new p,g.set(e,s)),s.set(t,r)}return!0}};return m;function v(e,t){var r,i=g.get(e);return _(i)||(r=i.get(t)),_(r)&&(r=function(e,t){if(!_(c)){if(c.isProviderFor(e,t))return c;if(!_(u)){if(u.isProviderFor(e,t))return c;if(!_(h))for(var r=I(h);;){var i=T(r);if(!i)return;var s=i.value;if(s.isProviderFor(e,t))return P(r),s}}}if(!_(l)&&l.isProviderFor(e,t))return l}(e,t),_(r)||(_(i)&&(i=new p,g.set(e,i)),i.set(t,r))),r}}()),!_(y)&&k(t.Reflect)&&Object.isExtensible(t.Reflect)&&Object.defineProperty(t.Reflect,y,{enumerable:!1,configurable:!1,writable:!1,value:r}),r),m=function(e){var t=new f,r={isProviderFor:function(e,r){var i=t.get(e);return!_(i)&&i.has(r)},OrdinaryDefineOwnMetadata:function(e,t,r,s){i(r,s,!0).set(e,t)},OrdinaryHasOwnMetadata:function(e,t,r){var s=i(t,r,!1);return!_(s)&&!!s.has(e)},OrdinaryGetOwnMetadata:function(e,t,r){var s=i(t,r,!1);if(!_(s))return s.get(e)},OrdinaryOwnMetadataKeys:function(e,t){var r=[],s=i(e,t,!1);if(_(s))return r;for(var n=I(s.keys()),o=0;;){var a=T(n);if(!a)return r.length=o,r;var l=a.value;try{r[o]=l}catch(e){try{P(n)}finally{throw e}}o++}},OrdinaryDeleteMetadata:function(e,r,s){var n=i(r,s,!1);if(_(n)||!n.delete(e))return!1;if(0===n.size){var o=t.get(r);_(o)||(o.delete(s),0===o.size&&t.delete(o))}return!0}};return g.registerProvider(r),r;function i(i,s,n){var o=t.get(i),a=!1;if(_(o)){if(!n)return;o=new p,t.set(i,o),a=!0}var l=o.get(s);if(_(l)){if(!n)return;if(l=new p,o.set(s,l),!e.setProvider(i,s,r))throw o.delete(s),a&&t.delete(i),Error("Wrong provider for target.")}return l}}(g);function v(e,t,r){var i=D(t,r,!1);return!_(i)&&!!i.OrdinaryHasOwnMetadata(e,t,r)}function b(e,t,r){var i=D(t,r,!1);if(!_(i))return i.OrdinaryGetOwnMetadata(e,t,r)}function x(e,t,r,i){D(r,i,!0).OrdinaryDefineOwnMetadata(e,t,r,i)}function S(e,t){var r=D(e,t,!1);return r?r.OrdinaryOwnMetadataKeys(e,t):[]}function w(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function _(e){return void 0===e}function A(e){return null===e}function k(e){return"object"==typeof e?null!==e:"function"==typeof e}e("decorate",function(e,t,r,i){if(_(r)){if(!B(e)||!j(t))throw TypeError();for(var s=e,n=t,o=s.length-1;o>=0;--o){var a=(0,s[o])(n);if(!_(a)&&!A(a)){if(!j(a))throw TypeError();n=a}}return n}if(!B(e)||!k(t)||!k(i)&&!_(i)&&!A(i))throw TypeError();return A(i)&&(i=void 0),function(e,t,r,i){for(var s=e.length-1;s>=0;--s){var n=(0,e[s])(t,r,i);if(!_(n)&&!A(n)){if(!k(n))throw TypeError();i=n}}return i}(e,t,r=C(r),i)}),e("metadata",function(e,t){return function(r,i){if(!k(r)||!_(i)&&!function(e){switch(w(e)){case 3:case 4:return!0;default:return!1}}(i))throw TypeError();x(e,t,r,i)}}),e("defineMetadata",function(e,t,r,i){if(!k(r))throw TypeError();return _(i)||(i=C(i)),x(e,t,r,i)}),e("hasMetadata",function(e,t,r){if(!k(t))throw TypeError();return _(r)||(r=C(r)),function e(t,r,i){if(v(t,r,i))return!0;var s=U(r);return!A(s)&&e(t,s,i)}(e,t,r)}),e("hasOwnMetadata",function(e,t,r){if(!k(t))throw TypeError();return _(r)||(r=C(r)),v(e,t,r)}),e("getMetadata",function(e,t,r){if(!k(t))throw TypeError();return _(r)||(r=C(r)),function e(t,r,i){if(v(t,r,i))return b(t,r,i);var s=U(r);if(!A(s))return e(t,s,i)}(e,t,r)}),e("getOwnMetadata",function(e,t,r){if(!k(t))throw TypeError();return _(r)||(r=C(r)),b(e,t,r)}),e("getMetadataKeys",function(e,t){if(!k(e))throw TypeError();return _(t)||(t=C(t)),function e(t,r){var i=S(t,r),s=U(t);if(null===s)return i;var n=e(s,r);if(n.length<=0)return i;if(i.length<=0)return n;for(var o=new d,a=[],l=0;l<i.length;l++){var c=i[l],u=o.has(c);u||(o.add(c),a.push(c))}for(var h=0;h<n.length;h++){var c=n[h],u=o.has(c);u||(o.add(c),a.push(c))}return a}(e,t)}),e("getOwnMetadataKeys",function(e,t){if(!k(e))throw TypeError();return _(t)||(t=C(t)),S(e,t)}),e("deleteMetadata",function(e,t,r){if(!k(t)||(_(r)||(r=C(r)),!k(t)))throw TypeError();_(r)||(r=C(r));var i=D(t,r,!1);return!_(i)&&i.OrdinaryDeleteMetadata(e,t,r)});function C(e){var t=function(e,t){switch(w(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var r="string",i=O(e,n);if(void 0!==i){var s=i.call(e,r);if(k(s))throw TypeError();return s}return function(e,t){if("string"===t){var r=e.toString;if(N(r)){var i=r.call(e);if(!k(i))return i}var s=e.valueOf;if(N(s)){var i=s.call(e);if(!k(i))return i}}else{var s=e.valueOf;if(N(s)){var i=s.call(e);if(!k(i))return i}var n=e.toString;if(N(n)){var i=n.call(e);if(!k(i))return i}}throw TypeError()}(e,r)}(e,0);return"symbol"==typeof t?t:""+t}function B(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function N(e){return"function"==typeof e}function j(e){return"function"==typeof e}function E(e,t){return e===t||e!=e&&t!=t}function O(e,t){var r=e[t];if(null!=r){if(!N(r))throw TypeError();return r}}function I(e){var t=O(e,o);if(!N(t))throw TypeError();var r=t.call(e);if(!k(r))throw TypeError();return r}function T(e){var t=e.next();return!t.done&&t}function P(e){var t=e.return;t&&t.call(e)}function U(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===h||t!==h)return t;var r=e.prototype,i=r&&Object.getPrototypeOf(r);if(null==i||i===Object.prototype)return t;var s=i.constructor;return"function"!=typeof s||s===e?t:s}function D(e,t,r){var i=g.getProvider(e,t);if(!_(i))return i;if(r){if(g.setProvider(e,t,m))return m;throw Error("Illegal state.")}}function V(e){return e.__=void 0,delete e.__,e}})},92662,(e,t,r)=>{"use strict";var i=e.i(67034);class s{static isArrayBuffer(e){return"[object ArrayBuffer]"===Object.prototype.toString.call(e)}static toArrayBuffer(e){return this.isArrayBuffer(e)?e:e.byteLength===e.buffer.byteLength||0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:this.toUint8Array(e.buffer).slice(e.byteOffset,e.byteOffset+e.byteLength).buffer}static toUint8Array(e){return this.toView(e,Uint8Array)}static toView(e,t){if(e.constructor===t)return e;if(this.isArrayBuffer(e))return new t(e);if(this.isArrayBufferView(e))return new t(e.buffer,e.byteOffset,e.byteLength);throw TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(e){return this.isArrayBufferView(e)||this.isArrayBuffer(e)}static isArrayBufferView(e){return ArrayBuffer.isView(e)||e&&this.isArrayBuffer(e.buffer)}static isEqual(e,t){let r=s.toUint8Array(e),i=s.toUint8Array(t);if(r.length!==i.byteLength)return!1;for(let e=0;e<r.length;e++)if(r[e]!==i[e])return!1;return!0}static concat(...e){let t;t=!Array.isArray(e[0])||e[1]instanceof Function?Array.isArray(e[0])&&e[1]instanceof Function?e[0]:e[e.length-1]instanceof Function?e.slice(0,e.length-1):e:e[0];let r=0;for(let e of t)r+=e.byteLength;let i=new Uint8Array(r),s=0;for(let e of t){let t=this.toUint8Array(e);i.set(t,s),s+=t.length}return e[e.length-1]instanceof Function?this.toView(i,e[e.length-1]):i.buffer}}let n="string",o=/^[0-9a-f\s]+$/i,a=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/,l=/^[a-zA-Z0-9-_]+$/;class c{static fromString(e){let t=unescape(encodeURIComponent(e)),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r.buffer}static toString(e){let t=s.toUint8Array(e),r="";for(let e=0;e<t.length;e++)r+=String.fromCharCode(t[e]);return decodeURIComponent(escape(r))}}class u{static toString(e,t=!1){let r=s.toArrayBuffer(e),i=new DataView(r),n="";for(let e=0;e<r.byteLength;e+=2)n+=String.fromCharCode(i.getUint16(e,t));return n}static fromString(e,t=!1){let r=new ArrayBuffer(2*e.length),i=new DataView(r);for(let r=0;r<e.length;r++)i.setUint16(2*r,e.charCodeAt(r),t);return r}}class h{static isHex(e){return typeof e===n&&o.test(e)}static isBase64(e){return typeof e===n&&a.test(e)}static isBase64Url(e){return typeof e===n&&l.test(e)}static ToString(e,t="utf8"){let r=s.toUint8Array(e);switch(t.toLowerCase()){case"utf8":return this.ToUtf8String(r);case"binary":return this.ToBinary(r);case"hex":return this.ToHex(r);case"base64":return this.ToBase64(r);case"base64url":return this.ToBase64Url(r);case"utf16le":return u.toString(r,!0);case"utf16":case"utf16be":return u.toString(r);default:throw Error(`Unknown type of encoding '${t}'`)}}static FromString(e,t="utf8"){if(!e)return new ArrayBuffer(0);switch(t.toLowerCase()){case"utf8":return this.FromUtf8String(e);case"binary":return this.FromBinary(e);case"hex":return this.FromHex(e);case"base64":return this.FromBase64(e);case"base64url":return this.FromBase64Url(e);case"utf16le":return u.fromString(e,!0);case"utf16":case"utf16be":return u.fromString(e);default:throw Error(`Unknown type of encoding '${t}'`)}}static ToBase64(e){let t=s.toUint8Array(e);return"undefined"!=typeof btoa?btoa(this.ToString(t,"binary")):i.Buffer.from(t).toString("base64")}static FromBase64(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!h.isBase64(t))throw TypeError("Argument 'base64Text' is not Base64 encoded");return"undefined"!=typeof atob?this.FromBinary(atob(t)):new Uint8Array(i.Buffer.from(t,"base64")).buffer}static FromBase64Url(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!h.isBase64Url(t))throw TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(t.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(e){return this.ToBase64(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(e,t=h.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.FromBinary(e);case"utf8":return c.fromString(e);case"utf16":case"utf16be":return u.fromString(e);case"utf16le":case"usc2":return u.fromString(e,!0);default:throw Error(`Unknown type of encoding '${t}'`)}}static ToUtf8String(e,t=h.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.ToBinary(e);case"utf8":return c.toString(e);case"utf16":case"utf16be":return u.toString(e);case"utf16le":case"usc2":return u.toString(e,!0);default:throw Error(`Unknown type of encoding '${t}'`)}}static FromBinary(e){let t=e.length,r=new Uint8Array(t);for(let i=0;i<t;i++)r[i]=e.charCodeAt(i);return r.buffer}static ToBinary(e){let t=s.toUint8Array(e),r="";for(let e=0;e<t.length;e++)r+=String.fromCharCode(t[e]);return r}static ToHex(e){let t=s.toUint8Array(e),r="",i=t.length;for(let e=0;e<i;e++){let i=t[e];i<16&&(r+="0"),r+=i.toString(16)}return r}static FromHex(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!h.isHex(t))throw TypeError("Argument 'hexString' is not HEX encoded");t.length%2&&(t=`0${t}`);let r=new Uint8Array(t.length/2);for(let e=0;e<t.length;e+=2){let i=t.slice(e,e+2);r[e/2]=parseInt(i,16)}return r.buffer}static ToUtf16String(e,t=!1){return u.toString(e,t)}static FromUtf16String(e,t=!1){return u.fromString(e,t)}static Base64Padding(e){let t=4-e.length%4;if(t<4)for(let r=0;r<t;r++)e+="=";return e}static formatString(e){return(null==e?void 0:e.replace(/[\n\r\t ]/g,""))||""}}h.DEFAULT_UTF8_ENCODING="utf8",r.BufferSourceConverter=s,r.Convert=h,r.assign=function(e){let t=arguments[0];for(let e=1;e<arguments.length;e++){let r=arguments[e];for(let e in r)t[e]=r[e]}return t},r.combine=function(...e){let t=new Uint8Array(e.map(e=>e.byteLength).reduce((e,t)=>e+t)),r=0;return e.map(e=>new Uint8Array(e)).forEach(e=>{for(let i of e)t[r++]=i}),t.buffer},r.isEqual=function(e,t){if(!(e&&t)||e.byteLength!==t.byteLength)return!1;let r=new Uint8Array(e),i=new Uint8Array(t);for(let t=0;t<e.byteLength;t++)if(r[t]!==i[t])return!1;return!0}},88598,e=>{"use strict";var t,r,i,s,n,o,a,l,c,u,h,p,d,f,y,g,m,v,b,x,S,w,_,A,k,C,B,N,j,E,O,I,T,P,U,D,V,R,L,H,M,F,z,$,K,W,q,G,J,Y,Z,X,Q,ee,et,er,ei,es,en,eo,ea,el,ec,eu,eh,ep,ed,ef,ey,eg,em,ev,eb,ex,eS,ew,e_,eA,ek,eC,eB,eN,ej,eE,eO,eI,eT,eP,eU=e.i(43476),eD=e.i(83086),eV=e.i(79223),eR=e.i(71645),eL=e.i(78631),eH=e.i(40160),eM=e.i(74886),eF=e.i(43531),ez=e.i(7233),e$=e.i(27612),eK=e.i(78894),eW=e.i(75254);let eq=(0,eW.default)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);var eG=e.i(34161);let eJ=(0,eW.default)("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);var eY=e.i(86536),eZ=e.i(77705),eX=e.i(67881),eQ=e.i(23750),e0=e.i(10708),e1=e.i(62870),e2=e.i(27341),e8=e.i(70065),e4=e.i(94179),e5=e.i(69035),e3=e.i(30374),e6=e.i(46696),e9=e.i(76792);let e7={commonName:"",organization:"",organizationalUnit:"",country:"",state:"",locality:"",email:""},te={algorithm:"RSA",rsaKeySize:"2048",ecdsaCurve:"P-256",signingAlgorithm:"SHA-256"},tt={days:365,customStartDate:"",customEndDate:"",useCustomDates:!1},tr={digitalSignature:!0,keyEncipherment:!0,dataEncipherment:!1,keyAgreement:!1,keyCertSign:!1,crlSign:!1},ti={serverAuth:!0,clientAuth:!1,codeSigning:!1,emailProtection:!1},ts={isCA:!1,pathLengthConstraint:null},tn={certFormat:"pem",keyFormat:"pkcs8",keyPassphrase:"",includeChain:!1},to={webServer:{label:"Web Server",description:"TLS server authentication"},rootCA:{label:"Root CA",description:"Certificate Authority"},clientCert:{label:"Client Certificate",description:"TLS client authentication"},wildcard:{label:"Wildcard",description:"*.domain.com wildcard certificate"},custom:{label:"Custom",description:"Configure all options manually"}},ta=[{code:"US",name:"United States"},{code:"GB",name:"United Kingdom"},{code:"DE",name:"Germany"},{code:"FR",name:"France"},{code:"CA",name:"Canada"},{code:"AU",name:"Australia"},{code:"JP",name:"Japan"},{code:"CN",name:"China"},{code:"IN",name:"India"},{code:"BR",name:"Brazil"},{code:"NL",name:"Netherlands"},{code:"SE",name:"Sweden"},{code:"CH",name:"Switzerland"},{code:"SG",name:"Singapore"},{code:"KR",name:"South Korea"}],tl={webServer:{keyUsage:{digitalSignature:!0,keyEncipherment:!0,dataEncipherment:!1,keyAgreement:!1,keyCertSign:!1,crlSign:!1},extKeyUsage:{serverAuth:!0,clientAuth:!1,codeSigning:!1,emailProtection:!1},caSettings:{isCA:!1,pathLengthConstraint:null},validityDays:365,rsaKeySize:"2048"},rootCA:{keyUsage:{digitalSignature:!0,keyEncipherment:!1,dataEncipherment:!1,keyAgreement:!1,keyCertSign:!0,crlSign:!0},extKeyUsage:{serverAuth:!1,clientAuth:!1,codeSigning:!1,emailProtection:!1},caSettings:{isCA:!0,pathLengthConstraint:null},validityDays:3650,rsaKeySize:"4096"},clientCert:{keyUsage:{digitalSignature:!0,keyEncipherment:!0,dataEncipherment:!1,keyAgreement:!1,keyCertSign:!1,crlSign:!1},extKeyUsage:{serverAuth:!1,clientAuth:!0,codeSigning:!1,emailProtection:!0},caSettings:{isCA:!1,pathLengthConstraint:null},validityDays:365,rsaKeySize:"2048"},wildcard:{keyUsage:{digitalSignature:!0,keyEncipherment:!0,dataEncipherment:!1,keyAgreement:!1,keyCertSign:!1,crlSign:!1},extKeyUsage:{serverAuth:!0,clientAuth:!1,codeSigning:!1,emailProtection:!1},caSettings:{isCA:!1,pathLengthConstraint:null},validityDays:365},custom:{keyUsage:{digitalSignature:!1,keyEncipherment:!1,dataEncipherment:!1,keyAgreement:!1,keyCertSign:!1,crlSign:!1},extKeyUsage:{serverAuth:!1,clientAuth:!1,codeSigning:!1,emailProtection:!1},caSettings:{isCA:!1,pathLengthConstraint:null},validityDays:365}};function tc(e){return e.replace(/\\/g,"\\\\").replace(/,/g,"\\,").replace(/\+/g,"\\+").replace(/"/g,'\\"').replace(/</g,"\\<").replace(/>/g,"\\>").replace(/;/g,"\\;")}function tu(e){return"ECDSA"===e.algorithm?{name:"ECDSA",namedCurve:e.ecdsaCurve}:{name:"RSASSA-PKCS1-v1_5",modulusLength:parseInt(e.rsaKeySize),publicExponent:new Uint8Array([1,0,1]),hash:e.signingAlgorithm}}function th(e){let t=new Uint8Array(e),r="";for(let e=0;e<t.byteLength;e++)r+=String.fromCharCode(t[e]);return btoa(r)}function tp(e,t){let r=e.match(/.{1,64}/g)||[];return`-----BEGIN ${t}-----
${r.join("\n")}
-----END ${t}-----`}function td(e){return!!e&&"string"==typeof e&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function tf(e){var t,r;return e.commonName&&e.commonName.trim()?(t=e.commonName)&&"string"==typeof t&&t.trim().length>0&&t.length<=64?e.email&&!td(e.email)?{valid:!1,error:"Invalid email address format"}:e.country&&!(!(r=e.country)||/^[A-Z]{2}$/.test(r))?{valid:!1,error:"Country code must be exactly 2 uppercase letters (e.g., US, GB)"}:{valid:!0}:{valid:!1,error:"Common Name must be between 1-64 characters"}:{valid:!1,error:"Common Name (CN) is required"}}function ty(e){for(let t of e){let e=function(e){if(!e.value||!e.value.trim())return{valid:!1,error:"SAN value cannot be empty"};switch(e.type){case"ip":var t,r;if(r=t=e.value,!(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(r)||function(e){if(!e||"string"!=typeof e)return!1;if("::"===e||"::1"===e)return!0;if(!/^[a-fA-F0-9:]+$/.test(e))return!1;let t=e.split("::");if(t.length>2)return!1;let r=t[0]?t[0].split(":"):[],i=t[1]?t[1].split(":"):[];for(let e of[...r,...i].filter(e=>""!==e))if(e.length>4)return!1;return 1===t.length?8===r.length:r.length+i.length<=7}(t)))return{valid:!1,error:`Invalid IP address: ${e.value}`};break;case"email":if(!td(e.value))return{valid:!1,error:`Invalid email in SAN: ${e.value}`};break;case"dns":if(!function(e){if(!e||"string"!=typeof e)return!1;if("localhost"===e)return!0;if(e.includes("..")||e.startsWith(".")||e.includes("_"))return!1;let t=e;e.startsWith("*.")&&(t=e.substring(2));let r=t.split(".");if(r.length<2)return!1;for(let e of r)if(!e||e.startsWith("-")||e.endsWith("-")||!/^[a-zA-Z0-9-]+$/.test(e))return!1;return!0}(e.value))return{valid:!1,error:`Invalid DNS domain in SAN: ${e.value}`}}return{valid:!0}}(t);if(!e.valid)return e}return{valid:!0}}function tg(e){if(e.useCustomDates){if(!e.customStartDate||!e.customEndDate)return{valid:!1,error:"Both start and end dates are required when using custom dates"};let t=new Date(e.customStartDate),r=new Date(e.customEndDate);if(isNaN(t.getTime()))return{valid:!1,error:"Invalid start date format"};if(isNaN(r.getTime()))return{valid:!1,error:"Invalid end date format"};if(r<=t)return{valid:!1,error:"End date must be after start date"}}else{if(!e.days||e.days<1)return{valid:!1,error:"Validity must be at least 1 day"};if(e.days>7300)return{valid:!1,error:"Validity cannot exceed 7300 days (20 years)"}}return{valid:!0}}e.i(64495);var tm=e.i(92662);function tv(e,t){let r=0;if(1===e.length)return e[0];for(let i=e.length-1;i>=0;i--)r+=e[e.length-1-i]*Math.pow(2,t*i);return r}function tb(e,t,r=-1){let i=e,s=0,n=Math.pow(2,t);for(let o=1;o<8;o++){if(e<n){let e;if(r<0)e=new ArrayBuffer(o),s=o;else{if(r<o)return new ArrayBuffer(0);e=new ArrayBuffer(r),s=r}let n=new Uint8Array(e);for(let e=o-1;e>=0;e--){let r=Math.pow(2,e*t);n[s-e-1]=Math.floor(i/r),i-=n[s-e-1]*r}return e}n*=Math.pow(2,t)}return new ArrayBuffer(0)}function tx(...e){let t=0,r=0;for(let r of e)t+=r.length;let i=new Uint8Array(new ArrayBuffer(t));for(let t of e)i.set(t,r),r+=t.length;return i}function tS(){let e=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){let t=255===e[0]&&128&e[1],r=0===e[0]&&(128&e[1])==0;(t||r)&&this.warnings.push("Needlessly long format")}let t=new Uint8Array(new ArrayBuffer(this.valueHex.byteLength));for(let e=0;e<this.valueHex.byteLength;e++)t[e]=0;t[0]=128&e[0];let r=tv(t,8),i=new Uint8Array(new ArrayBuffer(this.valueHex.byteLength));for(let t=0;t<this.valueHex.byteLength;t++)i[t]=e[t];return i[0]&=127,tv(i,8)-r}function tw(e,t){let r=e.toString(10);if(t<r.length)return"";let i=t-r.length,s=Array(i);for(let e=0;e<i;e++)s[e]="0";return s.join("").concat(r)}function t_(){if("undefined"==typeof BigInt)throw Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function tA(e){let t=0,r=0;for(let r=0;r<e.length;r++)t+=e[r].byteLength;let i=new Uint8Array(t);for(let t=0;t<e.length;t++){let s=e[t];i.set(new Uint8Array(s),r),r+=s.byteLength}return i.buffer}function tk(e,t,r,i){return t instanceof Uint8Array?t.byteLength?r<0?(e.error="Wrong parameter: inputOffset less than zero",!1):i<0?(e.error="Wrong parameter: inputLength less than zero",!1):!(t.byteLength-r-i<0)||(e.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1):(e.error="Wrong parameter: inputBuffer has zero length",!1):(e.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}class tC{constructor(){this.items=[]}write(e){this.items.push(e)}final(){return tA(this.items)}}let tB=[new Uint8Array([1])],tN="0123456789",tj="name",tE="valueHexView",tO=new ArrayBuffer(0),tI=new Uint8Array(0),tT="EndOfContent",tP="OCTET STRING",tU="BIT STRING";function tD(e){var t;return(t=class extends e{get valueHex(){return this.valueHexView.slice().buffer}set valueHex(e){this.valueHexView=new Uint8Array(e)}constructor(...e){var t;super(...e);const r=e[0]||{};this.isHexOnly=null!=(t=r.isHexOnly)&&t,this.valueHexView=r.valueHex?tm.BufferSourceConverter.toUint8Array(r.valueHex):tI}fromBER(e,t,r){let i=e instanceof ArrayBuffer?new Uint8Array(e):e;if(!tk(this,i,t,r))return -1;let s=t+r;return(this.valueHexView=i.subarray(t,s),this.valueHexView.length)?(this.blockLength=r,s):(this.warnings.push("Zero buffer length"),t)}toBER(e=!1){return this.isHexOnly?e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",tO)}toJSON(){return{...super.toJSON(),isHexOnly:this.isHexOnly,valueHex:tm.Convert.ToHex(this.valueHexView)}}}).NAME="hexBlock",t}class tV{static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(e){this.valueBeforeDecodeView=new Uint8Array(e)}constructor({blockLength:e=0,error:t="",warnings:r=[],valueBeforeDecode:i=tI}={}){this.blockLength=e,this.error=t,this.warnings=r,this.valueBeforeDecodeView=tm.BufferSourceConverter.toUint8Array(i)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:tm.Convert.ToHex(this.valueBeforeDecodeView)}}}tV.NAME="baseBlock";class tR extends tV{fromBER(e,t,r){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(e,t){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}}tR.NAME="valueBlock";class tL extends tD(tV){constructor({idBlock:e={}}={}){var t,r,i,s;super(),e?(this.isHexOnly=null!=(t=e.isHexOnly)&&t,this.valueHexView=e.valueHex?tm.BufferSourceConverter.toUint8Array(e.valueHex):tI,this.tagClass=null!=(r=e.tagClass)?r:-1,this.tagNumber=null!=(i=e.tagNumber)?i:-1,this.isConstructed=null!=(s=e.isConstructed)&&s):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(e=!1){let t=0;switch(this.tagClass){case 1:t|=0;break;case 2:t|=64;break;case 3:t|=128;break;case 4:t|=192;break;default:return this.error="Unknown tag class",tO}if(this.isConstructed&&(t|=32),this.tagNumber<31&&!this.isHexOnly){let r=new Uint8Array(1);if(!e){let e=this.tagNumber;e&=31,t|=e,r[0]=t}return r.buffer}if(!this.isHexOnly){let r=tb(this.tagNumber,7),i=new Uint8Array(r),s=r.byteLength,n=new Uint8Array(s+1);if(n[0]=31|t,!e){for(let e=0;e<s-1;e++)n[e+1]=128|i[e];n[s]=i[s-1]}return n.buffer}let r=new Uint8Array(this.valueHexView.byteLength+1);if(r[0]=31|t,!e){let e=this.valueHexView;for(let t=0;t<e.length-1;t++)r[t+1]=128|e[t];r[this.valueHexView.byteLength]=e[e.length-1]}return r.buffer}fromBER(e,t,r){let i=tm.BufferSourceConverter.toUint8Array(e);if(!tk(this,i,t,r))return -1;let s=i.subarray(t,t+r);if(0===s.length)return this.error="Zero buffer length",-1;switch(192&s[0]){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=(32&s[0])==32,this.isHexOnly=!1;let n=31&s[0];if(31!==n)this.tagNumber=n,this.blockLength=1;else{let e=1,t=this.valueHexView=new Uint8Array(255),r=255;for(;128&s[e];){if(t[e-1]=127&s[e],++e>=s.length)return this.error="End of input reached before message was fully decoded",-1;if(e===r){let e=new Uint8Array(r+=255);for(let r=0;r<t.length;r++)e[r]=t[r];t=this.valueHexView=new Uint8Array(r)}}this.blockLength=e+1,t[e-1]=127&s[e];let i=new Uint8Array(e);for(let r=0;r<e;r++)i[r]=t[r];(t=this.valueHexView=new Uint8Array(e)).set(i),this.blockLength<=9?this.tagNumber=tv(t,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(1===this.tagClass&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return t+this.blockLength}toJSON(){return{...super.toJSON(),tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed}}}tL.NAME="identificationBlock";class tH extends tV{constructor({lenBlock:e={}}={}){var t,r,i;super(),this.isIndefiniteForm=null!=(t=e.isIndefiniteForm)&&t,this.longFormUsed=null!=(r=e.longFormUsed)&&r,this.length=null!=(i=e.length)?i:0}fromBER(e,t,r){let i=tm.BufferSourceConverter.toUint8Array(e);if(!tk(this,i,t,r))return -1;let s=i.subarray(t,t+r);if(0===s.length)return this.error="Zero buffer length",-1;if(255===s[0])return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=128===s[0],this.isIndefiniteForm)return this.blockLength=1,t+this.blockLength;if(this.longFormUsed=!!(128&s[0]),!1===this.longFormUsed)return this.length=s[0],this.blockLength=1,t+this.blockLength;let n=127&s[0];if(n>8)return this.error="Too big integer",-1;if(n+1>s.length)return this.error="End of input reached before message was fully decoded",-1;let o=t+1,a=i.subarray(o,o+n);return 0===a[n-1]&&this.warnings.push("Needlessly long encoded length"),this.length=tv(a,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=n+1,t+this.blockLength}toBER(e=!1){let t,r;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return t=new ArrayBuffer(1),!1===e&&((r=new Uint8Array(t))[0]=128),t;if(this.longFormUsed){let i=tb(this.length,8);if(i.byteLength>127)return this.error="Too big length",tO;if(t=new ArrayBuffer(i.byteLength+1),e)return t;let s=new Uint8Array(i);(r=new Uint8Array(t))[0]=128|i.byteLength;for(let e=0;e<i.byteLength;e++)r[e+1]=s[e];return t}return t=new ArrayBuffer(1),!1===e&&((r=new Uint8Array(t))[0]=this.length),t}toJSON(){return{...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length}}}tH.NAME="lengthBlock";let tM={};class tF extends tV{constructor({name:e="",optional:t=!1,primitiveSchema:r,...i}={},s){super(i),this.name=e,this.optional=t,r&&(this.primitiveSchema=r),this.idBlock=new tL(i),this.lenBlock=new tH(i),this.valueBlock=s?new s(i):new tR(i)}fromBER(e,t,r){let i=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return -1===i?this.error=this.valueBlock.error:(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength)),i}toBER(e,t){let r=t||new tC;t||function e(t){var r;if(t instanceof tM.Constructed)for(let r of t.valueBlock.value)e(r)&&(t.lenBlock.isIndefiniteForm=!0);return!!(null==(r=t.lenBlock)?void 0:r.isIndefiniteForm)}(this);let i=this.idBlock.toBER(e);if(r.write(i),this.lenBlock.isIndefiniteForm)r.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(e,r),r.write(new ArrayBuffer(2));else{let t=this.valueBlock.toBER(e);this.lenBlock.length=t.byteLength;let i=this.lenBlock.toBER(e);r.write(i),r.write(t)}return t?tO:r.final()}toJSON(){let e={...super.toJSON(),idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional};return this.primitiveSchema&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}toString(e="ascii"){return"ascii"===e?this.onAsciiEncoding():tm.Convert.ToHex(this.toBER())}onAsciiEncoding(){let e=this.constructor.NAME,t=tm.Convert.ToHex(this.valueBlock.valueBeforeDecodeView);return`${e} : ${t}`}isEqual(e){if(this===e)return!0;if(!(e instanceof this.constructor))return!1;let t=this.toBER(),r=e.toBER();if(t.byteLength!==r.byteLength)return!1;let i=new Uint8Array(t),s=new Uint8Array(r);for(let e=0;e<i.length;e++)if(i[e]!==s[e])return!1;return!0}}tF.NAME="BaseBlock";class tz extends tF{getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}constructor({value:e="",...t}={},r){super(t,r),e&&this.fromString(e)}fromBER(e,t,r){let i=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return -1===i?this.error=this.valueBlock.error:(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength)),i}onAsciiEncoding(){return`${this.constructor.NAME} : '${this.valueBlock.value}'`}}tz.NAME="BaseStringBlock";class t$ extends tD(tR){constructor({isHexOnly:e=!0,...t}={}){super(t),this.isHexOnly=e}}t$.NAME="PrimitiveValueBlock";class tK extends tF{constructor(e={}){super(e,t$),this.idBlock.isConstructed=!1}}function tW(e,t=0,r=e.length){let i=t,s=new tF({},tR),n=new tV;if(!tk(n,e,t,r))return s.error=n.error,{offset:-1,result:s};if(!e.subarray(t,t+r).length)return s.error="Zero buffer length",{offset:-1,result:s};let o=s.idBlock.fromBER(e,t,r);if(s.idBlock.warnings.length&&s.warnings.concat(s.idBlock.warnings),-1===o)return s.error=s.idBlock.error,{offset:-1,result:s};if(t=o,r-=s.idBlock.blockLength,o=s.lenBlock.fromBER(e,t,r),s.lenBlock.warnings.length&&s.warnings.concat(s.lenBlock.warnings),-1===o)return s.error=s.lenBlock.error,{offset:-1,result:s};if(t=o,r-=s.lenBlock.blockLength,!s.idBlock.isConstructed&&s.lenBlock.isIndefiniteForm)return s.error="Indefinite length form used for primitive encoding form",{offset:-1,result:s};let a=tF;if(1===s.idBlock.tagClass){if(s.idBlock.tagNumber>=37&&!1===s.idBlock.isHexOnly)return s.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:s};switch(s.idBlock.tagNumber){case 0:if(s.idBlock.isConstructed&&s.lenBlock.length>0)return s.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:s};a=tM.EndOfContent;break;case 1:a=tM.Boolean;break;case 2:a=tM.Integer;break;case 3:a=tM.BitString;break;case 4:a=tM.OctetString;break;case 5:a=tM.Null;break;case 6:a=tM.ObjectIdentifier;break;case 10:a=tM.Enumerated;break;case 12:a=tM.Utf8String;break;case 13:a=tM.RelativeObjectIdentifier;break;case 14:a=tM.TIME;break;case 15:return s.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:s};case 16:a=tM.Sequence;break;case 17:a=tM.Set;break;case 18:a=tM.NumericString;break;case 19:a=tM.PrintableString;break;case 20:a=tM.TeletexString;break;case 21:a=tM.VideotexString;break;case 22:a=tM.IA5String;break;case 23:a=tM.UTCTime;break;case 24:a=tM.GeneralizedTime;break;case 25:a=tM.GraphicString;break;case 26:a=tM.VisibleString;break;case 27:a=tM.GeneralString;break;case 28:a=tM.UniversalString;break;case 29:a=tM.CharacterString;break;case 30:a=tM.BmpString;break;case 31:a=tM.DATE;break;case 32:a=tM.TimeOfDay;break;case 33:a=tM.DateTime;break;case 34:a=tM.Duration;break;default:{let e=s.idBlock.isConstructed?new tM.Constructed:new tM.Primitive;e.idBlock=s.idBlock,e.lenBlock=s.lenBlock,e.warnings=s.warnings,s=e}}}else a=s.idBlock.isConstructed?tM.Constructed:tM.Primitive;return o=(s=function(e,t){if(e instanceof t)return e;let r=new t;return r.idBlock=e.idBlock,r.lenBlock=e.lenBlock,r.warnings=e.warnings,r.valueBeforeDecodeView=e.valueBeforeDecodeView,r}(s,a)).fromBER(e,t,s.lenBlock.isIndefiniteForm?r:s.lenBlock.length),s.valueBeforeDecodeView=e.subarray(i,i+s.blockLength),{offset:o,result:s}}function tq(e){if(!e.byteLength){let e=new tF({},tR);return e.error="Input buffer has zero length",{offset:-1,result:e}}return tW(tm.BufferSourceConverter.toUint8Array(e).slice(),0,e.byteLength)}tM.Primitive=tK,tK.NAME="PRIMITIVE";class tG extends tR{constructor({value:e=[],isIndefiniteForm:t=!1,...r}={}){super(r),this.value=e,this.isIndefiniteForm=t}fromBER(e,t,r){var i,s;let n=tm.BufferSourceConverter.toUint8Array(e);if(!tk(this,n,t,r))return -1;if(this.valueBeforeDecodeView=n.subarray(t,t+r),0===this.valueBeforeDecodeView.length)return this.warnings.push("Zero buffer length"),t;let o=t;for(;i=this.isIndefiniteForm,s=r,(i?1:s)>0;){let e=tW(n,o,r);if(-1===e.offset)return this.error=e.result.error,this.warnings.concat(e.result.warnings),-1;if(o=e.offset,this.blockLength+=e.result.blockLength,r-=e.result.blockLength,this.value.push(e.result),this.isIndefiniteForm&&e.result.constructor.NAME===tT)break}return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===tT?this.value.pop():this.warnings.push("No EndOfContent block encoded")),o}toBER(e,t){let r=t||new tC;for(let t=0;t<this.value.length;t++)this.value[t].toBER(e,r);return t?tO:r.final()}toJSON(){let e={...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,value:[]};for(let t of this.value)e.value.push(t.toJSON());return e}}tG.NAME="ConstructedValueBlock";class tJ extends tF{constructor(e={}){super(e,tG),this.idBlock.isConstructed=!0}fromBER(e,t,r){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;let i=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return -1===i?this.error=this.valueBlock.error:(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength)),i}onAsciiEncoding(){let e=[];for(let t of this.valueBlock.value)e.push(t.toString("ascii").split("\n").map(e=>`  ${e}`).join("\n"));let t=3===this.idBlock.tagClass?`[${this.idBlock.tagNumber}]`:this.constructor.NAME;return e.length?`${t} :
${e.join("\n")}`:`${t} :`}}tM.Constructed=tJ,tJ.NAME="CONSTRUCTED";class tY extends tR{fromBER(e,t,r){return t}toBER(e){return tO}}tY.override="EndOfContentValueBlock";class tZ extends tF{constructor(e={}){super(e,tY),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}}tM.EndOfContent=tZ,tZ.NAME=tT;class tX extends tF{constructor(e={}){super(e,tR),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(e,t,r){return(this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=r,t+r>e.byteLength)?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):t+r}toBER(e,t){let r=new ArrayBuffer(2);if(!e){let e=new Uint8Array(r);e[0]=5,e[1]=0}return t&&t.write(r),r}onAsciiEncoding(){return`${this.constructor.NAME}`}}tM.Null=tX,tX.NAME="NULL";class tQ extends tD(tR){get value(){for(let e of this.valueHexView)if(e>0)return!0;return!1}set value(e){this.valueHexView[0]=255*!!e}constructor({value:e,...t}={}){super(t),t.valueHex?this.valueHexView=tm.BufferSourceConverter.toUint8Array(t.valueHex):this.valueHexView=new Uint8Array(1),e&&(this.value=e)}fromBER(e,t,r){let i=tm.BufferSourceConverter.toUint8Array(e);return tk(this,i,t,r)?(this.valueHexView=i.subarray(t,t+r),r>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,tS.call(this),this.blockLength=r,t+r):-1}toBER(){return this.valueHexView.slice()}toJSON(){return{...super.toJSON(),value:this.value}}}tQ.NAME="BooleanValueBlock";class t0 extends tF{getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}constructor(e={}){super(e,tQ),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.getValue}`}}tM.Boolean=t0,t0.NAME="BOOLEAN";class t1 extends tD(tG){constructor({isConstructed:e=!1,...t}={}){super(t),this.isConstructed=e}fromBER(e,t,r){let i=0;if(this.isConstructed){if(this.isHexOnly=!1,-1===(i=tG.prototype.fromBER.call(this,e,t,r)))return i;for(let e=0;e<this.value.length;e++){let t=this.value[e].constructor.NAME;if(t===tT)if(!this.isIndefiniteForm)return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1;else break;if(t!==tP)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,i=super.fromBER(e,t,r),this.blockLength=r;return i}toBER(e,t){return this.isConstructed?tG.prototype.toBER.call(this,e,t):e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),isConstructed:this.isConstructed}}}t1.NAME="OctetStringValueBlock";class t2 extends tF{constructor({idBlock:e={},lenBlock:t={},...r}={}){var i;null!=r.isConstructed||(r.isConstructed=!!(null==(i=r.value)?void 0:i.length)),super({idBlock:{isConstructed:r.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!r.isIndefiniteForm},...r},t1),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(e,t,r){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,0===r)return 0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),t;if(!this.valueBlock.isConstructed){let i=(e instanceof ArrayBuffer?new Uint8Array(e):e).subarray(t,t+r);try{if(i.byteLength){let e=tW(i,0,i.byteLength);-1!==e.offset&&e.offset===r&&(this.valueBlock.value=[e.result])}}catch{}}return super.fromBER(e,t,r)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return tJ.prototype.onAsciiEncoding.call(this);let e=this.constructor.NAME,t=tm.Convert.ToHex(this.valueBlock.valueHexView);return`${e} : ${t}`}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;let e=[];for(let t of this.valueBlock.value)t instanceof v&&e.push(t.valueBlock.valueHexView);return tm.BufferSourceConverter.concat(e)}}tM.OctetString=v=t2,t2.NAME=tP;class t8 extends tD(tG){constructor({unusedBits:e=0,isConstructed:t=!1,...r}={}){super(r),this.unusedBits=e,this.isConstructed=t,this.blockLength=this.valueHexView.byteLength}fromBER(e,t,r){if(!r)return t;let i=-1;if(this.isConstructed){if(-1===(i=tG.prototype.fromBER.call(this,e,t,r)))return i;for(let e of this.value){let t=e.constructor.NAME;if(t===tT)if(!this.isIndefiniteForm)return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1;else break;if(t!==tU)return this.error="BIT STRING may consists of BIT STRINGs only",-1;let r=e.valueBlock;if(this.unusedBits>0&&r.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=r.unusedBits}return i}let s=tm.BufferSourceConverter.toUint8Array(e);if(!tk(this,s,t,r))return -1;let n=s.subarray(t,t+r);if(this.unusedBits=n[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){let e=n.subarray(1);try{if(e.byteLength){let t=tW(e,0,e.byteLength);-1!==t.offset&&t.offset===r-1&&(this.value=[t.result])}}catch{}}return this.valueHexView=n.subarray(1),this.blockLength=n.length,t+r}toBER(e,t){if(this.isConstructed)return tG.prototype.toBER.call(this,e,t);if(e)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength)return tO;let r=new Uint8Array(this.valueHexView.length+1);return r[0]=this.unusedBits,r.set(this.valueHexView,1),r.buffer}toJSON(){return{...super.toJSON(),unusedBits:this.unusedBits,isConstructed:this.isConstructed}}}t8.NAME="BitStringValueBlock";class t4 extends tF{constructor({idBlock:e={},lenBlock:t={},...r}={}){var i;null!=r.isConstructed||(r.isConstructed=!!(null==(i=r.value)?void 0:i.length)),super({idBlock:{isConstructed:r.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!r.isIndefiniteForm},...r},t8),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(e,t,r){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(e,t,r)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return tJ.prototype.onAsciiEncoding.call(this);{let e=[];for(let t of this.valueBlock.valueHexView)e.push(t.toString(2).padStart(8,"0"));let t=e.join(""),r=this.constructor.NAME,i=t.substring(0,t.length-this.valueBlock.unusedBits);return`${r} : ${i}`}}}function t5(e){if(e>=tB.length)for(let t=tB.length;t<=e;t++){let e=new Uint8Array([0]),r=tB[t-1].slice(0);for(let t=r.length-1;t>=0;t--){let i=new Uint8Array([(r[t]<<1)+e[0]]);e[0]=i[0]/10,r[t]=i[0]%10}e[0]>0&&(r=tx(e,r)),tB.push(r)}return tB[e]}tM.BitString=t4,t4.NAME=tU;class t3 extends tD(tR){setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=tS.call(this)))}constructor({value:e,...t}={}){super(t),this._valueDec=0,t.valueHex&&this.setValueHex(),void 0!==e&&(this.valueDec=e)}set valueDec(e){this._valueDec=e,this.isHexOnly=!1,this.valueHexView=new Uint8Array(function(e){let t=e<0?-1*e:e,r=128;for(let i=1;i<8;i++){if(t<=r){if(e<0){let e=tb(r-t,8,i),s=new Uint8Array(e);return s[0]|=128,e}let s=tb(t,8,i),n=new Uint8Array(s);if(128&n[0]){let e=s.slice(0),t=new Uint8Array(e);n=new Uint8Array(s=new ArrayBuffer(s.byteLength+1));for(let r=0;r<e.byteLength;r++)n[r+1]=t[r];n[0]=0}return s}r*=256}return new ArrayBuffer(0)}(e))}get valueDec(){return this._valueDec}fromDER(e,t,r,i=0){let s=this.fromBER(e,t,r);if(-1===s)return s;let n=this.valueHexView;return 0===n[0]&&(128&n[1])!=0?this.valueHexView=n.subarray(1):0!==i&&n.length<i&&(i-n.length>1&&(i=n.length+1),this.valueHexView=n.subarray(i-n.length)),s}toDER(e=!1){let t=this.valueHexView;switch(!0){case(128&t[0])!=0:{let e=new Uint8Array(this.valueHexView.length+1);e[0]=0,e.set(t,1),this.valueHexView=e}break;case 0===t[0]&&(128&t[1])==0:this.valueHexView=this.valueHexView.subarray(1)}return this.toBER(e)}fromBER(e,t,r){let i=super.fromBER(e,t,r);return -1===i||this.setValueHex(),i}toBER(e){return e?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}toString(){let e,t=8*this.valueHexView.length-1,r=new Uint8Array(8*this.valueHexView.length/3),i=0,s=this.valueHexView,n="",o=!1;for(let o=s.byteLength-1;o>=0;o--){e=s[o];for(let s=0;s<8;s++)(1&e)==1&&(i===t?(r=function(e,t){let r,i=0,s=new Uint8Array(e),n=new Uint8Array(t),o=s.slice(0),a=o.length-1,l=n.slice(0),c=l.length-1,u=0;for(let e=c;e>=0;e--,u++)!0==(r=o[a-u]-l[c-u]-i)<0?(i=1,o[a-u]=r+10):(i=0,o[a-u]=r);if(i>0)for(let e=a-c+1;e>=0;e--,u++)if((r=o[a-u]-i)<0)i=1,o[a-u]=r+10;else{i=0,o[a-u]=r;break}return o.slice()}(t5(i),r),n="-"):r=function(e,t){let r=new Uint8Array([0]),i=new Uint8Array(e),s=new Uint8Array(t),n=i.slice(0),o=n.length-1,a=s.slice(0),l=a.length-1,c=0,u=l<o?o:l,h=0;for(let e=u;e>=0;e--,h++)c=!0==h<a.length?n[o-h]+a[l-h]+r[0]:n[o-h]+r[0],r[0]=c/10,!0==h>=n.length?n=tx(new Uint8Array([c%10]),n):n[o-h]=c%10;return r[0]>0&&(n=tx(r,n)),n}(r,t5(i))),i++,e>>=1}for(let e=0;e<r.length;e++)r[e]&&(o=!0),o&&(n+=tN.charAt(r[e]));return!1===o&&(n+=tN.charAt(0)),n}}t3.NAME="IntegerValueBlock",Object.defineProperty(t3.prototype,"valueHex",{set:function(e){this.valueHexView=new Uint8Array(e),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});class t6 extends tF{constructor(e={}){super(e,t3),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return t_(),BigInt(this.valueBlock.toString())}static fromBigInt(e){t_();let t=BigInt(e),r=new tC,i=t.toString(16).replace(/^-/,""),s=new Uint8Array(tm.Convert.FromHex(i));if(t<0){let e=new Uint8Array(s.length+(128&s[0]?1:0));e[0]|=128;let i=BigInt(`0x${tm.Convert.ToHex(e)}`)+t,n=tm.BufferSourceConverter.toUint8Array(tm.Convert.FromHex(i.toString(16)));n[0]|=128,r.write(n)}else 128&s[0]&&r.write(new Uint8Array([0])),r.write(s);return new b({valueHex:r.final()})}convertToDER(){let e=new b({valueHex:this.valueBlock.valueHexView});return e.valueBlock.toDER(),e}convertFromDER(){return new b({valueHex:0===this.valueBlock.valueHexView[0]?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()}`}}tM.Integer=b=t6,t6.NAME="INTEGER";class t9 extends t6{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}}tM.Enumerated=t9,t9.NAME="ENUMERATED";class t7 extends tD(tR){constructor({valueDec:e=-1,isFirstSid:t=!1,...r}={}){super(r),this.valueDec=e,this.isFirstSid=t}fromBER(e,t,r){if(!r)return t;let i=tm.BufferSourceConverter.toUint8Array(e);if(!tk(this,i,t,r))return -1;let s=i.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let e=0;e<r&&(this.valueHexView[e]=127&s[e],this.blockLength++,(128&s[e])!=0);e++);let n=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength;e++)n[e]=this.valueHexView[e];return(this.valueHexView=n,(128&s[this.blockLength-1])!=0)?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=tv(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}set valueBigInt(e){t_();let t=BigInt(e).toString(2);for(;t.length%7;)t="0"+t;let r=new Uint8Array(t.length/7);for(let e=0;e<r.length;e++)r[e]=parseInt(t.slice(7*e,7*e+7),2)+128*(e+1<r.length);this.fromBER(r.buffer,0,r.length)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);let t=this.valueHexView,r=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength-1;e++)r[e]=128|t[e];return r[this.blockLength-1]=t[this.blockLength-1],r.buffer}let t=tb(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",tO;let r=new Uint8Array(t.byteLength);if(!e){let e=new Uint8Array(t),i=t.byteLength-1;for(let t=0;t<i;t++)r[t]=128|e[t];r[i]=e[i]}return r}toString(){let e="";if(this.isHexOnly)e=tm.Convert.ToHex(this.valueHexView);else if(this.isFirstSid){let t=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",t-=40):(e="2.",t-=80),e+=t.toString()}else e=this.valueDec.toString();return e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec,isFirstSid:this.isFirstSid}}}t7.NAME="sidBlock";class re extends tR{constructor({value:e="",...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let i=t;for(;r>0;){let t=new t7;if(-1===(i=t.fromBER(e,i,r))){this.blockLength=0,this.error=t.error;break}0===this.value.length&&(t.isFirstSid=!0),this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return i}toBER(e){let t=[];for(let r=0;r<this.value.length;r++){let i=this.value[r].toBER(e);if(0===i.byteLength)return this.error=this.value[r].error,tO;t.push(i)}return tA(t)}fromString(e){this.value=[];let t=0,r=0,i="",s=!1;do if(i=-1===(r=e.indexOf(".",t))?e.substring(t):e.substring(t,r),t=r+1,s){let e=this.value[0],t=0;switch(e.valueDec){case 0:break;case 1:t=40;break;case 2:t=80;break;default:this.value=[];return}let r=parseInt(i,10);if(isNaN(r))return;e.valueDec=r+t,s=!1}else{let e=new t7;if(i>Number.MAX_SAFE_INTEGER)t_(),e.valueBigInt=BigInt(i);else if(e.valueDec=parseInt(i,10),isNaN(e.valueDec))return;this.value.length||(e.isFirstSid=!0,s=!0),this.value.push(e)}while(-1!==r)}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let i=this.value[r].toString();0!==r&&(e=`${e}.`),t?(i=`{${i}}`,this.value[r].isFirstSid?e=`2.{${i} - 80}`:e+=i):e+=i}return e}toJSON(){let e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}re.NAME="ObjectIdentifierValueBlock";class rt extends tF{getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}constructor(e={}){super(e,re),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}tM.ObjectIdentifier=rt,rt.NAME="OBJECT IDENTIFIER";class rr extends tD(tV){constructor({valueDec:e=0,...t}={}){super(t),this.valueDec=e}fromBER(e,t,r){if(0===r)return t;let i=tm.BufferSourceConverter.toUint8Array(e);if(!tk(this,i,t,r))return -1;let s=i.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let e=0;e<r&&(this.valueHexView[e]=127&s[e],this.blockLength++,(128&s[e])!=0);e++);let n=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength;e++)n[e]=this.valueHexView[e];return(this.valueHexView=n,(128&s[this.blockLength-1])!=0)?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=tv(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);let t=this.valueHexView,r=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength-1;e++)r[e]=128|t[e];return r[this.blockLength-1]=t[this.blockLength-1],r.buffer}let t=tb(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",tO;let r=new Uint8Array(t.byteLength);if(!e){let e=new Uint8Array(t),i=t.byteLength-1;for(let t=0;t<i;t++)r[t]=128|e[t];r[i]=e[i]}return r.buffer}toString(){return this.isHexOnly?tm.Convert.ToHex(this.valueHexView):this.valueDec.toString()}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}}rr.NAME="relativeSidBlock";class ri extends tR{constructor({value:e="",...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let i=t;for(;r>0;){let t=new rr;if(-1===(i=t.fromBER(e,i,r))){this.blockLength=0,this.error=t.error;break}this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return i}toBER(e,t){let r=[];for(let t=0;t<this.value.length;t++){let i=this.value[t].toBER(e);if(0===i.byteLength)return this.error=this.value[t].error,tO;r.push(i)}return tA(r)}fromString(e){this.value=[];let t=0,r=0,i="";do{i=-1===(r=e.indexOf(".",t))?e.substring(t):e.substring(t,r),t=r+1;let s=new rr;if(s.valueDec=parseInt(i,10),isNaN(s.valueDec))break;this.value.push(s)}while(-1!==r)return!0}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let i=this.value[r].toString();0!==r&&(e=`${e}.`),t?e+=i=`{${i}}`:e+=i}return e}toJSON(){let e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}ri.NAME="RelativeObjectIdentifierValueBlock";class rs extends tF{getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}constructor(e={}){super(e,ri),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}tM.RelativeObjectIdentifier=rs,rs.NAME="RelativeObjectIdentifier";class rn extends tJ{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}}tM.Sequence=rn,rn.NAME="SEQUENCE";class ro extends tJ{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}}tM.Set=ro,ro.NAME="SET";class ra extends tD(tR){constructor({...e}={}){super(e),this.isHexOnly=!0,this.value=""}toJSON(){return{...super.toJSON(),value:this.value}}}ra.NAME="StringValueBlock";class rl extends ra{}rl.NAME="SimpleStringValueBlock";class rc extends tz{constructor({...e}={}){super(e,rl)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,tm.BufferSourceConverter.toUint8Array(e))}fromString(e){let t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(t);for(let i=0;i<t;i++)r[i]=e.charCodeAt(i);this.valueBlock.value=e}}rc.NAME="SIMPLE STRING";class ru extends rc{fromBuffer(e){this.valueBlock.valueHexView=tm.BufferSourceConverter.toUint8Array(e);try{this.valueBlock.value=tm.Convert.ToUtf8String(e)}catch(t){this.warnings.push(`Error during "decodeURIComponent": ${t}, using raw string`),this.valueBlock.value=tm.Convert.ToBinary(e)}}fromString(e){this.valueBlock.valueHexView=new Uint8Array(tm.Convert.FromUtf8String(e)),this.valueBlock.value=e}}ru.NAME="Utf8StringValueBlock";class rh extends ru{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}}tM.Utf8String=rh,rh.NAME="UTF8String";class rp extends rc{fromBuffer(e){this.valueBlock.value=tm.Convert.ToUtf16String(e),this.valueBlock.valueHexView=tm.BufferSourceConverter.toUint8Array(e)}fromString(e){this.valueBlock.value=e,this.valueBlock.valueHexView=new Uint8Array(tm.Convert.FromUtf16String(e))}}rp.NAME="BmpStringValueBlock";class rd extends rp{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}}tM.BmpString=rd,rd.NAME="BMPString";class rf extends rc{fromBuffer(e){let t=ArrayBuffer.isView(e)?e.slice().buffer:e.slice(0),r=new Uint8Array(t);for(let e=0;e<r.length;e+=4)r[e]=r[e+3],r[e+1]=r[e+2],r[e+2]=0,r[e+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(t))}fromString(e){let t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(4*t);for(let i=0;i<t;i++){let t=new Uint8Array(tb(e.charCodeAt(i),8));if(t.length>4)continue;let s=4-t.length;for(let e=t.length-1;e>=0;e--)r[4*i+e+s]=t[e]}this.valueBlock.value=e}}rf.NAME="UniversalStringValueBlock";class ry extends rf{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}}tM.UniversalString=ry,ry.NAME="UniversalString";class rg extends rc{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}}tM.NumericString=rg,rg.NAME="NumericString";class rm extends rc{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}}tM.PrintableString=rm,rm.NAME="PrintableString";class rv extends rc{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}}tM.TeletexString=rv,rv.NAME="TeletexString";class rb extends rc{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}}tM.VideotexString=rb,rb.NAME="VideotexString";class rx extends rc{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}}tM.IA5String=rx,rx.NAME="IA5String";class rS extends rc{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}}tM.GraphicString=rS,rS.NAME="GraphicString";class rw extends rc{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}}tM.VisibleString=rw,rw.NAME="VisibleString";class r_ extends rc{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}}tM.GeneralString=r_,r_.NAME="GeneralString";class rA extends rc{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}}tM.CharacterString=rA,rA.NAME="CharacterString";class rk extends rw{constructor({value:e,valueDate:t,...r}={}){if(super(r),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,e){this.fromString(e),this.valueBlock.valueHexView=new Uint8Array(e.length);for(let t=0;t<e.length;t++)this.valueBlock.valueHexView[t]=e.charCodeAt(t)}t&&(this.fromDate(t),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(e){this.fromString(String.fromCharCode.apply(null,tm.BufferSourceConverter.toUint8Array(e)))}toBuffer(){let e=this.toString(),t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return t}fromDate(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(e){let t=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/ig.exec(e);if(null===t){this.error="Wrong input string for conversion";return}let r=parseInt(t[1],10);r>=50?this.year=1900+r:this.year=2e3+r,this.month=parseInt(t[2],10),this.day=parseInt(t[3],10),this.hour=parseInt(t[4],10),this.minute=parseInt(t[5],10),this.second=parseInt(t[6],10)}toString(e="iso"){if("iso"===e){let e=Array(7);return e[0]=tw(this.year<2e3?this.year-1900:this.year-2e3,2),e[1]=tw(this.month,2),e[2]=tw(this.day,2),e[3]=tw(this.hour,2),e[4]=tw(this.minute,2),e[5]=tw(this.second,2),e[6]="Z",e.join("")}return super.toString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.toDate().toISOString()}`}toJSON(){return{...super.toJSON(),year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second}}}tM.UTCTime=rk,rk.NAME="UTCTime";class rC extends rk{constructor(e={}){super(e),null!=this.millisecond||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(e){super.fromDate(e),this.millisecond=e.getUTCMilliseconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}fromString(e){let t,r=!1,i="",s="",n=0,o=0,a=0;if("Z"===e[e.length-1])i=e.substring(0,e.length-1),r=!0;else{if(isNaN(new Number(e[e.length-1]).valueOf()))throw Error("Wrong input string for conversion");i=e}if(r){if(-1!==i.indexOf("+")||-1!==i.indexOf("-"))throw Error("Wrong input string for conversion")}else{let e=1,t=i.indexOf("+"),r="";if(-1===t&&(t=i.indexOf("-"),e=-1),-1!==t){if(r=i.substring(t+1),i=i.substring(0,t),2!==r.length&&4!==r.length)throw Error("Wrong input string for conversion");let s=parseInt(r.substring(0,2),10);if(isNaN(s.valueOf()))throw Error("Wrong input string for conversion");if(o=e*s,4===r.length){if(isNaN((s=parseInt(r.substring(2,4),10)).valueOf()))throw Error("Wrong input string for conversion");a=e*s}}}let l=i.indexOf(".");if(-1===l&&(l=i.indexOf(",")),-1!==l){let e=new Number(`0${i.substring(l)}`);if(isNaN(e.valueOf()))throw Error("Wrong input string for conversion");n=e.valueOf(),s=i.substring(0,l)}else s=i;switch(!0){case 8===s.length:if(t=/(\d{4})(\d{2})(\d{2})/ig,-1!==l)throw Error("Wrong input string for conversion");break;case 10===s.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})/ig,-1!==l){let e=60*n;this.minute=Math.floor(e),e=60*(e-this.minute),this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 12===s.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/ig,-1!==l){let e=60*n;this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 14===s.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/ig,-1!==l){let e=1e3*n;this.millisecond=Math.floor(e)}break;default:throw Error("Wrong input string for conversion")}let c=t.exec(s);if(null===c)throw Error("Wrong input string for conversion");for(let e=1;e<c.length;e++)switch(e){case 1:this.year=parseInt(c[e],10);break;case 2:this.month=parseInt(c[e],10);break;case 3:this.day=parseInt(c[e],10);break;case 4:this.hour=parseInt(c[e],10)+o;break;case 5:this.minute=parseInt(c[e],10)+a;break;case 6:this.second=parseInt(c[e],10);break;default:throw Error("Wrong input string for conversion")}if(!1===r){let e=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=e.getUTCFullYear(),this.month=e.getUTCMonth(),this.day=e.getUTCDay(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds(),this.millisecond=e.getUTCMilliseconds()}}toString(e="iso"){if("iso"===e){let e=[];return e.push(tw(this.year,4)),e.push(tw(this.month,2)),e.push(tw(this.day,2)),e.push(tw(this.hour,2)),e.push(tw(this.minute,2)),e.push(tw(this.second,2)),0!==this.millisecond&&(e.push("."),e.push(tw(this.millisecond,3))),e.push("Z"),e.join("")}return super.toString(e)}toJSON(){return{...super.toJSON(),millisecond:this.millisecond}}}tM.GeneralizedTime=rC,rC.NAME="GeneralizedTime";class rB extends rh{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}}tM.DATE=rB,rB.NAME="DATE";class rN extends rh{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}}tM.TimeOfDay=rN,rN.NAME="TimeOfDay";class rj extends rh{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}}tM.DateTime=rj,rj.NAME="DateTime";class rE extends rh{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}}tM.Duration=rE,rE.NAME="Duration";class rO extends rh{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}}tM.TIME=rO,rO.NAME="TIME";class rI{constructor({name:e="",optional:t=!1}={}){this.name=e,this.optional=t}}class rT extends rI{constructor({value:e=[],...t}={}){super(t),this.value=e}}class rP extends rI{constructor({value:e=new rI,local:t=!1,...r}={}){super(r),this.value=e,this.local=t}}class rU{get data(){return this.dataView.slice().buffer}set data(e){this.dataView=tm.BufferSourceConverter.toUint8Array(e)}constructor({data:e=tI}={}){this.dataView=tm.BufferSourceConverter.toUint8Array(e)}fromBER(e,t,r){let i=t+r;return this.dataView=tm.BufferSourceConverter.toUint8Array(e).subarray(t,i),i}toBER(e){return this.dataView.slice().buffer}}function rD(e,t,r){if(r instanceof rT){for(let i of r.value)if(rD(e,t,i).verified)return{verified:!0,result:e};{let e={verified:!1,result:{error:"Wrong values for Choice type"}};return r.hasOwnProperty(tj)&&(e.name=r.name),e}}if(r instanceof rI)return r.hasOwnProperty(tj)&&(e[r.name]=t),{verified:!0,result:e};if(e instanceof Object==!1)return{verified:!1,result:{error:"Wrong root object"}};if(t instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(r instanceof Object==!1||"idBlock"in r==!1||"fromBER"in r.idBlock==!1||"toBER"in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};let i=r.idBlock.toBER(!1);if(0===i.byteLength)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(-1===r.idBlock.fromBER(i,0,i.byteLength))return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(!1===r.idBlock.hasOwnProperty("tagClass"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagClass!==t.idBlock.tagClass)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty("tagNumber"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagNumber!==t.idBlock.tagNumber)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty("isConstructed"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isConstructed!==t.idBlock.isConstructed)return{verified:!1,result:e};if(!("isHexOnly"in r.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isHexOnly!==t.idBlock.isHexOnly)return{verified:!1,result:e};if(r.idBlock.isHexOnly){if(tE in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};let i=r.idBlock.valueHexView,s=t.idBlock.valueHexView;if(i.length!==s.length)return{verified:!1,result:e};for(let t=0;t<i.length;t++)if(i[t]!==s[1])return{verified:!1,result:e}}if(r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&(e[r.name]=t)),r instanceof tM.Constructed){let i=0,s={verified:!1,result:{error:"Unknown error"}},n=r.valueBlock.value.length;if(n>0&&r.valueBlock.value[0]instanceof rP&&(n=t.valueBlock.value.length),0===n)return{verified:!0,result:e};if(0===t.valueBlock.value.length&&0!==r.valueBlock.value.length){let t=!0;for(let e=0;e<r.valueBlock.value.length;e++)t=t&&(r.valueBlock.value[e].optional||!1);return t?{verified:!0,result:e}:(r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&delete e[r.name]),e.error="Inconsistent object length",{verified:!1,result:e})}for(let o=0;o<n;o++)if(o-i>=t.valueBlock.value.length){if(!1===r.valueBlock.value[o].optional){let t={verified:!1,result:e};return e.error="Inconsistent length between ASN.1 data and schema",r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&(delete e[r.name],t.name=r.name)),t}}else if(r.valueBlock.value[0]instanceof rP){if(!1===(s=rD(e,t.valueBlock.value[o],r.valueBlock.value[0].value)).verified)if(!r.valueBlock.value[0].optional)return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&delete e[r.name]),s;else i++;if(tj in r.valueBlock.value[0]&&r.valueBlock.value[0].name.length>0){let i={};void 0===(i="local"in r.valueBlock.value[0]&&r.valueBlock.value[0].local?t:e)[r.valueBlock.value[0].name]&&(i[r.valueBlock.value[0].name]=[]),i[r.valueBlock.value[0].name].push(t.valueBlock.value[o])}}else if(!1===(s=rD(e,t.valueBlock.value[o-i],r.valueBlock.value[o])).verified)if(!r.valueBlock.value[o].optional)return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&delete e[r.name]),s;else i++;if(!1===s.verified){let t={verified:!1,result:e};return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&(delete e[r.name],t.name=r.name)),t}return{verified:!0,result:e}}if(r.primitiveSchema&&tE in t.valueBlock){let i=tW(t.valueBlock.valueHexView);if(-1===i.offset){let t={verified:!1,result:i.result};return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&(delete e[r.name],t.name=r.name)),t}return rD(e,i.result,r.primitiveSchema)}return{verified:!0,result:e}}function rV(e,t){if(t instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema type"}};let r=tW(tm.BufferSourceConverter.toUint8Array(e));return -1===r.offset?{verified:!1,result:r.result}:rD(r.result,r.result,t)}e.s(["Any",()=>rI,"BaseBlock",()=>tF,"BaseStringBlock",()=>tz,"BitString",()=>t4,"BmpString",()=>rd,"Boolean",()=>t0,"CharacterString",()=>rA,"Choice",()=>rT,"Constructed",()=>tJ,"DATE",()=>rB,"DateTime",()=>rj,"Duration",()=>rE,"EndOfContent",()=>tZ,"Enumerated",()=>t9,"GeneralString",()=>r_,"GeneralizedTime",()=>rC,"GraphicString",()=>rS,"HexBlock",()=>tD,"IA5String",()=>rx,"Integer",()=>t6,"Null",()=>tX,"NumericString",()=>rg,"ObjectIdentifier",()=>rt,"OctetString",()=>t2,"Primitive",()=>tK,"PrintableString",()=>rm,"RawData",()=>rU,"RelativeObjectIdentifier",()=>rs,"Repeated",()=>rP,"Sequence",()=>rn,"Set",()=>ro,"TIME",()=>rO,"TeletexString",()=>rv,"TimeOfDay",()=>rN,"UTCTime",()=>rk,"UniversalString",()=>ry,"Utf8String",()=>rh,"ValueBlock",()=>tR,"VideotexString",()=>rb,"ViewWriter",()=>tC,"VisibleString",()=>rw,"compareSchema",()=>rD,"fromBER",()=>tq,"verifySchema",()=>rV],60922),(t=x||(x={}))[t.Sequence=0]="Sequence",t[t.Set=1]="Set",t[t.Choice=2]="Choice",(r=S||(S={}))[r.Any=1]="Any",r[r.Boolean=2]="Boolean",r[r.OctetString=3]="OctetString",r[r.BitString=4]="BitString",r[r.Integer=5]="Integer",r[r.Enumerated=6]="Enumerated",r[r.ObjectIdentifier=7]="ObjectIdentifier",r[r.Utf8String=8]="Utf8String",r[r.BmpString=9]="BmpString",r[r.UniversalString=10]="UniversalString",r[r.NumericString=11]="NumericString",r[r.PrintableString=12]="PrintableString",r[r.TeletexString=13]="TeletexString",r[r.VideotexString=14]="VideotexString",r[r.IA5String=15]="IA5String",r[r.GraphicString=16]="GraphicString",r[r.VisibleString=17]="VisibleString",r[r.GeneralString=18]="GeneralString",r[r.CharacterString=19]="CharacterString",r[r.UTCTime=20]="UTCTime",r[r.GeneralizedTime=21]="GeneralizedTime",r[r.DATE=22]="DATE",r[r.TimeOfDay=23]="TimeOfDay",r[r.DateTime=24]="DateTime",r[r.Duration=25]="Duration",r[r.TIME=26]="TIME",r[r.Null=27]="Null";class rR{constructor(e,t=0){if(this.unusedBits=0,this.value=new ArrayBuffer(0),e)if("number"==typeof e)this.fromNumber(e);else if(tm.BufferSourceConverter.isBufferSource(e))this.unusedBits=t,this.value=tm.BufferSourceConverter.toArrayBuffer(e);else throw TypeError("Unsupported type of 'params' argument for BitString")}fromASN(e){if(!(e instanceof t4))throw TypeError("Argument 'asn' is not instance of ASN.1 BitString");return this.unusedBits=e.valueBlock.unusedBits,this.value=e.valueBlock.valueHex,this}toASN(){return new t4({unusedBits:this.unusedBits,valueHex:this.value})}toSchema(e){return new t4({name:e})}toNumber(){let e="";for(let t of new Uint8Array(this.value))e+=t.toString(2).padStart(8,"0");return e=e.split("").reverse().join(""),this.unusedBits&&(e=e.slice(this.unusedBits).padStart(this.unusedBits,"0")),parseInt(e,2)}fromNumber(e){let t=e.toString(2),r=t.length+7>>3;this.unusedBits=(r<<3)-t.length;let i=new Uint8Array(r);t=t.padStart(r<<3,"0").split("").reverse().join("");let s=0;for(;s<r;)i[s]=parseInt(t.slice(s<<3,(s<<3)+8),2),s++;this.value=i.buffer}}class rL{get byteLength(){return this.buffer.byteLength}get byteOffset(){return 0}constructor(e){"number"==typeof e?this.buffer=new ArrayBuffer(e):tm.BufferSourceConverter.isBufferSource(e)?this.buffer=tm.BufferSourceConverter.toArrayBuffer(e):Array.isArray(e)?this.buffer=new Uint8Array(e):this.buffer=new ArrayBuffer(0)}fromASN(e){if(!(e instanceof t2))throw TypeError("Argument 'asn' is not instance of ASN.1 OctetString");return this.buffer=e.valueBlock.valueHex,this}toASN(){return new t2({valueHex:this.buffer})}toSchema(e){return new t2({name:e})}}let rH={fromASN:e=>e instanceof tX?null:e.valueBeforeDecodeView,toASN:e=>{if(null===e)return new tX;let t=tq(e);if(t.result.error)throw Error(t.result.error);return t.result}},rM={fromASN:e=>e.valueBlock.valueHexView.byteLength>=4?e.valueBlock.toString():e.valueBlock.valueDec,toASN:e=>new t6({value:+e})},rF={fromASN:e=>e.valueBlock.valueDec,toASN:e=>new t9({value:e})},rz={fromASN:e=>e.valueBlock.valueHexView,toASN:e=>new t6({valueHex:e})},r$={fromASN:e=>e.valueBlock.valueHexView,toASN:e=>new t4({valueHex:e})},rK={fromASN:e=>e.valueBlock.toString(),toASN:e=>new rt({value:e})},rW={fromASN:e=>e.valueBlock.value,toASN:e=>new t0({value:e})},rq={fromASN:e=>e.valueBlock.valueHexView,toASN:e=>new t2({valueHex:e})};function rG(e){return{fromASN:e=>e.valueBlock.value,toASN:t=>new e({value:t})}}let rJ=rG(rh),rY=rG(rd),rZ=rG(ry),rX=rG(rg),rQ=rG(rm),r0=rG(rv),r1=rG(rb),r2=rG(rx),r8=rG(rS),r4=rG(rw),r5=rG(r_),r3=rG(rA),r6={fromASN:e=>e.toDate(),toASN:e=>new rk({valueDate:e})},r9={fromASN:e=>e.toDate(),toASN:e=>new rC({valueDate:e})},r7={fromASN:()=>null,toASN:()=>new tX};function ie(e){switch(e){case S.Any:return rH;case S.BitString:return r$;case S.BmpString:return rY;case S.Boolean:return rW;case S.CharacterString:return r3;case S.Enumerated:return rF;case S.GeneralString:return r5;case S.GeneralizedTime:return r9;case S.GraphicString:return r8;case S.IA5String:return r2;case S.Integer:return rM;case S.Null:return r7;case S.NumericString:return rX;case S.ObjectIdentifier:return rK;case S.OctetString:return rq;case S.PrintableString:return rQ;case S.TeletexString:return r0;case S.UTCTime:return r6;case S.UniversalString:return rZ;case S.Utf8String:return rJ;case S.VideotexString:return r1;case S.VisibleString:return r4;default:return null}}var it=e.i(60922);function ir(e){return"function"==typeof e&&e.prototype?!!e.prototype.toASN&&!!e.prototype.fromASN||ir(e.prototype):!!(e&&"object"==typeof e&&"toASN"in e&&"fromASN"in e)}let ii=new class{constructor(){this.items=new WeakMap}has(e){return this.items.has(e)}get(e,t=!1){let r=this.items.get(e);if(!r)throw Error(`Cannot get schema for '${e.prototype.constructor.name}' target`);if(t&&!r.schema)throw Error(`Schema '${e.prototype.constructor.name}' doesn't contain ASN.1 schema. Call 'AsnSchemaStorage.cache'.`);return r}cache(e){let t=this.get(e);t.schema||(t.schema=this.create(e,!0))}createDefault(e){let t={type:x.Sequence,items:{}},r=this.findParentSchema(e);return r&&(Object.assign(t,r),t.items=Object.assign({},t.items,r.items)),t}create(e,t){let r=this.items.get(e)||this.createDefault(e),i=[];for(let e in r.items){let s,n=r.items[e],o=t?e:"";if("number"==typeof n.type){let e=S[n.type],t=it[e];if(!t)throw Error(`Cannot get ASN1 class by name '${e}'`);s=new t({name:o})}else ir(n.type)?s=new n.type().toSchema(o):n.optional?this.get(n.type).type===x.Choice?s=new it.Any({name:o}):(s=this.create(n.type,!1)).name=o:s=new it.Any({name:o});let a=!!n.optional||void 0!==n.defaultValue;if(n.repeated&&(s.name="",s=new("set"===n.repeated?it.Set:it.Sequence)({name:"",value:[new it.Repeated({name:o,value:s})]})),null!==n.context&&void 0!==n.context)if(n.implicit)if("number"==typeof n.type||ir(n.type)){let e=n.repeated?it.Constructed:it.Primitive;i.push(new e({name:o,optional:a,idBlock:{tagClass:3,tagNumber:n.context}}))}else{this.cache(n.type);let e=!!n.repeated,t=e?s:this.get(n.type,!0).schema;t="valueBlock"in t?t.valueBlock.value:t.value,i.push(new it.Constructed({name:e?"":o,optional:a,idBlock:{tagClass:3,tagNumber:n.context},value:t}))}else i.push(new it.Constructed({optional:a,idBlock:{tagClass:3,tagNumber:n.context},value:[s]}));else s.optional=a,i.push(s)}switch(r.type){case x.Sequence:return new it.Sequence({value:i,name:""});case x.Set:return new it.Set({value:i,name:""});case x.Choice:return new it.Choice({value:i,name:""});default:throw Error("Unsupported ASN1 type in use")}}set(e,t){return this.items.set(e,t),this}findParentSchema(e){let t=Object.getPrototypeOf(e);return t?this.items.get(t)||this.findParentSchema(t):null}},is=e=>t=>{let r;ii.has(t)?r=ii.get(t):(r=ii.createDefault(t),ii.set(t,r)),Object.assign(r,e)},io=e=>(t,r)=>{let i;ii.has(t.constructor)?i=ii.get(t.constructor):(i=ii.createDefault(t.constructor),ii.set(t.constructor,i));let s=Object.assign({},e);if("number"==typeof s.type&&!s.converter){let i=ie(e.type);if(!i)throw Error(`Cannot get default converter for property '${r}' of ${t.constructor.name}`);s.converter=i}s.raw=e.raw,i.items[r]=s};class ia extends Error{constructor(){super(...arguments),this.schemas=[]}}class il{static parse(e,t){let r=it.fromBER(e);if(r.result.error)throw Error(r.result.error);return this.fromASN(r.result,t)}static fromASN(e,t){try{if(ir(t))return new t().fromASN(e);let r=ii.get(t);ii.cache(t);let i=r.schema,s=this.handleChoiceTypes(e,r,t,i);if(null==s?void 0:s.result)return s.result;(null==s?void 0:s.targetSchema)&&(i=s.targetSchema);let n=this.handleSequenceTypes(e,r,t,i),o=new t;if(function e(t){var r;if(t){let i=Object.getPrototypeOf(t);return(null==(r=null==i?void 0:i.prototype)?void 0:r.constructor)===Array||e(i)}return!1}(t))return this.handleArrayTypes(e,r,t);return this.processSchemaItems(r,n,o),o}catch(e){throw e instanceof ia&&e.schemas.push(t.name),e}}static handleChoiceTypes(e,t,r,i){if(e.constructor===it.Constructed&&t.type===x.Choice&&3===e.idBlock.tagClass)for(let i in t.items){let s=t.items[i];if(s.context===e.idBlock.tagNumber&&s.implicit&&"function"==typeof s.type&&ii.has(s.type)){let t=ii.get(s.type);if(t&&t.type===x.Sequence){let t=new it.Sequence;if("value"in e.valueBlock&&Array.isArray(e.valueBlock.value)&&"value"in t.valueBlock){t.valueBlock.value=e.valueBlock.value;let n=this.fromASN(t,s.type),o=new r;return o[i]=n,{result:o}}}}}else if(e.constructor===it.Constructed&&t.type!==x.Choice){let r=new it.Constructed({idBlock:{tagClass:3,tagNumber:e.idBlock.tagNumber},value:t.schema.valueBlock.value});for(let r in t.items)delete e[r];return{targetSchema:r}}return null}static handleSequenceTypes(e,t,r,i){if(t.type===x.Sequence){let t=it.compareSchema({},e,i);if(!t.verified)throw new ia(`Data does not match to ${r.name} ASN1 schema.${t.result.error?` ${t.result.error}`:""}`);return t}{let t=it.compareSchema({},e,i);if(!t.verified)throw new ia(`Data does not match to ${r.name} ASN1 schema.${t.result.error?` ${t.result.error}`:""}`);return t}}static processRepeatedField(e,t,r){let i=e.slice(t);if(1===i.length&&"Sequence"===i[0].constructor.name){let e=i[0];e.valueBlock&&e.valueBlock.value&&Array.isArray(e.valueBlock.value)&&(i=e.valueBlock.value)}if("number"!=typeof r.type)return i.filter(e=>e&&e.valueBlock).map(e=>{try{return this.fromASN(e,r.type)}catch{return}}).filter(e=>void 0!==e);{let e=ie(r.type);if(!e)throw Error(`No converter for ASN.1 type ${r.type}`);return i.filter(e=>e&&e.valueBlock).map(t=>{try{return e.fromASN(t)}catch{return}}).filter(e=>void 0!==e)}}static processPrimitiveField(e,t){let r=ie(t.type);if(!r)throw Error(`No converter for ASN.1 type ${t.type}`);return r.fromASN(e)}static isOptionalChoiceField(e){return e.optional&&"function"==typeof e.type&&ii.has(e.type)&&ii.get(e.type).type===x.Choice}static processOptionalChoiceField(e,t){try{let r=this.fromASN(e,t.type);return{processed:!0,value:r}}catch(e){if(e instanceof ia&&/Wrong values for Choice type/.test(e.message))return{processed:!1};throw e}}static handleArrayTypes(e,t,r){if(!("value"in e.valueBlock&&Array.isArray(e.valueBlock.value)))throw Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");let i=t.itemType;if("number"!=typeof i)return r.from(e.valueBlock.value,e=>this.fromASN(e,i));{let t=ie(i);if(!t)throw Error(`Cannot get default converter for array item of ${r.name} ASN1 schema`);return r.from(e.valueBlock.value,e=>t.fromASN(e))}}static processSchemaItems(e,t,r){for(let i in e.items){let s,n=t.result[i];if(!n)continue;let o=e.items[i],a=o.type;(s="number"==typeof a||ir(a)?this.processPrimitiveSchemaItem(n,o,a):this.processComplexSchemaItem(n,o,a))&&"object"==typeof s&&"value"in s&&"raw"in s?(r[i]=s.value,r[`${i}Raw`]=s.raw):r[i]=s}}static processPrimitiveSchemaItem(e,t,r){var i;let s=null!=(i=t.converter)?i:ir(r)?new r:null;if(!s)throw Error("Converter is empty");return t.repeated?this.processRepeatedPrimitiveItem(e,t,s):this.processSinglePrimitiveItem(e,t,r,s)}static processRepeatedPrimitiveItem(e,t,r){if(!t.implicit)return Array.from(e,e=>r.fromASN(e));{let i=new("sequence"===t.repeated?it.Sequence:it.Set);i.valueBlock=e.valueBlock;let s=it.fromBER(i.toBER(!1));if(-1===s.offset)throw Error(`Cannot parse the child item. ${s.result.error}`);if(!("value"in s.result.valueBlock&&Array.isArray(s.result.valueBlock.value)))throw Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");return Array.from(s.result.valueBlock.value,e=>r.fromASN(e))}}static processSinglePrimitiveItem(e,t,r,i){let s=e;if(t.implicit){let e;if(ir(r))e=new r().toSchema("");else{let t=S[r],i=it[t];if(!i)throw Error(`Cannot get '${t}' class from asn1js module`);e=new i}e.valueBlock=s.valueBlock,s=it.fromBER(e.toBER(!1)).result}return i.fromASN(s)}static processComplexSchemaItem(e,t,r){if(t.repeated){if(!Array.isArray(e))throw Error("Cannot get list of items from the ASN.1 parsed value. ASN.1 value should be iterable.");return Array.from(e,e=>this.fromASN(e,r))}{let i=this.handleImplicitTagging(e,t,r);if(this.isOptionalChoiceField(t))try{return this.fromASN(i,r)}catch(e){if(e instanceof ia&&/Wrong values for Choice type/.test(e.message))return;throw e}{let s=this.fromASN(i,r);return t.raw?{value:s,raw:e.valueBeforeDecodeView}:s}}}static handleImplicitTagging(e,t,r){if(t.implicit&&"number"==typeof t.context){let t=ii.get(r);if(t.type===x.Sequence){let t=new it.Sequence;if("value"in e.valueBlock&&Array.isArray(e.valueBlock.value)&&"value"in t.valueBlock)return t.valueBlock.value=e.valueBlock.value,t}else if(t.type===x.Set){let t=new it.Set;if("value"in e.valueBlock&&Array.isArray(e.valueBlock.value)&&"value"in t.valueBlock)return t.valueBlock.value=e.valueBlock.value,t}}return e}}class ic{static serialize(e){return e instanceof tF?e.toBER(!1):this.toASN(e).toBER(!1)}static toASN(e){let t;if(e&&"object"==typeof e&&ir(e))return e.toASN();if(!(e&&"object"==typeof e))throw TypeError("Parameter 1 should be type of Object.");let r=e.constructor,i=ii.get(r);ii.cache(r);let s=[];if(i.itemType){if(!Array.isArray(e))throw TypeError("Parameter 1 should be type of Array.");if("number"==typeof i.itemType){let t=ie(i.itemType);if(!t)throw Error(`Cannot get default converter for array item of ${r.name} ASN1 schema`);s=e.map(e=>t.toASN(e))}else s=e.map(e=>this.toAsnItem({type:i.itemType},"[]",r,e))}else for(let t in i.items){let n=i.items[t],o=e[t];if(void 0===o||n.defaultValue===o||"object"==typeof n.defaultValue&&"object"==typeof o&&function(e,t){if(!(e&&t)||e.byteLength!==t.byteLength)return!1;let r=new Uint8Array(e),i=new Uint8Array(t);for(let t=0;t<e.byteLength;t++)if(r[t]!==i[t])return!1;return!0}(this.serialize(n.defaultValue),this.serialize(o)))continue;let a=ic.toAsnItem(n,t,r,o);if("number"==typeof n.context)if(n.implicit)if(!n.repeated&&("number"==typeof n.type||ir(n.type))){let e={};e.valueHex=a instanceof tX?a.valueBeforeDecodeView:a.valueBlock.toBER(),s.push(new tK({optional:n.optional,idBlock:{tagClass:3,tagNumber:n.context},...e}))}else s.push(new tJ({optional:n.optional,idBlock:{tagClass:3,tagNumber:n.context},value:a.valueBlock.value}));else s.push(new tJ({optional:n.optional,idBlock:{tagClass:3,tagNumber:n.context},value:[a]}));else n.repeated?s=s.concat(a):s.push(a)}switch(i.type){case x.Sequence:t=new rn({value:s});break;case x.Set:t=new ro({value:s});break;case x.Choice:if(!s[0])throw Error(`Schema '${r.name}' has wrong data. Choice cannot be empty.`);t=s[0]}return t}static toAsnItem(e,t,r,i){let s;if("number"==typeof e.type){let n=e.converter;if(!n)throw Error(`Property '${t}' doesn't have converter for type ${S[e.type]} in schema '${r.name}'`);if(e.repeated){if(!Array.isArray(i))throw TypeError("Parameter 'objProp' should be type of Array.");let t=Array.from(i,e=>n.toASN(e));s=new("sequence"===e.repeated?rn:ro)({value:t})}else s=n.toASN(i)}else if(e.repeated){if(!Array.isArray(i))throw TypeError("Parameter 'objProp' should be type of Array.");let t=Array.from(i,e=>this.toASN(e));s=new("sequence"===e.repeated?rn:ro)({value:t})}else s=this.toASN(i);return s}}class iu extends Array{constructor(e=[]){if("number"==typeof e)super(e);else for(const t of(super(),e))this.push(t)}}class ih{static serialize(e){return ic.serialize(e)}static parse(e,t){return il.parse(e,t)}static toString(e){let t=tq(tm.BufferSourceConverter.isBufferSource(e)?tm.BufferSourceConverter.toArrayBuffer(e):ih.serialize(e));if(-1===t.offset)throw Error(`Cannot decode ASN.1 data. ${t.result.error}`);return t.result.toString()}}var ip=e.i(90571);class id{static isIPv4(e){return/^(\d{1,3}\.){3}\d{1,3}$/.test(e)}static parseIPv4(e){let t=e.split(".");if(4!==t.length)throw Error("Invalid IPv4 address");return t.map(e=>{let t=parseInt(e,10);if(isNaN(t)||t<0||t>255)throw Error("Invalid IPv4 address part");return t})}static parseIPv6(e){let t=this.expandIPv6(e).split(":");if(8!==t.length)throw Error("Invalid IPv6 address");return t.reduce((e,t)=>{let r=parseInt(t,16);if(isNaN(r)||r<0||r>65535)throw Error("Invalid IPv6 address part");return e.push(r>>8&255),e.push(255&r),e},[])}static expandIPv6(e){if(!e.includes("::"))return e;let t=e.split("::");if(t.length>2)throw Error("Invalid IPv6 address");let r=t[0]?t[0].split(":"):[],i=t[1]?t[1].split(":"):[],s=8-(r.length+i.length);if(s<0)throw Error("Invalid IPv6 address");return[...r,...Array(s).fill("0"),...i].join(":")}static formatIPv6(e){let t=[];for(let r=0;r<16;r+=2)t.push((e[r]<<8|e[r+1]).toString(16));return this.compressIPv6(t.join(":"))}static compressIPv6(e){let t=e.split(":"),r=-1,i=0,s=-1,n=0;for(let e=0;e<t.length;e++)"0"===t[e]?(-1===s&&(s=e),n++):(n>i&&(r=s,i=n),s=-1,n=0);if(n>i&&(r=s,i=n),i>1){let e=t.slice(0,r).join(":"),s=t.slice(r+i).join(":");return`${e}::${s}`}return e}static parseCIDR(e){let[t,r]=e.split("/"),i=parseInt(r,10);if(this.isIPv4(t)){if(i<0||i>32)throw Error("Invalid IPv4 prefix length");return[this.parseIPv4(t),i]}if(i<0||i>128)throw Error("Invalid IPv6 prefix length");return[this.parseIPv6(t),i]}static decodeIP(e){if(64===e.length&&0===parseInt(e,16))return"::/0";if(16!==e.length)return e;let t=parseInt(e.slice(8),16).toString(2).split("").reduce((e,t)=>e+ +t,0),r=e.slice(0,8).replace(/(.{2})/g,e=>`${parseInt(e,16)}.`);return r=r.slice(0,-1),`${r}/${t}`}static toString(e){let t=new Uint8Array(e);if(4===t.length)return Array.from(t).join(".");if(16===t.length)return this.formatIPv6(t);if(8===t.length||32===t.length){let e=t.length/2,r=t.slice(0,e),i=t.slice(e);if(t.every(e=>0===e))return 8===t.length?"0.0.0.0/0":"::/0";let s=i.reduce((e,t)=>e+(t.toString(2).match(/1/g)||[]).length,0);if(8===t.length){let e=Array.from(r).join(".");return`${e}/${s}`}{let e=this.formatIPv6(r);return`${e}/${s}`}}return this.decodeIP(tm.Convert.ToHex(e))}static fromString(e){if(e.includes("/")){let[t,r]=this.parseCIDR(e),i=new Uint8Array(t.length),s=r;for(let e=0;e<i.length;e++)s>=8?(i[e]=255,s-=8):s>0&&(i[e]=255<<8-s,s=0);let n=new Uint8Array(2*t.length);return n.set(t,0),n.set(i,t.length),n.buffer}return new Uint8Array(this.isIPv4(e)?this.parseIPv4(e):this.parseIPv6(e)).buffer}}let iy=class{constructor(e={}){Object.assign(this,e)}toString(){return this.bmpString||this.printableString||this.teletexString||this.universalString||this.utf8String||""}};(0,ip.__decorate)([io({type:S.TeletexString})],iy.prototype,"teletexString",void 0),(0,ip.__decorate)([io({type:S.PrintableString})],iy.prototype,"printableString",void 0),(0,ip.__decorate)([io({type:S.UniversalString})],iy.prototype,"universalString",void 0),(0,ip.__decorate)([io({type:S.Utf8String})],iy.prototype,"utf8String",void 0),(0,ip.__decorate)([io({type:S.BmpString})],iy.prototype,"bmpString",void 0),iy=(0,ip.__decorate)([is({type:x.Choice})],iy);let ig=class extends iy{constructor(e={}){super(e),Object.assign(this,e)}toString(){return this.ia5String||(this.anyValue?tm.Convert.ToHex(this.anyValue):super.toString())}};(0,ip.__decorate)([io({type:S.IA5String})],ig.prototype,"ia5String",void 0),(0,ip.__decorate)([io({type:S.Any})],ig.prototype,"anyValue",void 0),ig=(0,ip.__decorate)([is({type:x.Choice})],ig);class im{constructor(e={}){this.type="",this.value=new ig,Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.ObjectIdentifier})],im.prototype,"type",void 0),(0,ip.__decorate)([io({type:ig})],im.prototype,"value",void 0);let iv=w=class extends iu{constructor(e){super(e),Object.setPrototypeOf(this,w.prototype)}};iv=w=(0,ip.__decorate)([is({type:x.Set,itemType:im})],iv);let ib=_=class extends iu{constructor(e){super(e),Object.setPrototypeOf(this,_.prototype)}};ib=_=(0,ip.__decorate)([is({type:x.Sequence,itemType:iv})],ib);let ix=A=class extends ib{constructor(e){super(e),Object.setPrototypeOf(this,A.prototype)}};ix=A=(0,ip.__decorate)([is({type:x.Sequence})],ix);class iS{constructor(e={}){this.typeId="",this.value=new ArrayBuffer(0),Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.ObjectIdentifier})],iS.prototype,"typeId",void 0),(0,ip.__decorate)([io({type:S.Any,context:0})],iS.prototype,"value",void 0);class iw{constructor(e={}){this.partyName=new iy,Object.assign(this,e)}}(0,ip.__decorate)([io({type:iy,optional:!0,context:0,implicit:!0})],iw.prototype,"nameAssigner",void 0),(0,ip.__decorate)([io({type:iy,context:1,implicit:!0})],iw.prototype,"partyName",void 0);let i_=class{constructor(e={}){Object.assign(this,e)}};(0,ip.__decorate)([io({type:iS,context:0,implicit:!0})],i_.prototype,"otherName",void 0),(0,ip.__decorate)([io({type:S.IA5String,context:1,implicit:!0})],i_.prototype,"rfc822Name",void 0),(0,ip.__decorate)([io({type:S.IA5String,context:2,implicit:!0})],i_.prototype,"dNSName",void 0),(0,ip.__decorate)([io({type:S.Any,context:3,implicit:!0})],i_.prototype,"x400Address",void 0),(0,ip.__decorate)([io({type:ix,context:4,implicit:!1})],i_.prototype,"directoryName",void 0),(0,ip.__decorate)([io({type:iw,context:5})],i_.prototype,"ediPartyName",void 0),(0,ip.__decorate)([io({type:S.IA5String,context:6,implicit:!0})],i_.prototype,"uniformResourceIdentifier",void 0),(0,ip.__decorate)([io({type:S.OctetString,context:7,implicit:!0,converter:{fromASN:e=>id.toString(rq.fromASN(e)),toASN:e=>rq.toASN(id.fromString(e))}})],i_.prototype,"iPAddress",void 0),(0,ip.__decorate)([io({type:S.ObjectIdentifier,context:8,implicit:!0})],i_.prototype,"registeredID",void 0),i_=(0,ip.__decorate)([is({type:x.Choice})],i_);let iA="1.3.6.1.5.5.7",ik=`${iA}.1`,iC=`${iA}.3`,iB=`${iA}.48`,iN=`${iB}.1`,ij=`${iB}.2`,iE=`${iB}.3`,iO=`${iB}.5`,iI="2.5.29",iT=`${ik}.1`;class iP{constructor(e={}){this.accessMethod="",this.accessLocation=new i_,Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.ObjectIdentifier})],iP.prototype,"accessMethod",void 0),(0,ip.__decorate)([io({type:i_})],iP.prototype,"accessLocation",void 0);let iU=k=class extends iu{constructor(e){super(e),Object.setPrototypeOf(this,k.prototype)}};iU=k=(0,ip.__decorate)([is({type:x.Sequence,itemType:iP})],iU);let iD=`${iI}.35`;class iV extends rL{}class iR{constructor(e={}){e&&Object.assign(this,e)}}(0,ip.__decorate)([io({type:iV,context:0,optional:!0,implicit:!0})],iR.prototype,"keyIdentifier",void 0),(0,ip.__decorate)([io({type:i_,context:1,optional:!0,implicit:!0,repeated:"sequence"})],iR.prototype,"authorityCertIssuer",void 0),(0,ip.__decorate)([io({type:S.Integer,context:2,optional:!0,implicit:!0,converter:rz})],iR.prototype,"authorityCertSerialNumber",void 0);let iL=`${iI}.19`;class iH{constructor(e={}){this.cA=!1,Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.Boolean,defaultValue:!1})],iH.prototype,"cA",void 0),(0,ip.__decorate)([io({type:S.Integer,optional:!0})],iH.prototype,"pathLenConstraint",void 0);let iM=C=class extends iu{constructor(e){super(e),Object.setPrototypeOf(this,C.prototype)}};iM=C=(0,ip.__decorate)([is({type:x.Sequence,itemType:i_})],iM);let iF=B=class extends iM{constructor(e){super(e),Object.setPrototypeOf(this,B.prototype)}};iF=B=(0,ip.__decorate)([is({type:x.Sequence})],iF);let iz=`${iI}.32`,i$=class{constructor(e={}){Object.assign(this,e)}toString(){return this.ia5String||this.visibleString||this.bmpString||this.utf8String||""}};(0,ip.__decorate)([io({type:S.IA5String})],i$.prototype,"ia5String",void 0),(0,ip.__decorate)([io({type:S.VisibleString})],i$.prototype,"visibleString",void 0),(0,ip.__decorate)([io({type:S.BmpString})],i$.prototype,"bmpString",void 0),(0,ip.__decorate)([io({type:S.Utf8String})],i$.prototype,"utf8String",void 0),i$=(0,ip.__decorate)([is({type:x.Choice})],i$);class iK{constructor(e={}){this.organization=new i$,this.noticeNumbers=[],Object.assign(this,e)}}(0,ip.__decorate)([io({type:i$})],iK.prototype,"organization",void 0),(0,ip.__decorate)([io({type:S.Integer,repeated:"sequence"})],iK.prototype,"noticeNumbers",void 0);class iW{constructor(e={}){Object.assign(this,e)}}(0,ip.__decorate)([io({type:iK,optional:!0})],iW.prototype,"noticeRef",void 0),(0,ip.__decorate)([io({type:i$,optional:!0})],iW.prototype,"explicitText",void 0);let iq=class{constructor(e={}){Object.assign(this,e)}};(0,ip.__decorate)([io({type:S.IA5String})],iq.prototype,"cPSuri",void 0),(0,ip.__decorate)([io({type:iW})],iq.prototype,"userNotice",void 0),iq=(0,ip.__decorate)([is({type:x.Choice})],iq);class iG{constructor(e={}){this.policyQualifierId="",this.qualifier=new ArrayBuffer(0),Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.ObjectIdentifier})],iG.prototype,"policyQualifierId",void 0),(0,ip.__decorate)([io({type:S.Any})],iG.prototype,"qualifier",void 0);class iJ{constructor(e={}){this.policyIdentifier="",Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.ObjectIdentifier})],iJ.prototype,"policyIdentifier",void 0),(0,ip.__decorate)([io({type:iG,repeated:"sequence",optional:!0})],iJ.prototype,"policyQualifiers",void 0);let iY=N=class extends iu{constructor(e){super(e),Object.setPrototypeOf(this,N.prototype)}};iY=N=(0,ip.__decorate)([is({type:x.Sequence,itemType:iJ})],iY);let iZ=class{constructor(e=0){this.value=e}};(0,ip.__decorate)([io({type:S.Integer})],iZ.prototype,"value",void 0),iZ=(0,ip.__decorate)([is({type:x.Choice})],iZ);let iX=class extends iZ{};iX=(0,ip.__decorate)([is({type:x.Choice})],iX);let iQ=`${iI}.31`;(i=E||(E={}))[i.unused=1]="unused",i[i.keyCompromise=2]="keyCompromise",i[i.cACompromise=4]="cACompromise",i[i.affiliationChanged=8]="affiliationChanged",i[i.superseded=16]="superseded",i[i.cessationOfOperation=32]="cessationOfOperation",i[i.certificateHold=64]="certificateHold",i[i.privilegeWithdrawn=128]="privilegeWithdrawn",i[i.aACompromise=256]="aACompromise";class i0 extends rR{toJSON(){let e=[],t=this.toNumber();return t&E.aACompromise&&e.push("aACompromise"),t&E.affiliationChanged&&e.push("affiliationChanged"),t&E.cACompromise&&e.push("cACompromise"),t&E.certificateHold&&e.push("certificateHold"),t&E.cessationOfOperation&&e.push("cessationOfOperation"),t&E.keyCompromise&&e.push("keyCompromise"),t&E.privilegeWithdrawn&&e.push("privilegeWithdrawn"),t&E.superseded&&e.push("superseded"),t&E.unused&&e.push("unused"),e}toString(){return`[${this.toJSON().join(", ")}]`}}let i1=class{constructor(e={}){Object.assign(this,e)}};(0,ip.__decorate)([io({type:i_,context:0,repeated:"sequence",implicit:!0})],i1.prototype,"fullName",void 0),(0,ip.__decorate)([io({type:iv,context:1,implicit:!0})],i1.prototype,"nameRelativeToCRLIssuer",void 0),i1=(0,ip.__decorate)([is({type:x.Choice})],i1);class i2{constructor(e={}){Object.assign(this,e)}}(0,ip.__decorate)([io({type:i1,context:0,optional:!0})],i2.prototype,"distributionPoint",void 0),(0,ip.__decorate)([io({type:i0,context:1,optional:!0,implicit:!0})],i2.prototype,"reasons",void 0),(0,ip.__decorate)([io({type:i_,context:2,optional:!0,repeated:"sequence",implicit:!0})],i2.prototype,"cRLIssuer",void 0);let i8=j=class extends iu{constructor(e){super(e),Object.setPrototypeOf(this,j.prototype)}};i8=j=(0,ip.__decorate)([is({type:x.Sequence,itemType:i2})],i8);let i4=O=class extends i8{constructor(e){super(e),Object.setPrototypeOf(this,O.prototype)}};i4=O=(0,ip.__decorate)([is({type:x.Sequence,itemType:i2})],i4);class i5{constructor(e={}){this.onlyContainsUserCerts=i5.ONLY,this.onlyContainsCACerts=i5.ONLY,this.indirectCRL=i5.ONLY,this.onlyContainsAttributeCerts=i5.ONLY,Object.assign(this,e)}}i5.ONLY=!1,(0,ip.__decorate)([io({type:i1,context:0,optional:!0})],i5.prototype,"distributionPoint",void 0),(0,ip.__decorate)([io({type:S.Boolean,context:1,defaultValue:i5.ONLY,implicit:!0})],i5.prototype,"onlyContainsUserCerts",void 0),(0,ip.__decorate)([io({type:S.Boolean,context:2,defaultValue:i5.ONLY,implicit:!0})],i5.prototype,"onlyContainsCACerts",void 0),(0,ip.__decorate)([io({type:i0,context:3,optional:!0,implicit:!0})],i5.prototype,"onlySomeReasons",void 0),(0,ip.__decorate)([io({type:S.Boolean,context:4,defaultValue:i5.ONLY,implicit:!0})],i5.prototype,"indirectCRL",void 0),(0,ip.__decorate)([io({type:S.Boolean,context:5,defaultValue:i5.ONLY,implicit:!0})],i5.prototype,"onlyContainsAttributeCerts",void 0),(s=I||(I={}))[s.unspecified=0]="unspecified",s[s.keyCompromise=1]="keyCompromise",s[s.cACompromise=2]="cACompromise",s[s.affiliationChanged=3]="affiliationChanged",s[s.superseded=4]="superseded",s[s.cessationOfOperation=5]="cessationOfOperation",s[s.certificateHold=6]="certificateHold",s[s.removeFromCRL=8]="removeFromCRL",s[s.privilegeWithdrawn=9]="privilegeWithdrawn",s[s.aACompromise=10]="aACompromise";let i3=class{constructor(e=I.unspecified){this.reason=I.unspecified,this.reason=e}toJSON(){return I[this.reason]}toString(){return this.toJSON()}};(0,ip.__decorate)([io({type:S.Enumerated})],i3.prototype,"reason",void 0),i3=(0,ip.__decorate)([is({type:x.Choice})],i3);let i6=`${iI}.37`,i9=T=class extends iu{constructor(e){super(e),Object.setPrototypeOf(this,T.prototype)}};i9=T=(0,ip.__decorate)([is({type:x.Sequence,itemType:S.ObjectIdentifier})],i9);let i7=`${iC}.1`,se=`${iC}.2`,st=`${iC}.3`,sr=`${iC}.4`,si=`${iC}.8`,ss=`${iC}.9`,sn=class{constructor(e=new ArrayBuffer(0)){this.value=e}};(0,ip.__decorate)([io({type:S.Integer,converter:rz})],sn.prototype,"value",void 0),sn=(0,ip.__decorate)([is({type:x.Choice})],sn);let so=class{constructor(e){this.value=new Date,e&&(this.value=e)}};(0,ip.__decorate)([io({type:S.GeneralizedTime})],so.prototype,"value",void 0),so=(0,ip.__decorate)([is({type:x.Choice})],so);let sa=`${iI}.18`,sl=P=class extends iM{constructor(e){super(e),Object.setPrototypeOf(this,P.prototype)}};sl=P=(0,ip.__decorate)([is({type:x.Sequence})],sl);let sc=`${iI}.15`;(n=U||(U={}))[n.digitalSignature=1]="digitalSignature",n[n.nonRepudiation=2]="nonRepudiation",n[n.keyEncipherment=4]="keyEncipherment",n[n.dataEncipherment=8]="dataEncipherment",n[n.keyAgreement=16]="keyAgreement",n[n.keyCertSign=32]="keyCertSign",n[n.cRLSign=64]="cRLSign",n[n.encipherOnly=128]="encipherOnly",n[n.decipherOnly=256]="decipherOnly";class su extends rR{toJSON(){let e=this.toNumber(),t=[];return e&U.cRLSign&&t.push("crlSign"),e&U.dataEncipherment&&t.push("dataEncipherment"),e&U.decipherOnly&&t.push("decipherOnly"),e&U.digitalSignature&&t.push("digitalSignature"),e&U.encipherOnly&&t.push("encipherOnly"),e&U.keyAgreement&&t.push("keyAgreement"),e&U.keyCertSign&&t.push("keyCertSign"),e&U.keyEncipherment&&t.push("keyEncipherment"),e&U.nonRepudiation&&t.push("nonRepudiation"),t}toString(){return`[${this.toJSON().join(", ")}]`}}class sh{constructor(e={}){this.base=new i_,this.minimum=0,Object.assign(this,e)}}(0,ip.__decorate)([io({type:i_})],sh.prototype,"base",void 0),(0,ip.__decorate)([io({type:S.Integer,context:0,defaultValue:0,implicit:!0})],sh.prototype,"minimum",void 0),(0,ip.__decorate)([io({type:S.Integer,context:1,optional:!0,implicit:!0})],sh.prototype,"maximum",void 0);let sp=D=class extends iu{constructor(e){super(e),Object.setPrototypeOf(this,D.prototype)}};sp=D=(0,ip.__decorate)([is({type:x.Sequence,itemType:sh})],sp);class sd{constructor(e={}){Object.assign(this,e)}}(0,ip.__decorate)([io({type:sp,context:0,optional:!0,implicit:!0})],sd.prototype,"permittedSubtrees",void 0),(0,ip.__decorate)([io({type:sp,context:1,optional:!0,implicit:!0})],sd.prototype,"excludedSubtrees",void 0);class sf{constructor(e={}){Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.Integer,context:0,implicit:!0,optional:!0,converter:rz})],sf.prototype,"requireExplicitPolicy",void 0),(0,ip.__decorate)([io({type:S.Integer,context:1,implicit:!0,optional:!0,converter:rz})],sf.prototype,"inhibitPolicyMapping",void 0);class sy{constructor(e={}){this.issuerDomainPolicy="",this.subjectDomainPolicy="",Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.ObjectIdentifier})],sy.prototype,"issuerDomainPolicy",void 0),(0,ip.__decorate)([io({type:S.ObjectIdentifier})],sy.prototype,"subjectDomainPolicy",void 0);let sg=V=class extends iu{constructor(e){super(e),Object.setPrototypeOf(this,V.prototype)}};sg=V=(0,ip.__decorate)([is({type:x.Sequence,itemType:sy})],sg);let sm=`${iI}.17`,sv=R=class extends iM{constructor(e){super(e),Object.setPrototypeOf(this,R.prototype)}};sv=R=(0,ip.__decorate)([is({type:x.Sequence})],sv);class sb{constructor(e={}){this.type="",this.values=[],Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.ObjectIdentifier})],sb.prototype,"type",void 0),(0,ip.__decorate)([io({type:S.Any,repeated:"set"})],sb.prototype,"values",void 0);let sx=L=class extends iu{constructor(e){super(e),Object.setPrototypeOf(this,L.prototype)}};sx=L=(0,ip.__decorate)([is({type:x.Sequence,itemType:sb})],sx);let sS=`${iI}.14`;class sw extends iV{}class s_{constructor(e={}){Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.GeneralizedTime,context:0,implicit:!0,optional:!0})],s_.prototype,"notBefore",void 0),(0,ip.__decorate)([io({type:S.GeneralizedTime,context:1,implicit:!0,optional:!0})],s_.prototype,"notAfter",void 0),(o=H||(H={}))[o.keyUpdateAllowed=1]="keyUpdateAllowed",o[o.newExtensions=2]="newExtensions",o[o.pKIXCertificate=4]="pKIXCertificate";class sA extends rR{toJSON(){let e=[],t=this.toNumber();return t&H.pKIXCertificate&&e.push("pKIXCertificate"),t&H.newExtensions&&e.push("newExtensions"),t&H.keyUpdateAllowed&&e.push("keyUpdateAllowed"),e}toString(){return`[${this.toJSON().join(", ")}]`}}class sk{constructor(e={}){this.entrustVers="",this.entrustInfoFlags=new sA,Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.GeneralString})],sk.prototype,"entrustVers",void 0),(0,ip.__decorate)([io({type:sA})],sk.prototype,"entrustInfoFlags",void 0);let sC=M=class extends iu{constructor(e){super(e),Object.setPrototypeOf(this,M.prototype)}};sC=M=(0,ip.__decorate)([is({type:x.Sequence,itemType:iP})],sC);class sB{constructor(e={}){this.algorithm="",Object.assign(this,e)}isEqual(e){return e instanceof sB&&e.algorithm==this.algorithm&&(e.parameters&&this.parameters&&tm.isEqual(e.parameters,this.parameters)||e.parameters===this.parameters)}}(0,ip.__decorate)([io({type:S.ObjectIdentifier})],sB.prototype,"algorithm",void 0),(0,ip.__decorate)([io({type:S.Any,optional:!0})],sB.prototype,"parameters",void 0);class sN{constructor(e={}){this.algorithm=new sB,this.subjectPublicKey=new ArrayBuffer(0),Object.assign(this,e)}}(0,ip.__decorate)([io({type:sB})],sN.prototype,"algorithm",void 0),(0,ip.__decorate)([io({type:S.BitString})],sN.prototype,"subjectPublicKey",void 0);let sj=class{constructor(e){if(e)if("string"==typeof e||"number"==typeof e||e instanceof Date){const t=new Date(e);t.getUTCFullYear()>2049?this.generalTime=t:this.utcTime=t}else Object.assign(this,e)}getTime(){let e=this.utcTime||this.generalTime;if(!e)throw Error("Cannot get time from CHOICE object");return e}};(0,ip.__decorate)([io({type:S.UTCTime})],sj.prototype,"utcTime",void 0),(0,ip.__decorate)([io({type:S.GeneralizedTime})],sj.prototype,"generalTime",void 0),sj=(0,ip.__decorate)([is({type:x.Choice})],sj);class sE{constructor(e){this.notBefore=new sj(new Date),this.notAfter=new sj(new Date),e&&(this.notBefore=new sj(e.notBefore),this.notAfter=new sj(e.notAfter))}}(0,ip.__decorate)([io({type:sj})],sE.prototype,"notBefore",void 0),(0,ip.__decorate)([io({type:sj})],sE.prototype,"notAfter",void 0);class sO{constructor(e={}){this.extnID="",this.critical=sO.CRITICAL,this.extnValue=new rL,Object.assign(this,e)}}sO.CRITICAL=!1,(0,ip.__decorate)([io({type:S.ObjectIdentifier})],sO.prototype,"extnID",void 0),(0,ip.__decorate)([io({type:S.Boolean,defaultValue:sO.CRITICAL})],sO.prototype,"critical",void 0),(0,ip.__decorate)([io({type:rL})],sO.prototype,"extnValue",void 0);let sI=F=class extends iu{constructor(e){super(e),Object.setPrototypeOf(this,F.prototype)}};sI=F=(0,ip.__decorate)([is({type:x.Sequence,itemType:sO})],sI),(a=z||(z={}))[a.v1=0]="v1",a[a.v2=1]="v2",a[a.v3=2]="v3";class sT{constructor(e={}){this.version=z.v1,this.serialNumber=new ArrayBuffer(0),this.signature=new sB,this.issuer=new ix,this.validity=new sE,this.subject=new ix,this.subjectPublicKeyInfo=new sN,Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.Integer,context:0,defaultValue:z.v1})],sT.prototype,"version",void 0),(0,ip.__decorate)([io({type:S.Integer,converter:rz})],sT.prototype,"serialNumber",void 0),(0,ip.__decorate)([io({type:sB})],sT.prototype,"signature",void 0),(0,ip.__decorate)([io({type:ix})],sT.prototype,"issuer",void 0),(0,ip.__decorate)([io({type:sE})],sT.prototype,"validity",void 0),(0,ip.__decorate)([io({type:ix})],sT.prototype,"subject",void 0),(0,ip.__decorate)([io({type:sN})],sT.prototype,"subjectPublicKeyInfo",void 0),(0,ip.__decorate)([io({type:S.BitString,context:1,implicit:!0,optional:!0})],sT.prototype,"issuerUniqueID",void 0),(0,ip.__decorate)([io({type:S.BitString,context:2,implicit:!0,optional:!0})],sT.prototype,"subjectUniqueID",void 0),(0,ip.__decorate)([io({type:sI,context:3,optional:!0})],sT.prototype,"extensions",void 0);class sP{constructor(e={}){this.tbsCertificate=new sT,this.signatureAlgorithm=new sB,this.signatureValue=new ArrayBuffer(0),Object.assign(this,e)}}(0,ip.__decorate)([io({type:sT,raw:!0})],sP.prototype,"tbsCertificate",void 0),(0,ip.__decorate)([io({type:sB})],sP.prototype,"signatureAlgorithm",void 0),(0,ip.__decorate)([io({type:S.BitString})],sP.prototype,"signatureValue",void 0);class sU{constructor(e={}){this.userCertificate=new ArrayBuffer(0),this.revocationDate=new sj,Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.Integer,converter:rz})],sU.prototype,"userCertificate",void 0),(0,ip.__decorate)([io({type:sj})],sU.prototype,"revocationDate",void 0),(0,ip.__decorate)([io({type:sO,optional:!0,repeated:"sequence"})],sU.prototype,"crlEntryExtensions",void 0);class sD{constructor(e={}){this.signature=new sB,this.issuer=new ix,this.thisUpdate=new sj,Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.Integer,optional:!0})],sD.prototype,"version",void 0),(0,ip.__decorate)([io({type:sB})],sD.prototype,"signature",void 0),(0,ip.__decorate)([io({type:ix})],sD.prototype,"issuer",void 0),(0,ip.__decorate)([io({type:sj})],sD.prototype,"thisUpdate",void 0),(0,ip.__decorate)([io({type:sj,optional:!0})],sD.prototype,"nextUpdate",void 0),(0,ip.__decorate)([io({type:sU,repeated:"sequence",optional:!0})],sD.prototype,"revokedCertificates",void 0),(0,ip.__decorate)([io({type:sO,optional:!0,context:0,repeated:"sequence"})],sD.prototype,"crlExtensions",void 0);class sV{constructor(e={}){this.tbsCertList=new sD,this.signatureAlgorithm=new sB,this.signature=new ArrayBuffer(0),Object.assign(this,e)}}(0,ip.__decorate)([io({type:sD,raw:!0})],sV.prototype,"tbsCertList",void 0),(0,ip.__decorate)([io({type:sB})],sV.prototype,"signatureAlgorithm",void 0),(0,ip.__decorate)([io({type:S.BitString})],sV.prototype,"signature",void 0);class sR{constructor(e={}){this.issuer=new ix,this.serialNumber=new ArrayBuffer(0),Object.assign(this,e)}}(0,ip.__decorate)([io({type:ix})],sR.prototype,"issuer",void 0),(0,ip.__decorate)([io({type:S.Integer,converter:rz})],sR.prototype,"serialNumber",void 0);let sL=class{constructor(e={}){Object.assign(this,e)}};(0,ip.__decorate)([io({type:sw,context:0,implicit:!0})],sL.prototype,"subjectKeyIdentifier",void 0),(0,ip.__decorate)([io({type:sR})],sL.prototype,"issuerAndSerialNumber",void 0),sL=(0,ip.__decorate)([is({type:x.Choice})],sL),(l=$||($={}))[l.v0=0]="v0",l[l.v1=1]="v1",l[l.v2=2]="v2",l[l.v3=3]="v3",l[l.v4=4]="v4",l[l.v5=5]="v5";let sH=class extends sB{};sH=(0,ip.__decorate)([is({type:x.Sequence})],sH);let sM=class extends sB{};sM=(0,ip.__decorate)([is({type:x.Sequence})],sM);let sF=class extends sB{};sF=(0,ip.__decorate)([is({type:x.Sequence})],sF);let sz=class extends sB{};sz=(0,ip.__decorate)([is({type:x.Sequence})],sz);let s$=class extends sB{};s$=(0,ip.__decorate)([is({type:x.Sequence})],s$);let sK=class extends sB{};sK=(0,ip.__decorate)([is({type:x.Sequence})],sK);class sW{constructor(e={}){this.attrType="",this.attrValues=[],Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.ObjectIdentifier})],sW.prototype,"attrType",void 0),(0,ip.__decorate)([io({type:S.Any,repeated:"set"})],sW.prototype,"attrValues",void 0);class sq{constructor(e={}){this.version=$.v0,this.sid=new sL,this.digestAlgorithm=new sH,this.signatureAlgorithm=new sM,this.signature=new rL,Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.Integer})],sq.prototype,"version",void 0),(0,ip.__decorate)([io({type:sL})],sq.prototype,"sid",void 0),(0,ip.__decorate)([io({type:sH})],sq.prototype,"digestAlgorithm",void 0),(0,ip.__decorate)([io({type:sW,repeated:"set",context:0,implicit:!0,optional:!0,raw:!0})],sq.prototype,"signedAttrs",void 0),(0,ip.__decorate)([io({type:sM})],sq.prototype,"signatureAlgorithm",void 0),(0,ip.__decorate)([io({type:rL})],sq.prototype,"signature",void 0),(0,ip.__decorate)([io({type:sW,repeated:"set",context:1,implicit:!0,optional:!0})],sq.prototype,"unsignedAttrs",void 0);let sG=K=class extends iu{constructor(e){super(e),Object.setPrototypeOf(this,K.prototype)}};sG=K=(0,ip.__decorate)([is({type:x.Set,itemType:sq})],sG);let sJ=class extends sq{};sJ=(0,ip.__decorate)([is({type:x.Sequence})],sJ);let sY=class extends sj{};sY=(0,ip.__decorate)([is({type:x.Choice})],sY);class sZ{constructor(e={}){this.acIssuer=new i_,this.acSerial=0,this.attrs=[],Object.assign(this,e)}}(0,ip.__decorate)([io({type:i_})],sZ.prototype,"acIssuer",void 0),(0,ip.__decorate)([io({type:S.Integer})],sZ.prototype,"acSerial",void 0),(0,ip.__decorate)([io({type:sb,repeated:"sequence"})],sZ.prototype,"attrs",void 0);let sX=W=class extends iu{constructor(e){super(e),Object.setPrototypeOf(this,W.prototype)}};sX=W=(0,ip.__decorate)([is({type:x.Sequence,itemType:S.ObjectIdentifier})],sX);class sQ{constructor(e={}){this.permitUnSpecified=!0,Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.Integer,optional:!0})],sQ.prototype,"pathLenConstraint",void 0),(0,ip.__decorate)([io({type:sX,implicit:!0,context:0,optional:!0})],sQ.prototype,"permittedAttrs",void 0),(0,ip.__decorate)([io({type:sX,implicit:!0,context:1,optional:!0})],sQ.prototype,"excludedAttrs",void 0),(0,ip.__decorate)([io({type:S.Boolean,defaultValue:!0})],sQ.prototype,"permitUnSpecified",void 0);class s0{constructor(e={}){this.issuer=new iM,this.serial=new ArrayBuffer(0),this.issuerUID=new ArrayBuffer(0),Object.assign(this,e)}}(0,ip.__decorate)([io({type:iM})],s0.prototype,"issuer",void 0),(0,ip.__decorate)([io({type:S.Integer,converter:rz})],s0.prototype,"serial",void 0),(0,ip.__decorate)([io({type:S.BitString,optional:!0})],s0.prototype,"issuerUID",void 0),(c=q||(q={}))[c.publicKey=0]="publicKey",c[c.publicKeyCert=1]="publicKeyCert",c[c.otherObjectTypes=2]="otherObjectTypes";class s1{constructor(e={}){this.digestedObjectType=q.publicKey,this.digestAlgorithm=new sB,this.objectDigest=new ArrayBuffer(0),Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.Enumerated})],s1.prototype,"digestedObjectType",void 0),(0,ip.__decorate)([io({type:S.ObjectIdentifier,optional:!0})],s1.prototype,"otherObjectTypeID",void 0),(0,ip.__decorate)([io({type:sB})],s1.prototype,"digestAlgorithm",void 0),(0,ip.__decorate)([io({type:S.BitString})],s1.prototype,"objectDigest",void 0);class s2{constructor(e={}){Object.assign(this,e)}}(0,ip.__decorate)([io({type:iM,optional:!0})],s2.prototype,"issuerName",void 0),(0,ip.__decorate)([io({type:s0,context:0,implicit:!0,optional:!0})],s2.prototype,"baseCertificateID",void 0),(0,ip.__decorate)([io({type:s1,context:1,implicit:!0,optional:!0})],s2.prototype,"objectDigestInfo",void 0);let s8=class{constructor(e={}){Object.assign(this,e)}};(0,ip.__decorate)([io({type:i_,repeated:"sequence"})],s8.prototype,"v1Form",void 0),(0,ip.__decorate)([io({type:s2,context:0,implicit:!0})],s8.prototype,"v2Form",void 0),s8=(0,ip.__decorate)([is({type:x.Choice})],s8);class s4{constructor(e={}){this.notBeforeTime=new Date,this.notAfterTime=new Date,Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.GeneralizedTime})],s4.prototype,"notBeforeTime",void 0),(0,ip.__decorate)([io({type:S.GeneralizedTime})],s4.prototype,"notAfterTime",void 0);class s5{constructor(e={}){Object.assign(this,e)}}(0,ip.__decorate)([io({type:s0,implicit:!0,context:0,optional:!0})],s5.prototype,"baseCertificateID",void 0),(0,ip.__decorate)([io({type:iM,implicit:!0,context:1,optional:!0})],s5.prototype,"entityName",void 0),(0,ip.__decorate)([io({type:s1,implicit:!0,context:2,optional:!0})],s5.prototype,"objectDigestInfo",void 0),(u=G||(G={}))[u.v2=1]="v2";class s3{constructor(e={}){this.version=G.v2,this.holder=new s5,this.issuer=new s8,this.signature=new sB,this.serialNumber=new ArrayBuffer(0),this.attrCertValidityPeriod=new s4,this.attributes=[],Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.Integer})],s3.prototype,"version",void 0),(0,ip.__decorate)([io({type:s5})],s3.prototype,"holder",void 0),(0,ip.__decorate)([io({type:s8})],s3.prototype,"issuer",void 0),(0,ip.__decorate)([io({type:sB})],s3.prototype,"signature",void 0),(0,ip.__decorate)([io({type:S.Integer,converter:rz})],s3.prototype,"serialNumber",void 0),(0,ip.__decorate)([io({type:s4})],s3.prototype,"attrCertValidityPeriod",void 0),(0,ip.__decorate)([io({type:sb,repeated:"sequence"})],s3.prototype,"attributes",void 0),(0,ip.__decorate)([io({type:S.BitString,optional:!0})],s3.prototype,"issuerUniqueID",void 0),(0,ip.__decorate)([io({type:sI,optional:!0})],s3.prototype,"extensions",void 0);class s6{constructor(e={}){this.acinfo=new s3,this.signatureAlgorithm=new sB,this.signatureValue=new ArrayBuffer(0),Object.assign(this,e)}}(0,ip.__decorate)([io({type:s3})],s6.prototype,"acinfo",void 0),(0,ip.__decorate)([io({type:sB})],s6.prototype,"signatureAlgorithm",void 0),(0,ip.__decorate)([io({type:S.BitString})],s6.prototype,"signatureValue",void 0),(h=J||(J={}))[h.unmarked=1]="unmarked",h[h.unclassified=2]="unclassified",h[h.restricted=4]="restricted",h[h.confidential=8]="confidential",h[h.secret=16]="secret",h[h.topSecret=32]="topSecret";class s9 extends rR{}class s7{constructor(e={}){this.type="",this.value=new ArrayBuffer(0),Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.ObjectIdentifier,implicit:!0,context:0})],s7.prototype,"type",void 0),(0,ip.__decorate)([io({type:S.Any,implicit:!0,context:1})],s7.prototype,"value",void 0);class ne{constructor(e={}){this.policyId="",this.classList=new s9(J.unclassified),Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.ObjectIdentifier})],ne.prototype,"policyId",void 0),(0,ip.__decorate)([io({type:s9,defaultValue:new s9(J.unclassified)})],ne.prototype,"classList",void 0),(0,ip.__decorate)([io({type:s7,repeated:"set"})],ne.prototype,"securityCategories",void 0);class nt{constructor(e={}){Object.assign(this,e)}}(0,ip.__decorate)([io({type:rL})],nt.prototype,"cotets",void 0),(0,ip.__decorate)([io({type:S.ObjectIdentifier})],nt.prototype,"oid",void 0),(0,ip.__decorate)([io({type:S.Utf8String})],nt.prototype,"string",void 0);class nr{constructor(e={}){this.values=[],Object.assign(this,e)}}(0,ip.__decorate)([io({type:iM,implicit:!0,context:0,optional:!0})],nr.prototype,"policyAuthority",void 0),(0,ip.__decorate)([io({type:nt,repeated:"sequence"})],nr.prototype,"values",void 0);class ni{constructor(e={}){this.targetCertificate=new s0,Object.assign(this,e)}}(0,ip.__decorate)([io({type:s0})],ni.prototype,"targetCertificate",void 0),(0,ip.__decorate)([io({type:i_,optional:!0})],ni.prototype,"targetName",void 0),(0,ip.__decorate)([io({type:s1,optional:!0})],ni.prototype,"certDigestInfo",void 0);let ns=class{constructor(e={}){Object.assign(this,e)}};(0,ip.__decorate)([io({type:i_,context:0,implicit:!0})],ns.prototype,"targetName",void 0),(0,ip.__decorate)([io({type:i_,context:1,implicit:!0})],ns.prototype,"targetGroup",void 0),(0,ip.__decorate)([io({type:ni,context:2,implicit:!0})],ns.prototype,"targetCert",void 0),ns=(0,ip.__decorate)([is({type:x.Choice})],ns);let nn=Y=class extends iu{constructor(e){super(e),Object.setPrototypeOf(this,Y.prototype)}};nn=Y=(0,ip.__decorate)([is({type:x.Sequence,itemType:ns})],nn);let no=Z=class extends iu{constructor(e){super(e),Object.setPrototypeOf(this,Z.prototype)}};no=Z=(0,ip.__decorate)([is({type:x.Sequence,itemType:nn})],no);class na{constructor(e={}){Object.assign(this,e)}}(0,ip.__decorate)([io({type:iM,implicit:!0,context:0,optional:!0})],na.prototype,"roleAuthority",void 0),(0,ip.__decorate)([io({type:i_,implicit:!0,context:1})],na.prototype,"roleName",void 0);class nl{constructor(e={}){this.service=new i_,this.ident=new i_,Object.assign(this,e)}}(0,ip.__decorate)([io({type:i_})],nl.prototype,"service",void 0),(0,ip.__decorate)([io({type:i_})],nl.prototype,"ident",void 0),(0,ip.__decorate)([io({type:rL,optional:!0})],nl.prototype,"authInfo",void 0);class nc{constructor(e={}){this.otherCertFormat="",this.otherCert=new ArrayBuffer(0),Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.ObjectIdentifier})],nc.prototype,"otherCertFormat",void 0),(0,ip.__decorate)([io({type:S.Any})],nc.prototype,"otherCert",void 0);let nu=class{constructor(e={}){Object.assign(this,e)}};(0,ip.__decorate)([io({type:sP})],nu.prototype,"certificate",void 0),(0,ip.__decorate)([io({type:s6,context:2,implicit:!0})],nu.prototype,"v2AttrCert",void 0),(0,ip.__decorate)([io({type:nc,context:3,implicit:!0})],nu.prototype,"other",void 0),nu=(0,ip.__decorate)([is({type:x.Choice})],nu);let nh=X=class extends iu{constructor(e){super(e),Object.setPrototypeOf(this,X.prototype)}};nh=X=(0,ip.__decorate)([is({type:x.Set,itemType:nu})],nh);class np{constructor(e={}){this.contentType="",this.content=new ArrayBuffer(0),Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.ObjectIdentifier})],np.prototype,"contentType",void 0),(0,ip.__decorate)([io({type:S.Any,context:0})],np.prototype,"content",void 0);let nd=class{constructor(e={}){Object.assign(this,e)}};(0,ip.__decorate)([io({type:rL})],nd.prototype,"single",void 0),(0,ip.__decorate)([io({type:S.Any})],nd.prototype,"any",void 0),nd=(0,ip.__decorate)([is({type:x.Choice})],nd);class nf{constructor(e={}){this.eContentType="",Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.ObjectIdentifier})],nf.prototype,"eContentType",void 0),(0,ip.__decorate)([io({type:nd,context:0,optional:!0})],nf.prototype,"eContent",void 0);let ny=class{constructor(e={}){Object.assign(this,e)}};(0,ip.__decorate)([io({type:rL,context:0,implicit:!0,optional:!0})],ny.prototype,"value",void 0),(0,ip.__decorate)([io({type:rL,converter:{fromASN:e=>new rL(e.getValue()),toASN:e=>e.toASN()},context:0,implicit:!0,optional:!0,repeated:"sequence"})],ny.prototype,"constructedValue",void 0),ny=(0,ip.__decorate)([is({type:x.Choice})],ny);class ng{constructor(e={}){this.contentType="",this.contentEncryptionAlgorithm=new sz,Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.ObjectIdentifier})],ng.prototype,"contentType",void 0),(0,ip.__decorate)([io({type:sz})],ng.prototype,"contentEncryptionAlgorithm",void 0),(0,ip.__decorate)([io({type:ny,optional:!0})],ng.prototype,"encryptedContent",void 0);class nm{constructor(e={}){this.keyAttrId="",Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.ObjectIdentifier})],nm.prototype,"keyAttrId",void 0),(0,ip.__decorate)([io({type:S.Any,optional:!0})],nm.prototype,"keyAttr",void 0);class nv{constructor(e={}){this.subjectKeyIdentifier=new sw,Object.assign(this,e)}}(0,ip.__decorate)([io({type:sw})],nv.prototype,"subjectKeyIdentifier",void 0),(0,ip.__decorate)([io({type:S.GeneralizedTime,optional:!0})],nv.prototype,"date",void 0),(0,ip.__decorate)([io({type:nm,optional:!0})],nv.prototype,"other",void 0);let nb=class{constructor(e={}){Object.assign(this,e)}};(0,ip.__decorate)([io({type:nv,context:0,implicit:!0,optional:!0})],nb.prototype,"rKeyId",void 0),(0,ip.__decorate)([io({type:sR,optional:!0})],nb.prototype,"issuerAndSerialNumber",void 0),nb=(0,ip.__decorate)([is({type:x.Choice})],nb);class nx{constructor(e={}){this.rid=new nb,this.encryptedKey=new rL,Object.assign(this,e)}}(0,ip.__decorate)([io({type:nb})],nx.prototype,"rid",void 0),(0,ip.__decorate)([io({type:rL})],nx.prototype,"encryptedKey",void 0);let nS=Q=class extends iu{constructor(e){super(e),Object.setPrototypeOf(this,Q.prototype)}};nS=Q=(0,ip.__decorate)([is({type:x.Sequence,itemType:nx})],nS);class nw{constructor(e={}){this.algorithm=new sB,this.publicKey=new ArrayBuffer(0),Object.assign(this,e)}}(0,ip.__decorate)([io({type:sB})],nw.prototype,"algorithm",void 0),(0,ip.__decorate)([io({type:S.BitString})],nw.prototype,"publicKey",void 0);let n_=class{constructor(e={}){Object.assign(this,e)}};(0,ip.__decorate)([io({type:sw,context:0,implicit:!0,optional:!0})],n_.prototype,"subjectKeyIdentifier",void 0),(0,ip.__decorate)([io({type:nw,context:1,implicit:!0,optional:!0})],n_.prototype,"originatorKey",void 0),(0,ip.__decorate)([io({type:sR,optional:!0})],n_.prototype,"issuerAndSerialNumber",void 0),n_=(0,ip.__decorate)([is({type:x.Choice})],n_);class nA{constructor(e={}){this.version=$.v3,this.originator=new n_,this.keyEncryptionAlgorithm=new sF,this.recipientEncryptedKeys=new nS,Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.Integer})],nA.prototype,"version",void 0),(0,ip.__decorate)([io({type:n_,context:0})],nA.prototype,"originator",void 0),(0,ip.__decorate)([io({type:rL,context:1,optional:!0})],nA.prototype,"ukm",void 0),(0,ip.__decorate)([io({type:sF})],nA.prototype,"keyEncryptionAlgorithm",void 0),(0,ip.__decorate)([io({type:nS})],nA.prototype,"recipientEncryptedKeys",void 0);let nk=class{constructor(e={}){Object.assign(this,e)}};(0,ip.__decorate)([io({type:sw,context:0,implicit:!0})],nk.prototype,"subjectKeyIdentifier",void 0),(0,ip.__decorate)([io({type:sR})],nk.prototype,"issuerAndSerialNumber",void 0),nk=(0,ip.__decorate)([is({type:x.Choice})],nk);class nC{constructor(e={}){this.version=$.v0,this.rid=new nk,this.keyEncryptionAlgorithm=new sF,this.encryptedKey=new rL,Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.Integer})],nC.prototype,"version",void 0),(0,ip.__decorate)([io({type:nk})],nC.prototype,"rid",void 0),(0,ip.__decorate)([io({type:sF})],nC.prototype,"keyEncryptionAlgorithm",void 0),(0,ip.__decorate)([io({type:rL})],nC.prototype,"encryptedKey",void 0);class nB{constructor(e={}){this.keyIdentifier=new rL,Object.assign(this,e)}}(0,ip.__decorate)([io({type:rL})],nB.prototype,"keyIdentifier",void 0),(0,ip.__decorate)([io({type:S.GeneralizedTime,optional:!0})],nB.prototype,"date",void 0),(0,ip.__decorate)([io({type:nm,optional:!0})],nB.prototype,"other",void 0);class nN{constructor(e={}){this.version=$.v4,this.kekid=new nB,this.keyEncryptionAlgorithm=new sF,this.encryptedKey=new rL,Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.Integer})],nN.prototype,"version",void 0),(0,ip.__decorate)([io({type:nB})],nN.prototype,"kekid",void 0),(0,ip.__decorate)([io({type:sF})],nN.prototype,"keyEncryptionAlgorithm",void 0),(0,ip.__decorate)([io({type:rL})],nN.prototype,"encryptedKey",void 0);class nj{constructor(e={}){this.version=$.v0,this.keyEncryptionAlgorithm=new sF,this.encryptedKey=new rL,Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.Integer})],nj.prototype,"version",void 0),(0,ip.__decorate)([io({type:sK,context:0,optional:!0})],nj.prototype,"keyDerivationAlgorithm",void 0),(0,ip.__decorate)([io({type:sF})],nj.prototype,"keyEncryptionAlgorithm",void 0),(0,ip.__decorate)([io({type:rL})],nj.prototype,"encryptedKey",void 0);class nE{constructor(e={}){this.oriType="",this.oriValue=new ArrayBuffer(0),Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.ObjectIdentifier})],nE.prototype,"oriType",void 0),(0,ip.__decorate)([io({type:S.Any})],nE.prototype,"oriValue",void 0);let nO=class{constructor(e={}){Object.assign(this,e)}};(0,ip.__decorate)([io({type:nC,optional:!0})],nO.prototype,"ktri",void 0),(0,ip.__decorate)([io({type:nA,context:1,implicit:!0,optional:!0})],nO.prototype,"kari",void 0),(0,ip.__decorate)([io({type:nN,context:2,implicit:!0,optional:!0})],nO.prototype,"kekri",void 0),(0,ip.__decorate)([io({type:nj,context:3,implicit:!0,optional:!0})],nO.prototype,"pwri",void 0),(0,ip.__decorate)([io({type:nE,context:4,implicit:!0,optional:!0})],nO.prototype,"ori",void 0),nO=(0,ip.__decorate)([is({type:x.Choice})],nO);let nI=ee=class extends iu{constructor(e){super(e),Object.setPrototypeOf(this,ee.prototype)}};nI=ee=(0,ip.__decorate)([is({type:x.Set,itemType:nO})],nI);class nT{constructor(e={}){this.otherRevInfoFormat="",this.otherRevInfo=new ArrayBuffer(0),Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.ObjectIdentifier})],nT.prototype,"otherRevInfoFormat",void 0),(0,ip.__decorate)([io({type:S.Any})],nT.prototype,"otherRevInfo",void 0);let nP=class{constructor(e={}){this.other=new nT,Object.assign(this,e)}};(0,ip.__decorate)([io({type:nT,context:1,implicit:!0})],nP.prototype,"other",void 0),nP=(0,ip.__decorate)([is({type:x.Choice})],nP);let nU=et=class extends iu{constructor(e){super(e),Object.setPrototypeOf(this,et.prototype)}};nU=et=(0,ip.__decorate)([is({type:x.Set,itemType:nP})],nU);class nD{constructor(e={}){Object.assign(this,e)}}(0,ip.__decorate)([io({type:nh,context:0,implicit:!0,optional:!0})],nD.prototype,"certs",void 0),(0,ip.__decorate)([io({type:nU,context:1,implicit:!0,optional:!0})],nD.prototype,"crls",void 0);let nV=er=class extends iu{constructor(e){super(e),Object.setPrototypeOf(this,er.prototype)}};nV=er=(0,ip.__decorate)([is({type:x.Set,itemType:sW})],nV);class nR{constructor(e={}){this.version=$.v0,this.recipientInfos=new nI,this.encryptedContentInfo=new ng,Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.Integer})],nR.prototype,"version",void 0),(0,ip.__decorate)([io({type:nD,context:0,implicit:!0,optional:!0})],nR.prototype,"originatorInfo",void 0),(0,ip.__decorate)([io({type:nI})],nR.prototype,"recipientInfos",void 0),(0,ip.__decorate)([io({type:ng})],nR.prototype,"encryptedContentInfo",void 0),(0,ip.__decorate)([io({type:nV,context:1,implicit:!0,optional:!0})],nR.prototype,"unprotectedAttrs",void 0);let nL=ei=class extends iu{constructor(e){super(e),Object.setPrototypeOf(this,ei.prototype)}};nL=ei=(0,ip.__decorate)([is({type:x.Set,itemType:sH})],nL);class nH{constructor(e={}){this.version=$.v0,this.digestAlgorithms=new nL,this.encapContentInfo=new nf,this.signerInfos=new sG,Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.Integer})],nH.prototype,"version",void 0),(0,ip.__decorate)([io({type:nL})],nH.prototype,"digestAlgorithms",void 0),(0,ip.__decorate)([io({type:nf})],nH.prototype,"encapContentInfo",void 0),(0,ip.__decorate)([io({type:nh,context:0,implicit:!0,optional:!0})],nH.prototype,"certificates",void 0),(0,ip.__decorate)([io({type:nU,context:1,implicit:!0,optional:!0})],nH.prototype,"crls",void 0),(0,ip.__decorate)([io({type:sG})],nH.prototype,"signerInfos",void 0);let nM="1.2.840.10045.2.1",nF="1.2.840.10045.4.1",nz="1.2.840.10045.4.3.1",n$="1.2.840.10045.4.3.2",nK="1.2.840.10045.4.3.3",nW="1.2.840.10045.4.3.4",nq="1.2.840.10045.3.1.7",nG="1.3.132.0.34",nJ="1.3.132.0.35";function nY(e){return new sB({algorithm:e})}let nZ=nY(nF);nY(nz);let nX=nY(n$),nQ=nY(nK),n0=nY(nW),n1=class{constructor(e={}){Object.assign(this,e)}};(0,ip.__decorate)([io({type:S.ObjectIdentifier})],n1.prototype,"fieldType",void 0),(0,ip.__decorate)([io({type:S.Any})],n1.prototype,"parameters",void 0),n1=(0,ip.__decorate)([is({type:x.Sequence})],n1);let n2=class{constructor(e={}){Object.assign(this,e)}};(0,ip.__decorate)([io({type:S.OctetString})],n2.prototype,"a",void 0),(0,ip.__decorate)([io({type:S.OctetString})],n2.prototype,"b",void 0),(0,ip.__decorate)([io({type:S.BitString,optional:!0})],n2.prototype,"seed",void 0),n2=(0,ip.__decorate)([is({type:x.Sequence})],n2),(p=es||(es={}))[p.ecpVer1=1]="ecpVer1";let n8=class{constructor(e={}){this.version=es.ecpVer1,Object.assign(this,e)}};(0,ip.__decorate)([io({type:S.Integer})],n8.prototype,"version",void 0),(0,ip.__decorate)([io({type:n1})],n8.prototype,"fieldID",void 0),(0,ip.__decorate)([io({type:n2})],n8.prototype,"curve",void 0),(0,ip.__decorate)([io({type:class extends rL{}})],n8.prototype,"base",void 0),(0,ip.__decorate)([io({type:S.Integer,converter:rz})],n8.prototype,"order",void 0),(0,ip.__decorate)([io({type:S.Integer,optional:!0})],n8.prototype,"cofactor",void 0),n8=(0,ip.__decorate)([is({type:x.Sequence})],n8);let n4=class{constructor(e={}){Object.assign(this,e)}};(0,ip.__decorate)([io({type:S.ObjectIdentifier})],n4.prototype,"namedCurve",void 0),(0,ip.__decorate)([io({type:S.Null})],n4.prototype,"implicitCurve",void 0),(0,ip.__decorate)([io({type:n8})],n4.prototype,"specifiedCurve",void 0),n4=(0,ip.__decorate)([is({type:x.Choice})],n4);class n5{constructor(e={}){this.version=1,this.privateKey=new rL,Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.Integer})],n5.prototype,"version",void 0),(0,ip.__decorate)([io({type:rL})],n5.prototype,"privateKey",void 0),(0,ip.__decorate)([io({type:n4,context:0,optional:!0})],n5.prototype,"parameters",void 0),(0,ip.__decorate)([io({type:S.BitString,context:1,optional:!0})],n5.prototype,"publicKey",void 0);class n3{constructor(e={}){this.r=new ArrayBuffer(0),this.s=new ArrayBuffer(0),Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.Integer,converter:rz})],n3.prototype,"r",void 0),(0,ip.__decorate)([io({type:S.Integer,converter:rz})],n3.prototype,"s",void 0);let n6="1.2.840.113549.1.1",n9=`${n6}.1`,n7=`${n6}.7`,oe=`${n6}.9`,ot=`${n6}.10`,or=`${n6}.2`,oi=`${n6}.4`,os=`${n6}.5`,on=`${n6}.14`,oo=`${n6}.11`,oa=`${n6}.12`,ol=`${n6}.13`,oc=`${n6}.15`,ou=`${n6}.16`,oh="1.3.14.3.2.26",op="2.16.840.1.101.3.4.2.4",od="2.16.840.1.101.3.4.2.1",of="2.16.840.1.101.3.4.2.2",oy="2.16.840.1.101.3.4.2.3",og=`${n6}.8`;function om(e){return new sB({algorithm:e,parameters:null})}om("1.2.840.113549.2.2"),om("1.2.840.113549.2.5");let ov=om(oh);om(op),om(od),om(of),om(oy),om("2.16.840.1.101.3.4.2.5"),om("2.16.840.1.101.3.4.2.6");let ob=new sB({algorithm:og,parameters:ih.serialize(ov)}),ox=new sB({algorithm:oe,parameters:ih.serialize(rq.toASN(new Uint8Array([218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9]).buffer))});om(n9),om(or),om(oi),om(os),om(oc),om(ou),om(oa),om(ol),om(oc),om(ou);class oS{constructor(e={}){this.hashAlgorithm=new sB(ov),this.maskGenAlgorithm=new sB({algorithm:og,parameters:ih.serialize(ov)}),this.pSourceAlgorithm=new sB(ox),Object.assign(this,e)}}(0,ip.__decorate)([io({type:sB,context:0,defaultValue:ov})],oS.prototype,"hashAlgorithm",void 0),(0,ip.__decorate)([io({type:sB,context:1,defaultValue:ob})],oS.prototype,"maskGenAlgorithm",void 0),(0,ip.__decorate)([io({type:sB,context:2,defaultValue:ox})],oS.prototype,"pSourceAlgorithm",void 0),new sB({algorithm:n7,parameters:ih.serialize(new oS)});class ow{constructor(e={}){this.hashAlgorithm=new sB(ov),this.maskGenAlgorithm=new sB({algorithm:og,parameters:ih.serialize(ov)}),this.saltLength=20,this.trailerField=1,Object.assign(this,e)}}(0,ip.__decorate)([io({type:sB,context:0,defaultValue:ov})],ow.prototype,"hashAlgorithm",void 0),(0,ip.__decorate)([io({type:sB,context:1,defaultValue:ob})],ow.prototype,"maskGenAlgorithm",void 0),(0,ip.__decorate)([io({type:S.Integer,context:2,defaultValue:20})],ow.prototype,"saltLength",void 0),(0,ip.__decorate)([io({type:S.Integer,context:3,defaultValue:1})],ow.prototype,"trailerField",void 0),new sB({algorithm:ot,parameters:ih.serialize(new ow)});class o_{constructor(e={}){this.digestAlgorithm=new sB,this.digest=new rL,Object.assign(this,e)}}(0,ip.__decorate)([io({type:sB})],o_.prototype,"digestAlgorithm",void 0),(0,ip.__decorate)([io({type:rL})],o_.prototype,"digest",void 0);class oA{constructor(e={}){this.prime=new ArrayBuffer(0),this.exponent=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.Integer,converter:rz})],oA.prototype,"prime",void 0),(0,ip.__decorate)([io({type:S.Integer,converter:rz})],oA.prototype,"exponent",void 0),(0,ip.__decorate)([io({type:S.Integer,converter:rz})],oA.prototype,"coefficient",void 0);let ok=en=class extends iu{constructor(e){super(e),Object.setPrototypeOf(this,en.prototype)}};ok=en=(0,ip.__decorate)([is({type:x.Sequence,itemType:oA})],ok);class oC{constructor(e={}){this.version=0,this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),this.privateExponent=new ArrayBuffer(0),this.prime1=new ArrayBuffer(0),this.prime2=new ArrayBuffer(0),this.exponent1=new ArrayBuffer(0),this.exponent2=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.Integer})],oC.prototype,"version",void 0),(0,ip.__decorate)([io({type:S.Integer,converter:rz})],oC.prototype,"modulus",void 0),(0,ip.__decorate)([io({type:S.Integer,converter:rz})],oC.prototype,"publicExponent",void 0),(0,ip.__decorate)([io({type:S.Integer,converter:rz})],oC.prototype,"privateExponent",void 0),(0,ip.__decorate)([io({type:S.Integer,converter:rz})],oC.prototype,"prime1",void 0),(0,ip.__decorate)([io({type:S.Integer,converter:rz})],oC.prototype,"prime2",void 0),(0,ip.__decorate)([io({type:S.Integer,converter:rz})],oC.prototype,"exponent1",void 0),(0,ip.__decorate)([io({type:S.Integer,converter:rz})],oC.prototype,"exponent2",void 0),(0,ip.__decorate)([io({type:S.Integer,converter:rz})],oC.prototype,"coefficient",void 0),(0,ip.__decorate)([io({type:ok,optional:!0})],oC.prototype,"otherPrimeInfos",void 0);class oB{constructor(e={}){this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.Integer,converter:rz})],oB.prototype,"modulus",void 0),(0,ip.__decorate)([io({type:S.Integer,converter:rz})],oB.prototype,"publicExponent",void 0),(d=eo||(eo={}))[d.Transient=0]="Transient",d[d.Singleton=1]="Singleton",d[d.ResolutionScoped=2]="ResolutionScoped",d[d.ContainerScoped=3]="ContainerScoped";let oN=eo;var oj=function(e,t){return(oj=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function oE(e,t){function r(){this.constructor=e}oj(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function oO(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function oI(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,s,n=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(e){s={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return o}function oT(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(oI(arguments[t]));return e}function oP(e){return!!e.useClass}function oU(e){return!!e.useFactory}var oD=function(){function e(e){this.wrap=e,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct","ownKeys"]}return e.prototype.createProxy=function(e){var t,r=this,i=!1;return new Proxy({},this.createHandler(function(){return i||(t=e(r.wrap()),i=!0),t}))},e.prototype.createHandler=function(e){var t={};return this.reflectMethods.forEach(function(r){t[r]=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return t[0]=e(),Reflect[r].apply(void 0,oT(t))}}),t},e}();function oV(e){return"string"==typeof e||"symbol"==typeof e}function oR(e){return"object"==typeof e&&"token"in e&&"transform"in e}function oL(e){return!!e.useToken}function oH(e){return void 0!=e.useValue}var oM=function(){function e(){this._registryMap=new Map}return e.prototype.entries=function(){return this._registryMap.entries()},e.prototype.getAll=function(e){return this.ensure(e),this._registryMap.get(e)},e.prototype.get=function(e){this.ensure(e);var t=this._registryMap.get(e);return t[t.length-1]||null},e.prototype.set=function(e,t){this.ensure(e),this._registryMap.get(e).push(t)},e.prototype.setAll=function(e,t){this._registryMap.set(e,t)},e.prototype.has=function(e){return this.ensure(e),this._registryMap.get(e).length>0},e.prototype.clear=function(){this._registryMap.clear()},e.prototype.ensure=function(e){this._registryMap.has(e)||this._registryMap.set(e,[])},e}(),oF=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return oE(t,e),t}(oM);let oz=function(){this.scopedResolutions=new Map};var o$=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return oE(t,e),t}(oM),oK=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return oE(t,e),t}(oM);let oW=function(){this.preResolution=new o$,this.postResolution=new oK};var oq=new Map,oG=new(function(){function e(e){this.parent=e,this._registry=new oF,this.interceptors=new oW,this.disposed=!1,this.disposables=new Set}return e.prototype.register=function(e,t,r){if(void 0===r&&(r={lifecycle:oN.Transient}),this.ensureNotDisposed(),i=oP(t)||oH(t)||oL(t)||oU(t)?t:{useClass:t},oL(i))for(var i,s=[e],n=i;null!=n;){var o=n.useToken;if(s.includes(o))throw Error("Token registration cycle detected! "+oT(s,[o]).join(" -> "));s.push(o);var a=this._registry.get(o);n=a&&oL(a.provider)?a.provider:null}if((r.lifecycle===oN.Singleton||r.lifecycle==oN.ContainerScoped||r.lifecycle==oN.ResolutionScoped)&&(oH(i)||oU(i)))throw Error('Cannot use lifecycle "'+oN[r.lifecycle]+'" with ValueProviders or FactoryProviders');return this._registry.set(e,{provider:i,options:r}),this},e.prototype.registerType=function(e,t){return(this.ensureNotDisposed(),oV(t))?this.register(e,{useToken:t}):this.register(e,{useClass:t})},e.prototype.registerInstance=function(e,t){return this.ensureNotDisposed(),this.register(e,{useValue:t})},e.prototype.registerSingleton=function(e,t){if(this.ensureNotDisposed(),oV(e)){if(oV(t))return this.register(e,{useToken:t},{lifecycle:oN.Singleton});if(t)return this.register(e,{useClass:t},{lifecycle:oN.Singleton});throw Error('Cannot register a type name as a singleton without a "to" token')}var r=e;return t&&!oV(t)&&(r=t),this.register(e,{useClass:r},{lifecycle:oN.Singleton})},e.prototype.resolve=function(e,t,r){void 0===t&&(t=new oz),void 0===r&&(r=!1),this.ensureNotDisposed();var i=this.getRegistration(e);if(!i&&oV(e)){if(r)return;throw Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"')}if(this.executePreResolutionInterceptor(e,"Single"),i){var s=this.resolveRegistration(i,t);return this.executePostResolutionInterceptor(e,s,"Single"),s}if("function"==typeof e||e instanceof oD){var s=this.construct(e,t);return this.executePostResolutionInterceptor(e,s,"Single"),s}throw Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")},e.prototype.executePreResolutionInterceptor=function(e,t){var r,i;if(this.interceptors.preResolution.has(e)){var s=[];try{for(var n=oO(this.interceptors.preResolution.getAll(e)),o=n.next();!o.done;o=n.next()){var a=o.value;"Once"!=a.options.frequency&&s.push(a),a.callback(e,t)}}catch(e){r={error:e}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(r)throw r.error}}this.interceptors.preResolution.setAll(e,s)}},e.prototype.executePostResolutionInterceptor=function(e,t,r){var i,s;if(this.interceptors.postResolution.has(e)){var n=[];try{for(var o=oO(this.interceptors.postResolution.getAll(e)),a=o.next();!a.done;a=o.next()){var l=a.value;"Once"!=l.options.frequency&&n.push(l),l.callback(e,t,r)}}catch(e){i={error:e}}finally{try{a&&!a.done&&(s=o.return)&&s.call(o)}finally{if(i)throw i.error}}this.interceptors.postResolution.setAll(e,n)}},e.prototype.resolveRegistration=function(e,t){if(this.ensureNotDisposed(),e.options.lifecycle===oN.ResolutionScoped&&t.scopedResolutions.has(e))return t.scopedResolutions.get(e);var r,i=e.options.lifecycle===oN.Singleton,s=e.options.lifecycle===oN.ContainerScoped,n=i||s;return r=oH(e.provider)?e.provider.useValue:oL(e.provider)?n?e.instance||(e.instance=this.resolve(e.provider.useToken,t)):this.resolve(e.provider.useToken,t):oP(e.provider)?n?e.instance||(e.instance=this.construct(e.provider.useClass,t)):this.construct(e.provider.useClass,t):oU(e.provider)?e.provider.useFactory(this):this.construct(e.provider,t),e.options.lifecycle===oN.ResolutionScoped&&t.scopedResolutions.set(e,r),r},e.prototype.resolveAll=function(e,t,r){var i=this;void 0===t&&(t=new oz),void 0===r&&(r=!1),this.ensureNotDisposed();var s=this.getAllRegistrations(e);if(!s&&oV(e)){if(r)return[];throw Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"')}if(this.executePreResolutionInterceptor(e,"All"),s){var n=s.map(function(e){return i.resolveRegistration(e,t)});return this.executePostResolutionInterceptor(e,n,"All"),n}var o=[this.construct(e,t)];return this.executePostResolutionInterceptor(e,o,"All"),o},e.prototype.isRegistered=function(e,t){return void 0===t&&(t=!1),this.ensureNotDisposed(),this._registry.has(e)||t&&(this.parent||!1)&&this.parent.isRegistered(e,!0)},e.prototype.reset=function(){this.ensureNotDisposed(),this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()},e.prototype.clearInstances=function(){var e,t;this.ensureNotDisposed();try{for(var r=oO(this._registry.entries()),i=r.next();!i.done;i=r.next()){var s=oI(i.value,2),n=s[0],o=s[1];this._registry.setAll(n,o.filter(function(e){return!oH(e.provider)}).map(function(e){return e.instance=void 0,e}))}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},e.prototype.createChildContainer=function(){this.ensureNotDisposed();var t,r,i=new e(this);try{for(var s=oO(this._registry.entries()),n=s.next();!n.done;n=s.next()){var o=oI(n.value,2),a=o[0],l=o[1];l.some(function(e){return e.options.lifecycle===oN.ContainerScoped})&&i._registry.setAll(a,l.map(function(e){return e.options.lifecycle===oN.ContainerScoped?{provider:e.provider,options:e.options}:e}))}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}return i},e.prototype.beforeResolution=function(e,t,r){void 0===r&&(r={frequency:"Always"}),this.interceptors.preResolution.set(e,{callback:t,options:r})},e.prototype.afterResolution=function(e,t,r){void 0===r&&(r={frequency:"Always"}),this.interceptors.postResolution.set(e,{callback:t,options:r})},e.prototype.dispose=function(){var e,t,r,i;return e=this,t=void 0,r=void 0,i=function(){var e;return function(e,t){var r,i,s,n,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){var l=[n,a];if(r)throw TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(s=2&l[0]?i.return:l[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,l[1])).done)return s;switch(i=0,s&&(l=[2&l[0],s.value]),l[0]){case 0:case 1:s=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,i=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!s||l[1]>s[0]&&l[1]<s[3])){o.label=l[1];break}if(6===l[0]&&o.label<s[1]){o.label=s[1],s=l;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(l);break}s[2]&&o.ops.pop(),o.trys.pop();continue}l=t.call(e,o)}catch(e){l=[6,e],i=0}finally{r=s=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}(this,function(t){switch(t.label){case 0:return this.disposed=!0,e=[],this.disposables.forEach(function(t){var r=t.dispose();r&&e.push(r)}),[4,Promise.all(e)];case 1:return t.sent(),[2]}})},new(r||(r=Promise))(function(s,n){function o(e){try{l(i.next(e))}catch(e){n(e)}}function a(e){try{l(i.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?s(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(o,a)}l((i=i.apply(e,t||[])).next())})},e.prototype.getRegistration=function(e){return this.isRegistered(e)?this._registry.get(e):this.parent?this.parent.getRegistration(e):null},e.prototype.getAllRegistrations=function(e){return this.isRegistered(e)?this._registry.getAll(e):this.parent?this.parent.getAllRegistrations(e):null},e.prototype.construct=function(e,t){var r=this;if(e instanceof oD)return e.createProxy(function(e){return r.resolve(e,t)});var i=function(){var i=oq.get(e);if(!i||0===i.length)if(0===e.length)return new e;else throw Error('TypeInfo not known for "'+e.name+'"');var s=i.map(r.resolveParams(t,e));return new(e.bind.apply(e,oT([void 0],s)))}();return"function"!=typeof i.dispose||i.dispose.length>0||this.disposables.add(i),i},e.prototype.resolveParams=function(e,t){var r=this;return function(i,s){var n,o,a,l,c,u,h;try{if("object"==typeof i&&"token"in i&&"multiple"in i)if(oR(i))return i.multiple?(n=r.resolve(i.transform)).transform.apply(n,oT([r.resolveAll(i.token,new oz,i.isOptional)],i.transformArgs)):(o=r.resolve(i.transform)).transform.apply(o,oT([r.resolve(i.token,e,i.isOptional)],i.transformArgs));else return i.multiple?r.resolveAll(i.token,new oz,i.isOptional):r.resolve(i.token,e,i.isOptional);if(oR(i))return(a=r.resolve(i.transform,e)).transform.apply(a,oT([r.resolve(i.token,e)],i.transformArgs));return r.resolve(i,e)}catch(e){throw Error((u="Cannot inject the dependency "+(c=void 0===(l=oI(t.toString().match(/constructor\(([\w, ]+)\)/)||[],2)[1])?null:l,null===c?"at position #"+s:'"'+c.split(",")[s].trim()+'" at position #'+s)+' of "'+t.name+'" constructor. Reason:',void 0===h&&(h="    "),oT([u],e.message.split("\n").map(function(e){return h+e})).join("\n")))}}},e.prototype.ensureNotDisposed=function(){if(this.disposed)throw Error("This container has been disposed, you cannot interact with a disposed container")},e}());let oJ=function(e){return function(t){var r,i;oq.set(t,(r=Reflect.getMetadata("design:paramtypes",t)||[],Object.keys(i=Reflect.getOwnMetadata("injectionTokens",t)||{}).forEach(function(e){r[+e]=i[e]}),r)),e&&e.token&&(Array.isArray(e.token)?e.token.forEach(function(e){oG.register(e,t)}):oG.register(e.token,t))}};if(e.s([],68370),"undefined"==typeof Reflect||!Reflect.getMetadata)throw Error("tsyringe requires a reflect polyfill. Please add 'import \"reflect-metadata\"' to the top of your entry point.");e.i(68370);class oY{constructor(e={}){this.attrId="",this.attrValues=[],Object.assign(e)}}(0,ip.__decorate)([io({type:S.ObjectIdentifier})],oY.prototype,"attrId",void 0),(0,ip.__decorate)([io({type:S.Any,repeated:"set"})],oY.prototype,"attrValues",void 0);let oZ=ea=class extends iu{constructor(e){super(e),Object.setPrototypeOf(this,ea.prototype)}};oZ=ea=(0,ip.__decorate)([is({type:x.Sequence,itemType:oY})],oZ);let oX=el=class extends iu{constructor(e){super(e),Object.setPrototypeOf(this,el.prototype)}};oX=el=(0,ip.__decorate)([is({type:x.Sequence,itemType:np})],oX);class oQ{constructor(e={}){this.certId="",this.certValue=new ArrayBuffer(0),Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.ObjectIdentifier})],oQ.prototype,"certId",void 0),(0,ip.__decorate)([io({type:S.Any,context:0})],oQ.prototype,"certValue",void 0);class o0{constructor(e={}){this.crlId="",this.crltValue=new ArrayBuffer(0),Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.ObjectIdentifier})],o0.prototype,"crlId",void 0),(0,ip.__decorate)([io({type:S.Any,context:0})],o0.prototype,"crltValue",void 0);class o1 extends rL{}class o2{constructor(e={}){this.encryptionAlgorithm=new sB,this.encryptedData=new o1,Object.assign(this,e)}}(0,ip.__decorate)([io({type:sB})],o2.prototype,"encryptionAlgorithm",void 0),(0,ip.__decorate)([io({type:o1})],o2.prototype,"encryptedData",void 0),(f=eu||(eu={}))[f.v1=0]="v1";class o8 extends rL{}let o4=ec=class extends iu{constructor(e){super(e),Object.setPrototypeOf(this,ec.prototype)}};o4=ec=(0,ip.__decorate)([is({type:x.Sequence,itemType:sb})],o4);class o5{constructor(e={}){this.version=eu.v1,this.privateKeyAlgorithm=new sB,this.privateKey=new o8,Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.Integer})],o5.prototype,"version",void 0),(0,ip.__decorate)([io({type:sB})],o5.prototype,"privateKeyAlgorithm",void 0),(0,ip.__decorate)([io({type:o8})],o5.prototype,"privateKey",void 0),(0,ip.__decorate)([io({type:o4,implicit:!0,context:0,optional:!0})],o5.prototype,"attributes",void 0);let o3=class extends o5{};o3=(0,ip.__decorate)([is({type:x.Sequence})],o3);let o6=class extends o2{};o6=(0,ip.__decorate)([is({type:x.Sequence})],o6);class o9{constructor(e={}){this.secretTypeId="",this.secretValue=new ArrayBuffer(0),Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.ObjectIdentifier})],o9.prototype,"secretTypeId",void 0),(0,ip.__decorate)([io({type:S.Any,context:0})],o9.prototype,"secretValue",void 0);class o7{constructor(e={}){this.mac=new o_,this.macSalt=new rL,this.iterations=1,Object.assign(this,e)}}(0,ip.__decorate)([io({type:o_})],o7.prototype,"mac",void 0),(0,ip.__decorate)([io({type:rL})],o7.prototype,"macSalt",void 0),(0,ip.__decorate)([io({type:S.Integer,defaultValue:1})],o7.prototype,"iterations",void 0);class ae{constructor(e={}){this.version=3,this.authSafe=new np,this.macData=new o7,Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.Integer})],ae.prototype,"version",void 0),(0,ip.__decorate)([io({type:np})],ae.prototype,"authSafe",void 0),(0,ip.__decorate)([io({type:o7,optional:!0})],ae.prototype,"macData",void 0);class at{constructor(e={}){this.bagId="",this.bagValue=new ArrayBuffer(0),Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.ObjectIdentifier})],at.prototype,"bagId",void 0),(0,ip.__decorate)([io({type:S.Any,context:0})],at.prototype,"bagValue",void 0),(0,ip.__decorate)([io({type:oY,repeated:"set",optional:!0})],at.prototype,"bagAttributes",void 0);let ar=eh=class extends iu{constructor(e){super(e),Object.setPrototypeOf(this,eh.prototype)}};ar=eh=(0,ip.__decorate)([is({type:x.Sequence,itemType:at})],ar);let ai="1.2.840.113549.1.9",as=`${ai}.7`,an=`${ai}.14`,ao=class extends iy{constructor(e={}){super(e)}toString(){return({}).toString(),this.ia5String||super.toString()}};(0,ip.__decorate)([io({type:S.IA5String})],ao.prototype,"ia5String",void 0),ao=(0,ip.__decorate)([is({type:x.Choice})],ao);let aa=class extends np{};aa=(0,ip.__decorate)([is({type:x.Sequence})],aa);let al=class extends ae{};al=(0,ip.__decorate)([is({type:x.Sequence})],al);let ac=class extends o2{};ac=(0,ip.__decorate)([is({type:x.Sequence})],ac);let au=class{constructor(e=""){this.value=e}toString(){return this.value}};(0,ip.__decorate)([io({type:S.IA5String})],au.prototype,"value",void 0),au=(0,ip.__decorate)([is({type:x.Choice})],au);let ah=class extends ao{};ah=(0,ip.__decorate)([is({type:x.Choice})],ah);let ap=class extends iy{};ap=(0,ip.__decorate)([is({type:x.Choice})],ap);let ad=class{constructor(e=new Date){this.value=e}};(0,ip.__decorate)([io({type:S.GeneralizedTime})],ad.prototype,"value",void 0),ad=(0,ip.__decorate)([is({type:x.Choice})],ad);let af=class extends iy{};af=(0,ip.__decorate)([is({type:x.Choice})],af);let ay=class{constructor(e="M"){this.value=e}toString(){return this.value}};(0,ip.__decorate)([io({type:S.PrintableString})],ay.prototype,"value",void 0),ay=(0,ip.__decorate)([is({type:x.Choice})],ay);let ag=class{constructor(e=""){this.value=e}toString(){return this.value}};(0,ip.__decorate)([io({type:S.PrintableString})],ag.prototype,"value",void 0),ag=(0,ip.__decorate)([is({type:x.Choice})],ag);let am=class extends ag{};am=(0,ip.__decorate)([is({type:x.Choice})],am);let av=class extends iy{};av=(0,ip.__decorate)([is({type:x.Choice})],av);let ab=class{constructor(e=""){this.value=e}toString(){return this.value}};(0,ip.__decorate)([io({type:S.ObjectIdentifier})],ab.prototype,"value",void 0),ab=(0,ip.__decorate)([is({type:x.Choice})],ab);let ax=class extends sj{};ax=(0,ip.__decorate)([is({type:x.Choice})],ax);let aS=class{constructor(e=0){this.value=e}toString(){return this.value.toString()}};(0,ip.__decorate)([io({type:S.Integer})],aS.prototype,"value",void 0),aS=(0,ip.__decorate)([is({type:x.Choice})],aS);let aw=class extends sq{};aw=(0,ip.__decorate)([is({type:x.Sequence})],aw);let a_=class extends iy{};a_=(0,ip.__decorate)([is({type:x.Choice})],a_);let aA=ep=class extends sI{constructor(e){super(e),Object.setPrototypeOf(this,ep.prototype)}};aA=ep=(0,ip.__decorate)([is({type:x.Sequence})],aA);let ak=ed=class extends iu{constructor(e){super(e),Object.setPrototypeOf(this,ed.prototype)}};ak=ed=(0,ip.__decorate)([is({type:x.Set,itemType:sW})],ak);let aC=class{constructor(e=""){this.value=e}toString(){return this.value}};(0,ip.__decorate)([io({type:S.BmpString})],aC.prototype,"value",void 0),aC=(0,ip.__decorate)([is({type:x.Choice})],aC);let aB=class extends sB{};aB=(0,ip.__decorate)([is({type:x.Sequence})],aB);let aN=ef=class extends iu{constructor(e){super(e),Object.setPrototypeOf(this,ef.prototype)}};aN=ef=(0,ip.__decorate)([is({type:x.Sequence,itemType:aB})],aN);let aj=ey=class extends iu{constructor(e){super(e),Object.setPrototypeOf(this,ey.prototype)}};aj=ey=(0,ip.__decorate)([is({type:x.Sequence,itemType:sb})],aj);class aE{constructor(e={}){this.version=0,this.subject=new ix,this.subjectPKInfo=new sN,this.attributes=new aj,Object.assign(this,e)}}(0,ip.__decorate)([io({type:S.Integer})],aE.prototype,"version",void 0),(0,ip.__decorate)([io({type:ix})],aE.prototype,"subject",void 0),(0,ip.__decorate)([io({type:sN})],aE.prototype,"subjectPKInfo",void 0),(0,ip.__decorate)([io({type:aj,implicit:!0,context:0,optional:!0})],aE.prototype,"attributes",void 0);class aO{constructor(e={}){this.certificationRequestInfo=new aE,this.signatureAlgorithm=new sB,this.signature=new ArrayBuffer(0),Object.assign(this,e)}}(0,ip.__decorate)([io({type:aE,raw:!0})],aO.prototype,"certificationRequestInfo",void 0),(0,ip.__decorate)([io({type:sB})],aO.prototype,"signatureAlgorithm",void 0),(0,ip.__decorate)([io({type:S.BitString})],aO.prototype,"signature",void 0);let aI="crypto.algorithm",aT="crypto.algorithmProvider";oG.registerSingleton(aT,class{getAlgorithms(){return oG.resolveAll(aI)}toAsnAlgorithm(e){for(let t of({...e},this.getAlgorithms())){let r=t.toAsnAlgorithm(e);if(r)return r}if(/^[0-9.]+$/.test(e.name)){let t=new sB({algorithm:e.name});return"parameters"in e&&(t.parameters=e.parameters),t}throw Error("Cannot convert WebCrypto algorithm to ASN.1 algorithm")}toWebAlgorithm(e){for(let t of this.getAlgorithms()){let r=t.toWebAlgorithm(e);if(r)return r}return{name:e.algorithm,parameters:e.parameters}}});let aP="1.3.36.3.3.2.8.1.1",aU=`${aP}.1`,aD=`${aP}.2`,aV=`${aP}.3`,aR=`${aP}.4`,aL=`${aP}.5`,aH=`${aP}.6`,aM=`${aP}.7`,aF=`${aP}.8`,az=`${aP}.9`,a$=`${aP}.10`,aK=`${aP}.11`,aW=`${aP}.12`,aq=`${aP}.13`,aG=`${aP}.14`,aJ="brainpoolP160r1",aY="brainpoolP160t1",aZ="brainpoolP192r1",aX="brainpoolP192t1",aQ="brainpoolP224r1",a0="brainpoolP224t1",a1="brainpoolP256r1",a2="brainpoolP256t1",a8="brainpoolP320r1",a4="brainpoolP320t1",a5="brainpoolP384r1",a3="brainpoolP384t1",a6="brainpoolP512r1",a9="brainpoolP512t1",a7="ECDSA",le=eg=class{toAsnAlgorithm(e){if(e.name.toLowerCase()===a7.toLowerCase()){if("hash"in e)switch(("string"==typeof e.hash?e.hash:e.hash.name).toLowerCase()){case"sha-1":return nZ;case"sha-256":return nX;case"sha-384":return nQ;case"sha-512":return n0}else if("namedCurve"in e){let t="";switch(e.namedCurve){case"P-256":t=nq;break;case"K-256":t=eg.SECP256K1;break;case"P-384":t=nG;break;case"P-521":t=nJ;break;case aJ:t=aU;break;case aY:t=aD;break;case aZ:t=aV;break;case aX:t=aR;break;case aQ:t=aL;break;case a0:t=aH;break;case a1:t=aM;break;case a2:t=aF;break;case a8:t=az;break;case a4:t=a$;break;case a5:t=aK;break;case a3:t=aW;break;case a6:t=aq;break;case a9:t=aG}if(t)return new sB({algorithm:nM,parameters:ih.serialize(new n4({namedCurve:t}))})}}return null}toWebAlgorithm(e){switch(e.algorithm){case nF:return{name:a7,hash:{name:"SHA-1"}};case n$:return{name:a7,hash:{name:"SHA-256"}};case nK:return{name:a7,hash:{name:"SHA-384"}};case nW:return{name:a7,hash:{name:"SHA-512"}};case nM:if(!e.parameters)throw TypeError("Cannot get required parameters from EC algorithm");switch(ih.parse(e.parameters,n4).namedCurve){case nq:return{name:a7,namedCurve:"P-256"};case eg.SECP256K1:return{name:a7,namedCurve:"K-256"};case nG:return{name:a7,namedCurve:"P-384"};case nJ:return{name:a7,namedCurve:"P-521"};case aU:return{name:a7,namedCurve:aJ};case aD:return{name:a7,namedCurve:aY};case aV:return{name:a7,namedCurve:aZ};case aR:return{name:a7,namedCurve:aX};case aL:return{name:a7,namedCurve:aQ};case aH:return{name:a7,namedCurve:a0};case aM:return{name:a7,namedCurve:a1};case aF:return{name:a7,namedCurve:a2};case az:return{name:a7,namedCurve:a8};case a$:return{name:a7,namedCurve:a4};case aK:return{name:a7,namedCurve:a5};case aW:return{name:a7,namedCurve:a3};case aq:return{name:a7,namedCurve:a6};case aG:return{name:a7,namedCurve:a9}}}return null}};le.SECP256K1="1.3.132.0.10",le=eg=(0,ip.__decorate)([oJ()],le),oG.registerSingleton(aI,le);let lt=Symbol("name"),lr=Symbol("value");class li{constructor(e,t={},r=""){for(const i in this[lt]=e,this[lr]=r,t)this[i]=t[i]}}li.NAME=lt,li.VALUE=lr;class ls{static toString(e){let t=this.items[e];return t||e}}ls.items={[oh]:"sha1",[op]:"sha224",[od]:"sha256",[of]:"sha384",[oy]:"sha512",[n9]:"rsaEncryption",[os]:"sha1WithRSAEncryption",[on]:"sha224WithRSAEncryption",[oo]:"sha256WithRSAEncryption",[oa]:"sha384WithRSAEncryption",[ol]:"sha512WithRSAEncryption",[nM]:"ecPublicKey",[nF]:"ecdsaWithSHA1",[nz]:"ecdsaWithSHA224",[n$]:"ecdsaWithSHA256",[nK]:"ecdsaWithSHA384",[nW]:"ecdsaWithSHA512",[i7]:"TLS WWW server authentication",[se]:"TLS WWW client authentication",[st]:"Code Signing",[sr]:"E-mail Protection",[si]:"Time Stamping",[ss]:"OCSP Signing","1.2.840.113549.1.7.2":"Signed Data"};class ln{static serialize(e){return this.serializeObj(e).join("\n")}static pad(e=0){return"".padStart(2*e," ")}static serializeObj(e,t=0){let r=[],i=this.pad(t++),s="",n=e[li.VALUE];for(let o in n&&(s=` ${n}`),r.push(`${i}${e[li.NAME]}:${s}`),i=this.pad(t),e){if("symbol"==typeof o)continue;let s=e[o],n=o?`${o}: `:"";if("string"==typeof s||"number"==typeof s||"boolean"==typeof s)r.push(`${i}${n}${s}`);else if(s instanceof Date)r.push(`${i}${n}${s.toUTCString()}`);else if(Array.isArray(s))for(let e of s)e[li.NAME]=o,r.push(...this.serializeObj(e,t));else if(s instanceof li)s[li.NAME]=o,r.push(...this.serializeObj(s,t));else if(tm.BufferSourceConverter.isBufferSource(s))o?(r.push(`${i}${n}`),r.push(...this.serializeBufferSource(s,t+1))):r.push(...this.serializeBufferSource(s,t));else if("toTextObject"in s){let e=s.toTextObject();e[li.NAME]=o,r.push(...this.serializeObj(e,t))}else throw TypeError("Cannot serialize data in text format. Unsupported type.")}return r}static serializeBufferSource(e,t=0){let r=this.pad(t),i=tm.BufferSourceConverter.toUint8Array(e),s=[];for(let e=0;e<i.length;){let t=[];for(let r=0;r<16&&e<i.length;r++){8===r&&t.push("");let s=i[e++].toString(16).padStart(2,"0");t.push(s)}s.push(`${r}${t.join(" ")}`)}return s}static serializeAlgorithm(e){return this.algorithmSerializer.toTextObject(e)}}ln.oidSerializer=ls,ln.algorithmSerializer=class{static toTextObject(e){let t=new li("Algorithm Identifier",{},ls.toString(e.algorithm));if(e.parameters)if(e.algorithm===nM){let r=new le().toWebAlgorithm(e);r&&"namedCurve"in r?t["Named Curve"]=r.namedCurve:t.Parameters=e.parameters}else t.Parameters=e.parameters;return t}};class lo{get rawData(){return(0,ip.__classPrivateFieldGet)(this,em,"f")||(0,ip.__classPrivateFieldSet)(this,em,ih.serialize(this.asn),"f"),(0,ip.__classPrivateFieldGet)(this,em,"f")}constructor(...e){em.set(this,void 0),tm.BufferSourceConverter.isBufferSource(e[0])?(this.asn=ih.parse(e[0],e[1]),(0,ip.__classPrivateFieldSet)(this,em,tm.BufferSourceConverter.toArrayBuffer(e[0]),"f")):this.asn=e[0],this.onInit(this.asn)}equal(e){return e instanceof lo&&(0,tm.isEqual)(e.rawData,this.rawData)}toString(e="text"){switch(e){case"asn":return ih.toString(this.rawData);case"text":return ln.serialize(this.toTextObject());case"hex":return tm.Convert.ToHex(this.rawData);case"base64":return tm.Convert.ToBase64(this.rawData);case"base64url":return tm.Convert.ToBase64Url(this.rawData);default:throw TypeError("Argument 'format' is unsupported value")}}getTextName(){return this.constructor.NAME}toTextObject(){let e=this.toTextObjectEmpty();return e[""]=this.rawData,e}toTextObjectEmpty(e){return new li(this.getTextName(),{},e)}}em=new WeakMap,lo.NAME="ASN";class la extends lo{constructor(...e){super(tm.BufferSourceConverter.isBufferSource(e[0])?tm.BufferSourceConverter.toArrayBuffer(e[0]):ih.serialize(new sO({extnID:e[0],critical:e[1],extnValue:new rL(tm.BufferSourceConverter.toArrayBuffer(e[2]))})),sO)}onInit(e){this.type=e.extnID,this.critical=e.critical,this.value=e.extnValue.buffer}toTextObject(){let e=this.toTextObjectWithoutValue();return e[""]=this.value,e}toTextObjectWithoutValue(){let e=this.toTextObjectEmpty(this.critical?"critical":void 0);return e[li.NAME]===la.NAME&&(e[li.NAME]=ls.toString(this.type)),e}}class ll{static isCryptoKeyPair(e){return e&&e.privateKey&&e.publicKey}static isCryptoKey(e){return e&&e.usages&&e.type&&e.algorithm&&void 0!==e.extractable}constructor(){this.items=new Map,this[ev]="CryptoProvider","undefined"!=typeof self&&"undefined"!=typeof crypto?this.set(ll.DEFAULT,crypto):e.g.crypto&&e.g.crypto.subtle&&this.set(ll.DEFAULT,e.g.crypto)}clear(){this.items.clear()}delete(e){return this.items.delete(e)}forEach(e,t){return this.items.forEach(e,t)}has(e){return this.items.has(e)}get size(){return this.items.size}entries(){return this.items.entries()}keys(){return this.items.keys()}values(){return this.items.values()}[Symbol.iterator](){return this.items[Symbol.iterator]()}get(e=ll.DEFAULT){let t=this.items.get(e.toLowerCase());if(!t)throw Error(`Cannot get Crypto by name '${e}'`);return t}set(e,t){if("string"==typeof e){if(!t)throw TypeError("Argument 'value' is required");this.items.set(e.toLowerCase(),t)}else this.items.set(ll.DEFAULT,e);return this}}ev=Symbol.toStringTag,ll.DEFAULT="default";let lc=new ll,lu=/^[0-2](?:\.[1-9][0-9]*)+$/;class lh{constructor(e={}){for(const t in this.items={},e)this.register(t,e[t])}get(e){return this.items[e]||null}findId(e){return new RegExp(lu).test(e)?e:this.get(e)}register(e,t){this.items[e]=t,this.items[t]=e}}let lp=new lh;function ld(e,t){return`\\${tm.Convert.ToHex(tm.Convert.FromUtf8String(t)).toUpperCase()}`}lp.register("CN","2.5.4.3"),lp.register("L","2.5.4.7"),lp.register("ST","2.5.4.8"),lp.register("O","2.5.4.10"),lp.register("OU","2.5.4.11"),lp.register("C","2.5.4.6"),lp.register("DC","0.9.2342.19200300.100.1.25"),lp.register("E","1.2.840.113549.1.9.1"),lp.register("G","2.5.4.42"),lp.register("I","2.5.4.43"),lp.register("SN","2.5.4.4"),lp.register("T","2.5.4.12");class lf{static isASCII(e){for(let t=0;t<e.length;t++)if(e.charCodeAt(t)>255)return!1;return!0}static isPrintableString(e){return/^[A-Za-z0-9 '()+,-./:=?]*$/g.test(e)}constructor(e,t={}){for(const e in this.extraNames=new lh,this.asn=new ix,t)if(Object.prototype.hasOwnProperty.call(t,e)){const r=t[e];this.extraNames.register(e,r)}"string"==typeof e?this.asn=this.fromString(e):e instanceof ix?this.asn=e:tm.BufferSourceConverter.isBufferSource(e)?this.asn=ih.parse(e,ix):this.asn=this.fromJSON(e)}getField(e){let t=this.extraNames.findId(e)||lp.findId(e),r=[];for(let e of this.asn)for(let i of e)i.type===t&&r.push(i.value.toString());return r}getName(e){return this.extraNames.get(e)||lp.get(e)}toString(){return this.asn.map(e=>e.map(e=>{let t=this.getName(e.type)||e.type,r=e.value.anyValue?`#${tm.Convert.ToHex(e.value.anyValue)}`:e.value.toString().replace(/([,+"\\<>;])/g,"\\$1").replace(/^([ #])/,"\\$1").replace(/([ ]$)/,"\\$1").replace(/([\r\n\t])/,ld);return`${t}=${r}`}).join("+")).join(", ")}toJSON(){let e=[];for(let t of this.asn){let r={};for(let e of t){let t=this.getName(e.type)||e.type;null!=r[t]||(r[t]=[]),r[t].push(e.value.anyValue?`#${tm.Convert.ToHex(e.value.anyValue)}`:e.value.toString())}e.push(r)}return e}fromString(e){let t=new ix,r=/(\d\.[\d.]*\d|[A-Za-z]+)=((?:"")|(?:".*?[^\\]")|(?:[^,+"\\](?=[,+]|$))|(?:[^,+].*?(?:[^\\][,+]))|(?:))([,+])?/g,i=null,s=",";for(;i=r.exec(`${e},`);){let[,e,r]=i,n=r[r.length-1];(","===n||"+"===n)&&(r=r.slice(0,r.length-1),i[3]=n);let o=i[3];e=this.getTypeOid(e);let a=this.createAttribute(e,r);"+"===s?t[t.length-1].push(a):t.push(new iv([a])),s=o}return t}fromJSON(e){let t=new ix;for(let r of e){let e=new iv;for(let t in r){let i=this.getTypeOid(t);for(let s of r[t]){let t=this.createAttribute(i,s);e.push(t)}}t.push(e)}return t}getTypeOid(e){if(/[\d.]+/.test(e)||(e=this.getName(e)||""),!e)throw Error(`Cannot get OID for name type '${e}'`);return e}createAttribute(e,t){let r=new im({type:e});if("object"==typeof t)for(let e in t)switch(e){case"ia5String":r.value.ia5String=t[e];break;case"utf8String":r.value.utf8String=t[e];break;case"universalString":r.value.universalString=t[e];break;case"bmpString":r.value.bmpString=t[e];break;case"printableString":r.value.printableString=t[e]}else if("#"===t[0])r.value.anyValue=tm.Convert.FromHex(t.slice(1));else{let i=this.processStringValue(t);e===this.getName("E")||e===this.getName("DC")?r.value.ia5String=i:lf.isPrintableString(i)?r.value.printableString=i:r.value.utf8String=i}return r}processStringValue(e){let t=/"(.*?[^\\])?"/.exec(e);return t&&(e=t[1]),e.replace(/\\0a/ig,"\n").replace(/\\0d/ig,"\r").replace(/\\0g/ig,"	").replace(/\\(.)/g,"$1")}toArrayBuffer(){return ih.serialize(this.asn)}async getThumbprint(...e){var t;let r,i="SHA-1";return!(e.length>=1)||(null==(t=e[0])?void 0:t.subtle)?r=e[0]||lc.get():(i=e[0]||i,r=e[1]||lc.get()),await r.subtle.digest(i,this.toArrayBuffer())}}let ly="Cannot initialize GeneralName from ASN.1 data.",lg=`${ly} Unsupported string format in use.`,lm=`${ly} Value doesn't match to GUID regular expression.`,lv=/^([0-9a-f]{8})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{12})$/i,lb="1.3.6.1.4.1.311.25.1",lx="1.3.6.1.4.1.311.20.2.3",lS="email",lw="guid";class l_ extends lo{constructor(...e){let t;if(2===e.length)switch(e[0]){case"dn":{const r=new lf(e[1]).toArrayBuffer(),i=ih.parse(r,ix);t=new i_({directoryName:i});break}case"dns":t=new i_({dNSName:e[1]});break;case lS:t=new i_({rfc822Name:e[1]});break;case lw:{const r=RegExp(lv,"i").exec(e[1]);if(!r)throw Error("Cannot parse GUID value. Value doesn't match to regular expression");const i=r.slice(1).map((e,t)=>t<3?tm.Convert.ToHex(new Uint8Array(tm.Convert.FromHex(e)).reverse()):e).join("");t=new i_({otherName:new iS({typeId:lb,value:ih.serialize(new rL(tm.Convert.FromHex(i)))})});break}case"ip":t=new i_({iPAddress:e[1]});break;case"id":t=new i_({registeredID:e[1]});break;case"upn":t=new i_({otherName:new iS({typeId:lx,value:ih.serialize(rJ.toASN(e[1]))})});break;case"url":t=new i_({uniformResourceIdentifier:e[1]});break;default:throw Error("Cannot create GeneralName. Unsupported type of the name")}else t=tm.BufferSourceConverter.isBufferSource(e[0])?ih.parse(e[0],i_):e[0];super(t)}onInit(e){if(void 0!=e.dNSName)this.type="dns",this.value=e.dNSName;else if(void 0!=e.rfc822Name)this.type=lS,this.value=e.rfc822Name;else if(void 0!=e.iPAddress)this.type="ip",this.value=e.iPAddress;else if(void 0!=e.uniformResourceIdentifier)this.type="url",this.value=e.uniformResourceIdentifier;else if(void 0!=e.registeredID)this.type="id",this.value=e.registeredID;else if(void 0!=e.directoryName)this.type="dn",this.value=new lf(e.directoryName).toString();else if(void 0!=e.otherName)if(e.otherName.typeId===lb){this.type=lw;let t=ih.parse(e.otherName.value,rL),r=RegExp(lv,"i").exec(tm.Convert.ToHex(t));if(!r)throw Error(lm);this.value=r.slice(1).map((e,t)=>t<3?tm.Convert.ToHex(new Uint8Array(tm.Convert.FromHex(e)).reverse()):e).join("-")}else if(e.otherName.typeId===lx)this.type="upn",this.value=ih.parse(e.otherName.value,iy).toString();else throw Error(lg);else throw Error(lg)}toJSON(){return{type:this.type,value:this.value}}toTextObject(){let e;switch(this.type){case"dn":case"dns":case lw:case"ip":case"id":case"upn":case"url":e=this.type.toUpperCase();break;case lS:e="Email";break;default:throw Error("Unsupported GeneralName type")}let t=this.value;return"id"===this.type&&(t=ls.toString(t)),new li(e,void 0,t)}}class lA extends lo{constructor(e){let t;if(e instanceof iM)t=e;else if(Array.isArray(e)){const r=[];for(const t of e)if(t instanceof i_)r.push(t);else{const e=ih.parse(new l_(t.type,t.value).rawData,i_);r.push(e)}t=new iM(r)}else if(tm.BufferSourceConverter.isBufferSource(e))t=ih.parse(e,iM);else throw Error("Cannot initialize GeneralNames. Incorrect incoming arguments");super(t)}onInit(e){let t=[];for(let r of e){let e=null;try{e=new l_(r)}catch{continue}t.push(e)}this.items=t}toJSON(){return this.items.map(e=>e.toJSON())}toTextObject(){let e=super.toTextObjectEmpty();for(let t of this.items){let r=t.toTextObject(),i=e[r[li.NAME]];Array.isArray(i)||(i=[],e[r[li.NAME]]=i),i.push(r)}return e}}lA.NAME="GeneralNames";let lk="-{5}",lC=`[^\\n]+`,lB=`${lk}BEGIN (${lC}(?=${lk}))${lk}`,lN=`${lk}END \\1${lk}`,lj=`[^:\\n]+`,lE=`(?:[^\\n]+\\n(?: +[^\\n]+\\n)*)`,lO=`(?:[a-zA-Z0-9=+/]+\\n)+`,lI=`${lB}\\n(?:((?:${lj}: ${lE})+))?\\n?(${lO})${lN}`;class lT{static isPem(e){return"string"==typeof e&&RegExp(lI,"g").test(e.replace(/\r/g,""))}static decodeWithHeaders(e){e=e.replace(/\r/g,"");let t=RegExp(lI,"g"),r=[],i=null;for(;i=t.exec(e);){let e=i[3].replace(RegExp(`[\\n]+`,"g"),""),t={type:i[1],headers:[],rawData:tm.Convert.FromBase64(e)},s=i[2];if(s){let e=s.split(RegExp("\\n","g")),r=null;for(let i of e){let[e,s]=i.split(/:(.*)/);if(void 0===s){if(!r)throw Error("Cannot parse PEM string. Incorrect header value");r.value+=e.trim()}else r&&t.headers.push(r),r={key:e,value:s.trim()}}r&&t.headers.push(r)}r.push(t)}return r}static decode(e){return this.decodeWithHeaders(e).map(e=>e.rawData)}static decodeFirst(e){let t=this.decode(e);if(!t.length)throw RangeError("PEM string doesn't contain any objects");return t[0]}static encode(e,t){if(Array.isArray(e)){let r=[];return t?e.forEach(e=>{if(!tm.BufferSourceConverter.isBufferSource(e))throw TypeError("Cannot encode array of BufferSource in PEM format. Not all items of the array are BufferSource");r.push(this.encodeStruct({type:t,rawData:tm.BufferSourceConverter.toArrayBuffer(e)}))}):e.forEach(e=>{if(!("type"in e))throw TypeError("Cannot encode array of PemStruct in PEM format. Not all items of the array are PemStrut");r.push(this.encodeStruct(e))}),r.join("\n")}if(!t)throw Error("Required argument 'tag' is missed");return this.encodeStruct({type:t,rawData:tm.BufferSourceConverter.toArrayBuffer(e)})}static encodeStruct(e){var t;let r,i=e.type.toLocaleUpperCase(),s=[];if(s.push(`-----BEGIN ${i}-----`),null==(t=e.headers)?void 0:t.length){for(let t of e.headers)s.push(`${t.key}: ${t.value}`);s.push("")}let n=tm.Convert.ToBase64(e.rawData),o=0,a=[];for(;o<n.length;)if(n.length-o<64?r=n.substring(o):(r=n.substring(o,o+64),o+=64),0!==r.length){if(a.push(r),r.length<64)break}else break;return s.push(...a),s.push(`-----END ${i}-----`),s.join("\n")}}lT.CertificateTag="CERTIFICATE",lT.CrlTag="CRL",lT.CertificateRequestTag="CERTIFICATE REQUEST",lT.PublicKeyTag="PUBLIC KEY",lT.PrivateKeyTag="PRIVATE KEY";class lP extends lo{static isAsnEncoded(e){return tm.BufferSourceConverter.isBufferSource(e)||"string"==typeof e}static toArrayBuffer(e){if("string"==typeof e)if(lT.isPem(e))return lT.decode(e)[0];else if(tm.Convert.isHex(e))return tm.Convert.FromHex(e);else if(tm.Convert.isBase64(e))return tm.Convert.FromBase64(e);else if(tm.Convert.isBase64Url(e))return tm.Convert.FromBase64Url(e);else throw TypeError("Unsupported format of 'raw' argument. Must be one of DER, PEM, HEX, Base64, or Base4Url");{let t=tm.BufferSourceConverter.toUint8Array(e);if(t.length>0&&48===t[0])return tm.BufferSourceConverter.toArrayBuffer(e);let r=tm.Convert.ToBinary(e);if(lT.isPem(r))return lT.decode(r)[0];if(tm.Convert.isHex(r))return tm.Convert.FromHex(r);if(tm.Convert.isBase64(r))return tm.Convert.FromBase64(r);else if(tm.Convert.isBase64Url(r))return tm.Convert.FromBase64Url(r);throw TypeError("Unsupported format of 'raw' argument. Must be one of DER, PEM, HEX, Base64, or Base4Url")}}constructor(...e){lP.isAsnEncoded(e[0])?super(lP.toArrayBuffer(e[0]),e[1]):super(e[0])}toString(e="pem"){return"pem"===e?lT.encode(this.rawData,this.tag):super.toString(e)}}class lU extends lP{static async create(e,t=lc.get()){if(e instanceof lU)return e;if(ll.isCryptoKey(e)){if("public"!==e.type)throw TypeError("Public key is required");return new lU(await t.subtle.exportKey("spki",e))}if(e.publicKey)return e.publicKey;if(tm.BufferSourceConverter.isBufferSource(e))return new lU(e);throw TypeError("Unsupported PublicKeyType")}constructor(e){lP.isAsnEncoded(e)?super(e,sN):super(e),this.tag=lT.PublicKeyTag}async export(...e){var t;let r,i=["verify"],s={hash:"SHA-256",...this.algorithm};e.length>1?(s=e[0]||s,i=e[1]||i,r=e[2]||lc.get()):r=e[0]||lc.get();let n=this.rawData,o=ih.parse(this.rawData,sN);return o.algorithm.algorithm===ot&&(t=o,t.algorithm=new sB({algorithm:n9,parameters:null}),n=ih.serialize(t)),r.subtle.importKey("spki",n,s,!0,i)}onInit(e){let t=oG.resolve(aT),r=this.algorithm=t.toWebAlgorithm(e.algorithm);if(e.algorithm.algorithm===n9){let t=ih.parse(e.subjectPublicKey,oB),i=tm.BufferSourceConverter.toUint8Array(t.modulus);r.publicExponent=tm.BufferSourceConverter.toUint8Array(t.publicExponent),r.modulusLength=(!i[0]?i.slice(1):i).byteLength<<3}}async getThumbprint(...e){var t;let r,i="SHA-1";return!(e.length>=1)||(null==(t=e[0])?void 0:t.subtle)?r=e[0]||lc.get():(i=e[0]||i,r=e[1]||lc.get()),await r.subtle.digest(i,this.rawData)}async getKeyIdentifier(...e){let t,r="SHA-1";1===e.length?"string"==typeof e[0]?(r=e[0],t=lc.get()):t=e[0]:2===e.length?(r=e[0],t=e[1]):t=lc.get();let i=ih.parse(this.rawData,sN);return await t.subtle.digest(r,i.subjectPublicKey)}toTextObject(){let e=this.toTextObjectEmpty(),t=ih.parse(this.rawData,sN);return e.Algorithm=ln.serializeAlgorithm(t.algorithm),t.algorithm.algorithm===nM?e["EC Point"]=t.subjectPublicKey:e["Raw Data"]=t.subjectPublicKey,e}}class lD extends la{static async create(e,t=!1,r=lc.get()){if("name"in e&&"serialNumber"in e)return new lD(e,t);let i=await lU.create(e,r),s=await i.getKeyIdentifier(r);return new lD(tm.Convert.ToHex(s),t)}constructor(...e){if(tm.BufferSourceConverter.isBufferSource(e[0]))super(e[0]);else if("string"==typeof e[0])super(iD,e[1],ih.serialize(new iR({keyIdentifier:new iV(tm.Convert.FromHex(e[0]))})));else{const t=e[0];super(iD,e[1],ih.serialize(new iR({authorityCertIssuer:t.name instanceof lA?ih.parse(t.name.rawData,iM):t.name,authorityCertSerialNumber:tm.Convert.FromHex(t.serialNumber)})))}}onInit(e){super.onInit(e);let t=ih.parse(e.extnValue,iR);t.keyIdentifier&&(this.keyId=tm.Convert.ToHex(t.keyIdentifier)),(t.authorityCertIssuer||t.authorityCertSerialNumber)&&(this.certId={name:t.authorityCertIssuer||[],serialNumber:t.authorityCertSerialNumber?tm.Convert.ToHex(t.authorityCertSerialNumber):""})}toTextObject(){let e=this.toTextObjectWithoutValue(),t=ih.parse(this.value,iR);return t.authorityCertIssuer&&(e["Authority Issuer"]=new lA(t.authorityCertIssuer).toTextObject()),t.authorityCertSerialNumber&&(e["Authority Serial Number"]=t.authorityCertSerialNumber),t.keyIdentifier&&(e[""]=t.keyIdentifier),e}}lD.NAME="Authority Key Identifier";class lV extends la{constructor(...e){if(tm.BufferSourceConverter.isBufferSource(e[0])){super(e[0]);const t=ih.parse(this.value,iH);this.ca=t.cA,this.pathLength=t.pathLenConstraint}else super(iL,e[2],ih.serialize(new iH({cA:e[0],pathLenConstraint:e[1]}))),this.ca=e[0],this.pathLength=e[1]}toTextObject(){let e=this.toTextObjectWithoutValue();return this.ca&&(e.CA=this.ca),void 0!==this.pathLength&&(e["Path Length"]=this.pathLength),e}}lV.NAME="Basic Constraints",(y=eb||(eb={})).serverAuth="1.3.6.1.5.5.7.3.1",y.clientAuth="1.3.6.1.5.5.7.3.2",y.codeSigning="1.3.6.1.5.5.7.3.3",y.emailProtection="1.3.6.1.5.5.7.3.4",y.timeStamping="1.3.6.1.5.5.7.3.8",y.ocspSigning="1.3.6.1.5.5.7.3.9";class lR extends la{constructor(...e){if(tm.BufferSourceConverter.isBufferSource(e[0])){super(e[0]);const t=ih.parse(this.value,i9);this.usages=t.map(e=>e)}else super(i6,e[1],ih.serialize(new i9(e[0]))),this.usages=e[0]}toTextObject(){let e=this.toTextObjectWithoutValue();return e[""]=this.usages.map(e=>ls.toString(e)).join(", "),e}}lR.NAME="Extended Key Usages",(g=ex||(ex={}))[g.digitalSignature=1]="digitalSignature",g[g.nonRepudiation=2]="nonRepudiation",g[g.keyEncipherment=4]="keyEncipherment",g[g.dataEncipherment=8]="dataEncipherment",g[g.keyAgreement=16]="keyAgreement",g[g.keyCertSign=32]="keyCertSign",g[g.cRLSign=64]="cRLSign",g[g.encipherOnly=128]="encipherOnly",g[g.decipherOnly=256]="decipherOnly";class lL extends la{constructor(...e){if(tm.BufferSourceConverter.isBufferSource(e[0])){super(e[0]);const t=ih.parse(this.value,su);this.usages=t.toNumber()}else super(sc,e[1],ih.serialize(new su(e[0]))),this.usages=e[0]}toTextObject(){let e=this.toTextObjectWithoutValue(),t=ih.parse(this.value,su);return e[""]=t.toJSON().join(", "),e}}lL.NAME="Key Usages";class lH extends la{static async create(e,t=!1,r=lc.get()){let i=await lU.create(e,r),s=await i.getKeyIdentifier(r);return new lH(tm.Convert.ToHex(s),t)}constructor(...e){if(tm.BufferSourceConverter.isBufferSource(e[0])){super(e[0]);const t=ih.parse(this.value,sw);this.keyId=tm.Convert.ToHex(t)}else{const t="string"==typeof e[0]?tm.Convert.FromHex(e[0]):e[0];super(sS,e[1],ih.serialize(new sw(t))),this.keyId=tm.Convert.ToHex(t)}}toTextObject(){let e=this.toTextObjectWithoutValue(),t=ih.parse(this.value,sw);return e[""]=t,e}}lH.NAME="Subject Key Identifier";class lM extends la{constructor(...e){tm.BufferSourceConverter.isBufferSource(e[0])?super(e[0]):super(sm,e[1],new lA(e[0]||[]).rawData)}onInit(e){super.onInit(e);let t=ih.parse(e.extnValue,sv);this.names=new lA(t)}toTextObject(){let e=this.toTextObjectWithoutValue(),t=this.names.toTextObject();for(let r in t)e[r]=t[r];return e}}lM.NAME="Subject Alternative Name";class lF{static register(e,t){this.items.set(e,t)}static create(e){let t=new la(e),r=this.items.get(t.type);return r?new r(e):t}}lF.items=new Map;class lz extends la{constructor(...e){var t;if(tm.BufferSourceConverter.isBufferSource(e[0])){super(e[0]);const t=ih.parse(this.value,iY);this.policies=t.map(e=>e.policyIdentifier)}else{const r=e[0];super(iz,null!=(t=e[1])&&t,ih.serialize(new iY(r.map(e=>new iJ({policyIdentifier:e}))))),this.policies=r}}toTextObject(){let e=this.toTextObjectWithoutValue();return e.Policy=this.policies.map(e=>new li("",{},ls.toString(e))),e}}lz.NAME="Certificate Policies",lF.register(iz,lz);class l$ extends la{constructor(...e){tm.BufferSourceConverter.isBufferSource(e[0])?super(e[0]):Array.isArray(e[0])&&"string"==typeof e[0][0]?super(iQ,e[1],ih.serialize(new i8(e[0].map(e=>new i2({distributionPoint:new i1({fullName:[new i_({uniformResourceIdentifier:e})]})}))))):super(iQ,e[1],ih.serialize(new i8(e[0]))),null!=this.distributionPoints||(this.distributionPoints=[])}onInit(e){super.onInit(e);let t=ih.parse(e.extnValue,i8);this.distributionPoints=t}toTextObject(){let e=this.toTextObjectWithoutValue();return e["Distribution Point"]=this.distributionPoints.map(e=>{var t;let r={};return e.distributionPoint&&(r[""]=null==(t=e.distributionPoint.fullName)?void 0:t.map(e=>new l_(e).toString()).join(", ")),e.reasons&&(r.Reasons=e.reasons.toString()),e.cRLIssuer&&(r["CRL Issuer"]=e.cRLIssuer.map(e=>e.toString()).join(", ")),r}),e}}l$.NAME="CRL Distribution Points";class lK extends la{constructor(...e){if(tm.BufferSourceConverter.isBufferSource(e[0]))super(e[0]);else if(e[0]instanceof iU)super(iT,e[1],ih.serialize(new iU(e[0])));else{const t=e[0],r=new iU;lq(r,t,iN,"ocsp"),lq(r,t,ij,"caIssuers"),lq(r,t,iE,"timeStamping"),lq(r,t,iO,"caRepository"),super(iT,e[1],ih.serialize(r))}null!=this.ocsp||(this.ocsp=[]),null!=this.caIssuers||(this.caIssuers=[]),null!=this.timeStamping||(this.timeStamping=[]),null!=this.caRepository||(this.caRepository=[])}onInit(e){super.onInit(e),this.ocsp=[],this.caIssuers=[],this.timeStamping=[],this.caRepository=[],ih.parse(e.extnValue,iU).forEach(e=>{switch(e.accessMethod){case iN:this.ocsp.push(new l_(e.accessLocation));break;case ij:this.caIssuers.push(new l_(e.accessLocation));break;case iE:this.timeStamping.push(new l_(e.accessLocation));break;case iO:this.caRepository.push(new l_(e.accessLocation))}})}toTextObject(){let e=this.toTextObjectWithoutValue();return this.ocsp.length&&lW(e,"OCSP",this.ocsp),this.caIssuers.length&&lW(e,"CA Issuers",this.caIssuers),this.timeStamping.length&&lW(e,"Time Stamping",this.timeStamping),this.caRepository.length&&lW(e,"CA Repository",this.caRepository),e}}function lW(e,t,r){if(1===r.length)e[t]=r[0].toTextObject();else{let i=new li("");r.forEach((e,t)=>{let r=e.toTextObject(),s=`${r[li.NAME]} ${t+1}`,n=i[s];Array.isArray(n)||(n=[],i[s]=n),n.push(r)}),e[t]=i}}function lq(e,t,r,i){let s=t[i];s&&(Array.isArray(s)?s:[s]).forEach(t=>{"string"==typeof t&&(t=new l_("url",t)),e.push(new iP({accessMethod:r,accessLocation:ih.parse(t.rawData,i_)}))})}lK.NAME="Authority Info Access";class lG extends la{constructor(...e){tm.BufferSourceConverter.isBufferSource(e[0])?super(e[0]):super(sa,e[1],new lA(e[0]||[]).rawData)}onInit(e){super.onInit(e);let t=ih.parse(e.extnValue,iM);this.names=new lA(t)}toTextObject(){let e=this.toTextObjectWithoutValue(),t=this.names.toTextObject();for(let r in t)e[r]=t[r];return e}}lG.NAME="Issuer Alternative Name";class lJ extends lo{constructor(...e){let t;if(tm.BufferSourceConverter.isBufferSource(e[0]))t=tm.BufferSourceConverter.toArrayBuffer(e[0]);else{const r=e[0],i=Array.isArray(e[1])?e[1].map(e=>tm.BufferSourceConverter.toArrayBuffer(e)):[];t=ih.serialize(new sb({type:r,values:i}))}super(t,sb)}onInit(e){this.type=e.type,this.values=e.values}toTextObject(){let e=this.toTextObjectWithoutValue();return e.Value=this.values.map(e=>new li("",{"":e})),e}toTextObjectWithoutValue(){let e=this.toTextObjectEmpty();return e[li.NAME]===lJ.NAME&&(e[li.NAME]=ls.toString(this.type)),e}}lJ.NAME="Attribute";class lY extends lJ{constructor(...e){tm.BufferSourceConverter.isBufferSource(e[0])?super(e[0]):super(as,[ih.serialize(new a_({printableString:e[0]}))]),null!=this.password||(this.password="")}onInit(e){if(super.onInit(e),this.values[0]){let e=ih.parse(this.values[0],a_);this.password=e.toString()}}toTextObject(){let e=this.toTextObjectWithoutValue();return e[li.VALUE]=this.password,e}}lY.NAME="Challenge Password";class lZ extends lJ{constructor(...e){if(tm.BufferSourceConverter.isBufferSource(e[0]))super(e[0]);else{const t=e[0],r=new sI;for(const e of t)r.push(ih.parse(e.rawData,sO));super(an,[ih.serialize(r)])}null!=this.items||(this.items=[])}onInit(e){if(super.onInit(e),this.values[0]){let e=ih.parse(this.values[0],sI);this.items=e.map(e=>lF.create(ih.serialize(e)))}}toTextObject(){let e=this.toTextObjectWithoutValue();for(let t of this.items.map(e=>e.toTextObject()))e[t[li.NAME]]=t;return e}}lZ.NAME="Extensions";class lX{static register(e,t){this.items.set(e,t)}static create(e){let t=new lJ(e),r=this.items.get(t.type);return r?new r(e):t}}lX.items=new Map;let lQ="crypto.signatureFormatter",l0=eS=class{static createPssParams(e,t){let r=eS.getHashAlgorithm(e);return r?new ow({hashAlgorithm:r,maskGenAlgorithm:new sB({algorithm:og,parameters:ih.serialize(r)}),saltLength:t}):null}static getHashAlgorithm(e){let t=oG.resolve(aT);return"string"==typeof e?t.toAsnAlgorithm({name:e}):"object"==typeof e&&e&&"name"in e?t.toAsnAlgorithm(e):null}toAsnAlgorithm(e){switch(e.name.toLowerCase()){case"rsassa-pkcs1-v1_5":if(!("hash"in e))return new sB({algorithm:n9,parameters:null});{let t;if("string"==typeof e.hash)t=e.hash;else if(e.hash&&"object"==typeof e.hash&&"name"in e.hash&&"string"==typeof e.hash.name)t=e.hash.name.toUpperCase();else throw Error("Cannot get hash algorithm name");switch(t.toLowerCase()){case"sha-1":return new sB({algorithm:os,parameters:null});case"sha-256":return new sB({algorithm:oo,parameters:null});case"sha-384":return new sB({algorithm:oa,parameters:null});case"sha-512":return new sB({algorithm:ol,parameters:null})}}break;case"rsa-pss":if(!("hash"in e))return new sB({algorithm:ot,parameters:null});{if(!("saltLength"in e&&"number"==typeof e.saltLength))throw Error("Cannot get 'saltLength' from 'alg' argument");let t=eS.createPssParams(e.hash,e.saltLength);if(!t)throw Error("Cannot create PSS parameters");return new sB({algorithm:ot,parameters:ih.serialize(t)})}}return null}toWebAlgorithm(e){switch(e.algorithm){case n9:return{name:"RSASSA-PKCS1-v1_5"};case os:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}};case oo:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case oa:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}};case ol:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}};case ot:if(!e.parameters)return{name:"RSA-PSS"};{let t=ih.parse(e.parameters,ow);return{name:"RSA-PSS",hash:oG.resolve(aT).toWebAlgorithm(t.hashAlgorithm),saltLength:t.saltLength}}}return null}};l0=eS=(0,ip.__decorate)([oJ()],l0),oG.registerSingleton(aI,l0);let l1=class{toAsnAlgorithm(e){switch(e.name.toLowerCase()){case"sha-1":return new sB({algorithm:oh});case"sha-256":return new sB({algorithm:od});case"sha-384":return new sB({algorithm:of});case"sha-512":return new sB({algorithm:oy})}return null}toWebAlgorithm(e){switch(e.algorithm){case oh:return{name:"SHA-1"};case od:return{name:"SHA-256"};case of:return{name:"SHA-384"};case oy:return{name:"SHA-512"}}return null}};l1=(0,ip.__decorate)([oJ()],l1),oG.registerSingleton(aI,l1);class l2{addPadding(e,t){let r=tm.BufferSourceConverter.toUint8Array(t),i=new Uint8Array(e);return i.set(r,e-r.length),i.buffer}removePadding(e,t=!1){let r=tm.BufferSourceConverter.toUint8Array(e);for(let e=0;e<r.length;e++)if(r[e]){r=r.slice(e);break}if(t&&r[0]>127){let e=new Uint8Array(r.length+1);return e.set(r,1),e.buffer}return r.buffer}toAsnSignature(e,t){if("ECDSA"===e.name){let r=e.namedCurve,i=l2.namedCurveSize.get(r)||l2.defaultNamedCurveSize,s=new n3,n=tm.BufferSourceConverter.toUint8Array(t);return s.r=this.removePadding(n.slice(0,i),!0),s.s=this.removePadding(n.slice(i,i+i),!0),ih.serialize(s)}return null}toWebSignature(e,t){if("ECDSA"===e.name){let r=ih.parse(t,n3),i=e.namedCurve,s=l2.namedCurveSize.get(i)||l2.defaultNamedCurveSize,n=this.addPadding(s,this.removePadding(r.r)),o=this.addPadding(s,this.removePadding(r.s));return(0,tm.combine)(n,o)}return null}}l2.namedCurveSize=new Map,l2.defaultNamedCurveSize=32;let l8="1.3.101.110",l4="1.3.101.111",l5="1.3.101.112",l3="1.3.101.113",l6=class{toAsnAlgorithm(e){let t=null;switch(e.name.toLowerCase()){case"ed25519":t=l5;break;case"x25519":t=l8;break;case"eddsa":switch(e.namedCurve.toLowerCase()){case"ed25519":t=l5;break;case"ed448":t=l3}break;case"ecdh-es":switch(e.namedCurve.toLowerCase()){case"x25519":t=l8;break;case"x448":t=l4}}return t?new sB({algorithm:t}):null}toWebAlgorithm(e){switch(e.algorithm){case l5:return{name:"Ed25519"};case l3:return{name:"EdDSA",namedCurve:"Ed448"};case l8:return{name:"X25519"};case l4:return{name:"ECDH-ES",namedCurve:"X448"}}return null}};l6=(0,ip.__decorate)([oJ()],l6),oG.registerSingleton(aI,l6),new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap;class l9 extends lP{get publicKey(){return(0,ip.__classPrivateFieldGet)(this,eT,"f")||(0,ip.__classPrivateFieldSet)(this,eT,new lU(this.asn.tbsCertificate.subjectPublicKeyInfo),"f"),(0,ip.__classPrivateFieldGet)(this,eT,"f")}get serialNumber(){if(!(0,ip.__classPrivateFieldGet)(this,e_,"f")){let e=new Uint8Array(this.asn.tbsCertificate.serialNumber);e.length>1&&0===e[0]&&e[1]>127&&(e=e.slice(1)),(0,ip.__classPrivateFieldSet)(this,e_,tm.Convert.ToHex(e),"f")}return(0,ip.__classPrivateFieldGet)(this,e_,"f")}get subjectName(){return(0,ip.__classPrivateFieldGet)(this,eA,"f")||(0,ip.__classPrivateFieldSet)(this,eA,new lf(this.asn.tbsCertificate.subject),"f"),(0,ip.__classPrivateFieldGet)(this,eA,"f")}get subject(){return(0,ip.__classPrivateFieldGet)(this,ek,"f")||(0,ip.__classPrivateFieldSet)(this,ek,this.subjectName.toString(),"f"),(0,ip.__classPrivateFieldGet)(this,ek,"f")}get issuerName(){return(0,ip.__classPrivateFieldGet)(this,eC,"f")||(0,ip.__classPrivateFieldSet)(this,eC,new lf(this.asn.tbsCertificate.issuer),"f"),(0,ip.__classPrivateFieldGet)(this,eC,"f")}get issuer(){return(0,ip.__classPrivateFieldGet)(this,eB,"f")||(0,ip.__classPrivateFieldSet)(this,eB,this.issuerName.toString(),"f"),(0,ip.__classPrivateFieldGet)(this,eB,"f")}get notBefore(){if(!(0,ip.__classPrivateFieldGet)(this,eN,"f")){let e=this.asn.tbsCertificate.validity.notBefore.utcTime||this.asn.tbsCertificate.validity.notBefore.generalTime;if(!e)throw Error("Cannot get 'notBefore' value");(0,ip.__classPrivateFieldSet)(this,eN,e,"f")}return(0,ip.__classPrivateFieldGet)(this,eN,"f")}get notAfter(){if(!(0,ip.__classPrivateFieldGet)(this,ej,"f")){let e=this.asn.tbsCertificate.validity.notAfter.utcTime||this.asn.tbsCertificate.validity.notAfter.generalTime;if(!e)throw Error("Cannot get 'notAfter' value");(0,ip.__classPrivateFieldSet)(this,ej,e,"f")}return(0,ip.__classPrivateFieldGet)(this,ej,"f")}get signatureAlgorithm(){if(!(0,ip.__classPrivateFieldGet)(this,eE,"f")){let e=oG.resolve(aT);(0,ip.__classPrivateFieldSet)(this,eE,e.toWebAlgorithm(this.asn.signatureAlgorithm),"f")}return(0,ip.__classPrivateFieldGet)(this,eE,"f")}get signature(){return(0,ip.__classPrivateFieldGet)(this,eO,"f")||(0,ip.__classPrivateFieldSet)(this,eO,this.asn.signatureValue,"f"),(0,ip.__classPrivateFieldGet)(this,eO,"f")}get extensions(){return!(0,ip.__classPrivateFieldGet)(this,eI,"f")&&((0,ip.__classPrivateFieldSet)(this,eI,[],"f"),this.asn.tbsCertificate.extensions&&(0,ip.__classPrivateFieldSet)(this,eI,this.asn.tbsCertificate.extensions.map(e=>lF.create(ih.serialize(e))),"f")),(0,ip.__classPrivateFieldGet)(this,eI,"f")}get tbs(){return(0,ip.__classPrivateFieldGet)(this,ew,"f")||(0,ip.__classPrivateFieldSet)(this,ew,this.asn.tbsCertificateRaw||ih.serialize(this.asn.tbsCertificate),"f"),(0,ip.__classPrivateFieldGet)(this,ew,"f")}constructor(e){const t=lP.isAsnEncoded(e)?[e,sP]:[e];super(t[0],t[1]),ew.set(this,void 0),e_.set(this,void 0),eA.set(this,void 0),ek.set(this,void 0),eC.set(this,void 0),eB.set(this,void 0),eN.set(this,void 0),ej.set(this,void 0),eE.set(this,void 0),eO.set(this,void 0),eI.set(this,void 0),eT.set(this,void 0),this.tag=lT.CertificateTag}onInit(e){}getExtension(e){for(let t of this.extensions)if("string"==typeof e){if(t.type===e)return t}else if(t instanceof e)return t;return null}getExtensions(e){return this.extensions.filter(t=>"string"==typeof e?t.type===e:t instanceof e)}async verify(e={},t=lc.get()){let r,i,s=e.publicKey;try{if(s)if("publicKey"in s)r={...s.publicKey.algorithm,...this.signatureAlgorithm},i=await s.publicKey.export(r,["verify"],t);else if(s instanceof lU)r={...s.algorithm,...this.signatureAlgorithm},i=await s.export(r,["verify"],t);else if(tm.BufferSourceConverter.isBufferSource(s)){let e=new lU(s);r={...e.algorithm,...this.signatureAlgorithm},i=await e.export(r,["verify"],t)}else r={...s.algorithm,...this.signatureAlgorithm},i=s;else r={...this.publicKey.algorithm,...this.signatureAlgorithm},i=await this.publicKey.export(r,["verify"],t)}catch{return!1}let n=oG.resolveAll(lQ).reverse(),o=null;for(let e of n)if(o=e.toWebSignature(r,this.signature))break;if(!o)throw Error("Cannot convert ASN.1 signature value to WebCrypto format");let a=await t.subtle.verify(this.signatureAlgorithm,i,o,this.tbs);if(e.signatureOnly)return a;{let t=(e.date||new Date).getTime();return a&&this.notBefore.getTime()<t&&t<this.notAfter.getTime()}}async getThumbprint(...e){let t,r="SHA-1";return e[0]&&(e[0].subtle?t=e[0]:(r=e[0]||r,t=e[1])),null!=t||(t=lc.get()),await t.subtle.digest(r,this.rawData)}async isSelfSigned(e=lc.get()){return this.subject===this.issuer&&await this.verify({signatureOnly:!0},e)}toTextObject(){let e=this.toTextObjectEmpty(),t=ih.parse(this.rawData,sP),r=t.tbsCertificate,i=new li("",{Version:`${z[r.version]} (${r.version})`,"Serial Number":r.serialNumber,"Signature Algorithm":ln.serializeAlgorithm(r.signature),Issuer:this.issuer,Validity:new li("",{"Not Before":r.validity.notBefore.getTime(),"Not After":r.validity.notAfter.getTime()}),Subject:this.subject,"Subject Public Key Info":this.publicKey});if(r.issuerUniqueID&&(i["Issuer Unique ID"]=r.issuerUniqueID),r.subjectUniqueID&&(i["Subject Unique ID"]=r.subjectUniqueID),this.extensions.length){let e=new li("");for(let t of this.extensions){let r=t.toTextObject();e[r[li.NAME]]=r}i.Extensions=e}return e.Data=i,e.Signature=new li("",{Algorithm:ln.serializeAlgorithm(t.signatureAlgorithm),"":t.signatureValue}),e}}ew=new WeakMap,e_=new WeakMap,eA=new WeakMap,ek=new WeakMap,eC=new WeakMap,eB=new WeakMap,eN=new WeakMap,ej=new WeakMap,eE=new WeakMap,eO=new WeakMap,eI=new WeakMap,eT=new WeakMap,l9.NAME="Certificate";class l7{static async createSelfSigned(e,t=lc.get()){if(!e.keys.privateKey)throw Error("Bad field 'keys' in 'params' argument. 'privateKey' is empty");if(!e.keys.publicKey)throw Error("Bad field 'keys' in 'params' argument. 'publicKey' is empty");return this.create({serialNumber:e.serialNumber,subject:e.name,issuer:e.name,notBefore:e.notBefore,notAfter:e.notAfter,publicKey:e.keys.publicKey,signingKey:e.keys.privateKey,signingAlgorithm:e.signingAlgorithm,extensions:e.extensions},t)}static async create(e,t=lc.get()){var r;let i;i=e.publicKey instanceof lU?e.publicKey.rawData:"publicKey"in e.publicKey?e.publicKey.publicKey.rawData:tm.BufferSourceConverter.isBufferSource(e.publicKey)?e.publicKey:await t.subtle.exportKey("spki",e.publicKey);let s=function(e,t=lc.get()){let r=tm.BufferSourceConverter.toUint8Array(tm.Convert.FromHex(e||"")),i=r&&r.length&&r.some(e=>e>0)?new Uint8Array(r):void 0;i||(i=t.getRandomValues(new Uint8Array(16)));let s=0;for(;s<i.length-1&&0===i[s];)s++;if((i=i.slice(s))[0]>127){let e=new Uint8Array(i.length+1);e[0]=0,e.set(i,1),i=e}return i.buffer}(e.serialNumber,t),n=e.notBefore||new Date,o=e.notAfter||new Date(n.getTime()+31536e6),a=new sP({tbsCertificate:new sT({version:z.v3,serialNumber:s,validity:new sE({notBefore:n,notAfter:o}),extensions:new sI((null==(r=e.extensions)?void 0:r.map(e=>ih.parse(e.rawData,sO)))||[]),subjectPublicKeyInfo:ih.parse(i,sN)})});if(e.subject){let t=e.subject instanceof lf?e.subject:new lf(e.subject);a.tbsCertificate.subject=ih.parse(t.toArrayBuffer(),ix)}if(e.issuer){let t=e.issuer instanceof lf?e.issuer:new lf(e.issuer);a.tbsCertificate.issuer=ih.parse(t.toArrayBuffer(),ix)}let l={hash:"SHA-256"},c="signingKey"in e?{...l,...e.signingAlgorithm,...e.signingKey.algorithm}:{...l,...e.signingAlgorithm},u=oG.resolve(aT);a.tbsCertificate.signature=a.signatureAlgorithm=u.toAsnAlgorithm(c);let h=ih.serialize(a.tbsCertificate),p="signingKey"in e?await t.subtle.sign(c,e.signingKey,h):e.signature,d=oG.resolveAll(lQ).reverse(),f=null;for(let e of d)if(f=e.toAsnSignature(c,p))break;if(!f)throw Error("Cannot convert ASN.1 signature value to WebCrypto format");return a.signatureValue=f,new l9(ih.serialize(a))}}async function ce(e){let t=tu(e);return await crypto.subtle.generateKey(t,!0,["sign","verify"])}async function ct(e){let t=await crypto.subtle.exportKey("pkcs8",e.privateKey);return{privateKeyPem:tp(th(t),"PRIVATE KEY"),publicKeyPem:tp(th(await crypto.subtle.exportKey("spki",e.publicKey)),"PUBLIC KEY"),privateKeyBuffer:t}}async function cr(e,t){let r=e.privateKey.trim();return{signingKey:await crypto.subtle.importKey("pkcs8",function(e){let t=atob(e.split("\n").filter(e=>!e.startsWith("-----")).join("")),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r.buffer}(r),tu(t),!0,["sign"]),issuerDn:new l9(e.certificate).subject}}async function ci(e){let t=function(e){let t=tf(e.subject);if(!t.valid)return t;let r=ty(e.sans);if(!r.valid)return r;let i=tg(e.validity);if(!i.valid)return i;if(e.useExistingCA){var s,n;let t=(s=e.rootCAInput.certificate)&&s.trim()?s.includes("-----BEGIN CERTIFICATE-----")?s.includes("-----END CERTIFICATE-----")?{valid:!0}:{valid:!1,error:"Invalid certificate format. Missing END marker."}:{valid:!1,error:"Invalid certificate format. Must be PEM encoded."}:{valid:!1,error:"Certificate is required"};if(!t.valid)return t;let r=(n=e.rootCAInput.privateKey)&&n.trim()?n.includes("-----BEGIN PRIVATE KEY-----")||n.includes("-----BEGIN RSA PRIVATE KEY-----")||n.includes("-----BEGIN EC PRIVATE KEY-----")?{valid:!0}:{valid:!1,error:"Invalid private key format. Must be PEM encoded."}:{valid:!1,error:"Private key is required"};if(!r.valid)return r}return{valid:!0}}(e);if(!t.valid)return{success:!1,error:t.error};try{var r,i,s;let t,n,o,a;lc.set(crypto);let l=await ce(e.keySettings),c=function(e,t,r,i){let s=[];s.push(new lV(r.isCA,r.pathLengthConstraint??void 0,!0));let n=0;e.digitalSignature&&(n|=ex.digitalSignature),e.keyEncipherment&&(n|=ex.keyEncipherment),e.dataEncipherment&&(n|=ex.dataEncipherment),e.keyAgreement&&(n|=ex.keyAgreement),e.keyCertSign&&(n|=ex.keyCertSign),e.crlSign&&(n|=ex.cRLSign),n>0&&s.push(new lL(n,!0));let o=[];t.serverAuth&&o.push(eb.serverAuth),t.clientAuth&&o.push(eb.clientAuth),t.codeSigning&&o.push(eb.codeSigning),t.emailProtection&&o.push(eb.emailProtection),o.length>0&&s.push(new lR(o,!1));let a=i.filter(e=>e.value&&e.value.trim());if(a.length>0){let e=new lM(a.map(e=>({type:e.type,value:e.value})),!1);s.push(e)}return s}(e.keyUsage,e.extKeyUsage,e.caSettings,e.sans),{notBefore:u,notAfter:h}=(t=(r=e.validity).useCustomDates&&r.customStartDate?new Date(r.customStartDate):new Date,n=new Date(r.useCustomDates&&r.customEndDate?r.customEndDate:t.getTime()+24*r.days*36e5),{notBefore:t,notAfter:n}),p=(i=e.subject,o=[],i.commonName&&o.push(`CN=${tc(i.commonName)}`),i.organization&&o.push(`O=${tc(i.organization)}`),i.organizationalUnit&&o.push(`OU=${tc(i.organizationalUnit)}`),i.locality&&o.push(`L=${tc(i.locality)}`),i.state&&o.push(`ST=${tc(i.state)}`),i.country&&o.push(`C=${tc(i.country)}`),i.email&&o.push(`E=${tc(i.email)}`),o.join(", ")),d=l.privateKey,f=p;if(e.useExistingCA&&e.rootCAInput.certificate&&e.rootCAInput.privateKey){let t=await cr(e.rootCAInput,e.keySettings);d=t.signingKey,f=t.issuerDn}let y=await l7.create({serialNumber:(a=new Uint8Array(16),crypto.getRandomValues(a),Array.from(a).map(e=>e.toString(16).padStart(2,"0")).join("")),subject:p,issuer:f,notBefore:u,notAfter:h,signingAlgorithm:(s=e.keySettings,"ECDSA"===s.algorithm?{name:"ECDSA",hash:s.signingAlgorithm}:{name:"RSASSA-PKCS1-v1_5",hash:s.signingAlgorithm}),publicKey:l.publicKey,signingKey:d,extensions:c}),g=y.toString("pem"),m=y.rawData,{privateKeyPem:v,publicKeyPem:b,privateKeyBuffer:x}=await ct(l);return{success:!0,certificate:{certificate:g,privateKey:v,publicKey:b,certificateDer:m,privateKeyDer:x}}}catch(e){return console.error("Certificate generation error:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error occurred"}}}(m=eP||(eP={}))[m.unspecified=0]="unspecified",m[m.keyCompromise=1]="keyCompromise",m[m.cACompromise=2]="cACompromise",m[m.affiliationChanged=3]="affiliationChanged",m[m.superseded=4]="superseded",m[m.cessationOfOperation=5]="cessationOfOperation",m[m.certificateHold=6]="certificateHold",m[m.removeFromCRL=8]="removeFromCRL",m[m.privilegeWithdrawn=9]="privilegeWithdrawn",m[m.aACompromise=10]="aACompromise",new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,lF.register(iL,lV),lF.register(i6,lR),lF.register(sc,lL),lF.register(sS,lH),lF.register(iD,lD),lF.register(sm,lM),lF.register(iQ,l$),lF.register(iT,lK),lF.register(sa,lG),lX.register(as,lY),lX.register(an,lZ),oG.registerSingleton(lQ,class{toAsnSignature(e,t){return tm.BufferSourceConverter.toArrayBuffer(t)}toWebSignature(e,t){return tm.BufferSourceConverter.toArrayBuffer(t)}}),oG.registerSingleton(lQ,l2),l2.namedCurveSize.set("P-256",32),l2.namedCurveSize.set("K-256",32),l2.namedCurveSize.set("P-384",48),l2.namedCurveSize.set("P-521",66);let cs="cert-generator-data";function cn(){let[e,t]=(0,eR.useState)("webServer"),[r,i]=(0,eR.useState)(e7),[s,n]=(0,eR.useState)(te),[o,a]=(0,eR.useState)(tt),[l,c]=(0,eR.useState)([]),[u,h]=(0,eR.useState)(tr),[p,d]=(0,eR.useState)(ti),[f,y]=(0,eR.useState)(ts),[g,m]=(0,eR.useState)(!1),[v,b]=(0,eR.useState)({certificate:"",privateKey:"",passphrase:""}),[x,S]=(0,eR.useState)(tn),[w,_]=(0,eR.useState)(null),[A,k]=(0,eR.useState)(!1),[C,B]=(0,eR.useState)(null),[N,j]=(0,eR.useState)(!1),[E,O]=(0,eR.useState)("subject"),[I,T]=(0,eR.useState)(!1),{isActive:P,isLoaded:U,data:D,workspaceId:V,save:R}=(0,e9.useToolWorkspace)("cert-generator"),L=(0,eR.useRef)(void 0),H=(0,eR.useRef)(!1),M=(0,eR.useRef)(R);M.current=R,(0,eR.useEffect)(()=>{if(U&&L.current!==V){if(L.current=V,H.current=!0,P&&D)D.preset&&t(D.preset),D.subject&&i(D.subject),D.keySettings&&n(D.keySettings),D.validity&&a(D.validity),D.sans&&c(D.sans),D.keyUsage&&h(D.keyUsage),D.extKeyUsage&&d(D.extKeyUsage),D.caSettings&&y(D.caSettings),D.outputSettings&&S(D.outputSettings);else if(P)t("webServer"),i(e7),n(te),a(tt),c([]),h(tr),d(ti),y(ts),S(tn);else try{let e=localStorage.getItem(cs);if(e){let r=JSON.parse(e);r.preset&&t(r.preset),r.subject&&i(r.subject),r.keySettings&&n(r.keySettings),r.validity&&a(r.validity),r.sans&&c(r.sans),r.keyUsage&&h(r.keyUsage),r.extKeyUsage&&d(r.extKeyUsage),r.caSettings&&y(r.caSettings),r.outputSettings&&S(r.outputSettings)}else t("webServer"),i(e7),n(te),a(tt),c([]),h(tr),d(ti),y(ts),S(tn)}catch{t("webServer"),i(e7),n(te),a(tt),c([]),h(tr),d(ti),y(ts),S(tn)}_(null),requestAnimationFrame(()=>{H.current=!1})}},[U,V,D,P]),(0,eR.useEffect)(()=>{if(!U||void 0===L.current||H.current)return;let t={preset:e,subject:r,keySettings:s,validity:o,sans:l,keyUsage:u,extKeyUsage:p,caSettings:f,outputSettings:x};if(P)M.current(t);else try{localStorage.setItem(cs,JSON.stringify(t))}catch{}},[e,r,s,o,l,u,p,f,x,P,U]),(0,eR.useEffect)(()=>{localStorage.getItem("cert-generator-warning-seen")||T(!0)},[]);let F=(0,eR.useCallback)(()=>{T(!1),localStorage.setItem("cert-generator-warning-seen","true")},[]),z=(0,eR.useCallback)(e=>{t(e);let r=tl[e];h(r.keyUsage),d(r.extKeyUsage),y(r.caSettings),a(e=>({...e,days:r.validityDays})),r.rsaKeySize&&n(e=>({...e,rsaKeySize:r.rsaKeySize})),"wildcard"===e&&i(e=>({...e,commonName:e.commonName&&!e.commonName.startsWith("*.")?"*."+e.commonName:e.commonName})),"custom"===e&&(i(e7),n(te),a(tt),c([]),m(!1),S(tn))},[]),$=(0,eR.useCallback)(()=>{c(e=>[...e,{type:"dns",value:""}])},[]),K=(0,eR.useCallback)(e=>{c(t=>t.filter((t,r)=>r!==e))},[]),W=(0,eR.useCallback)((e,t,r)=>{c(i=>{let s=[...i];return s[e]={...s[e],[t]:r},s})},[]),q=(0,eR.useCallback)(async(e,t)=>{try{await navigator.clipboard.writeText(e),B(t),setTimeout(()=>B(null),2e3),e6.toast.success("Copied to clipboard")}catch{e6.toast.error("Failed to copy")}},[]),G=(0,eR.useCallback)((e,t,r)=>{let i=new Blob([e],{type:r});(0,eL.saveAs)(i,t),e6.toast.success(`Downloaded ${t}`)},[]),J=(0,eR.useCallback)(async()=>{let e=tf(r);if(!e.valid)return void e6.toast.error(e.error);let t=ty(l);if(!t.valid)return void e6.toast.error(t.error);let i=tg(o);if(!i.valid)return void e6.toast.error(i.error);k(!0),_(null);let n=await ci({subject:r,keySettings:s,validity:o,sans:l,keyUsage:u,extKeyUsage:p,caSettings:f,useExistingCA:g,rootCAInput:v});n.success&&n.certificate?(_(n.certificate),e6.toast.success("Certificate generated successfully!")):e6.toast.error(n.error||"Failed to generate certificate"),k(!1)},[r,s,o,l,u,p,f,g,v]);return(0,eU.jsxs)("div",{className:"space-y-6",children:[(0,eU.jsx)(e3.Dialog,{open:I,onOpenChange:T,children:(0,eU.jsxs)(e3.DialogContent,{className:"sm:max-w-md border-amber-200 dark:border-amber-900",children:[(0,eU.jsxs)(e3.DialogHeader,{children:[(0,eU.jsxs)(e3.DialogTitle,{className:"flex items-center gap-2 text-amber-800 dark:text-amber-200",children:[(0,eU.jsx)(eK.AlertTriangle,{className:"h-5 w-5 text-amber-600 dark:text-amber-500"}),"Development/Testing Only"]}),(0,eU.jsx)(e3.DialogDescription,{className:"text-amber-700 dark:text-amber-300 pt-2",children:"These certificates are self-signed and should only be used for development or testing. All cryptographic operations run locally in your browser - private keys never leave your device."})]}),(0,eU.jsx)("div",{className:"flex justify-end pt-4",children:(0,eU.jsx)(eX.Button,{onClick:F,className:"bg-amber-600 hover:bg-amber-700 text-white",children:"I Understand"})})]})}),(0,eU.jsxs)(e8.Card,{children:[(0,eU.jsx)(e8.CardHeader,{className:"pb-3",children:(0,eU.jsxs)(e8.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,eU.jsx)(eq,{className:"h-4 w-4"}),"Certificate Template"]})}),(0,eU.jsx)(e8.CardContent,{children:(0,eU.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-5 gap-2",children:Object.entries(to).map(([t,r])=>(0,eU.jsxs)("button",{onClick:()=>z(t),className:`p-3 rounded-lg border text-left transition-all ${e===t?"border-violet-500 bg-violet-50 dark:bg-violet-950/30":"border-zinc-200 dark:border-zinc-800 hover:border-zinc-300 dark:hover:border-zinc-700"}`,children:[(0,eU.jsx)("p",{className:"font-medium text-sm text-zinc-900 dark:text-zinc-100",children:r.label}),(0,eU.jsx)("p",{className:"text-xs text-zinc-500 dark:text-zinc-400 mt-0.5",children:r.description})]},t))})})]}),(0,eU.jsx)(e8.Card,{children:(0,eU.jsx)(e8.CardContent,{className:"p-0",children:(0,eU.jsxs)(e2.Tabs,{value:E,onValueChange:O,children:[(0,eU.jsx)("div",{className:"border-b border-zinc-200 dark:border-zinc-800 px-4",children:(0,eU.jsxs)(e2.TabsList,{className:"bg-transparent h-12 p-0 gap-4",children:[(0,eU.jsx)(e2.TabsTrigger,{value:"subject",className:"data-[state=active]:bg-transparent data-[state=active]:shadow-none border-b-2 border-transparent data-[state=active]:border-violet-500 rounded-none px-1",children:"Subject"}),(0,eU.jsx)(e2.TabsTrigger,{value:"technical",className:"data-[state=active]:bg-transparent data-[state=active]:shadow-none border-b-2 border-transparent data-[state=active]:border-violet-500 rounded-none px-1",children:"Technical"}),(0,eU.jsx)(e2.TabsTrigger,{value:"extensions",className:"data-[state=active]:bg-transparent data-[state=active]:shadow-none border-b-2 border-transparent data-[state=active]:border-violet-500 rounded-none px-1",children:"Extensions"}),(0,eU.jsx)(e2.TabsTrigger,{value:"ca",className:"data-[state=active]:bg-transparent data-[state=active]:shadow-none border-b-2 border-transparent data-[state=active]:border-violet-500 rounded-none px-1",children:"CA Options"}),(0,eU.jsx)(e2.TabsTrigger,{value:"output",className:"data-[state=active]:bg-transparent data-[state=active]:shadow-none border-b-2 border-transparent data-[state=active]:border-violet-500 rounded-none px-1",children:"Output"})]})}),(0,eU.jsxs)(e2.TabsContent,{value:"subject",className:"p-4 space-y-4 mt-0",children:[(0,eU.jsxs)("p",{className:"text-xs text-muted-foreground mb-2",children:["Fields marked with ",(0,eU.jsx)("span",{className:"text-destructive font-medium",children:"*"})," are required"]}),(0,eU.jsx)("div",{className:"space-y-4",children:(0,eU.jsxs)("h3",{className:"text-sm font-medium flex items-center justify-between",children:[(0,eU.jsx)("span",{children:"Subject Information"}),(0,eU.jsx)(e4.Badge,{variant:"destructive",className:"text-[10px]",children:"Required"})]})}),(0,eU.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:(0,eU.jsxs)("div",{className:"md:col-span-2",children:[(0,eU.jsxs)(e0.Label,{htmlFor:"cn",className:"flex items-center gap-1",children:["Common Name (CN) ",(0,eU.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,eU.jsx)(eQ.Input,{id:"cn",placeholder:"example.com or *.example.com",value:r.commonName,onChange:e=>i({...r,commonName:e.target.value}),className:"mt-1.5",required:!0}),(0,eU.jsx)("p",{className:"text-xs text-zinc-500 mt-1",children:"Primary domain or wildcard domain (required)"})]})}),(0,eU.jsx)("div",{className:"space-y-4 mt-6",children:(0,eU.jsxs)("h3",{className:"text-sm font-medium flex items-center justify-between",children:[(0,eU.jsx)("span",{children:"Organization Details"}),(0,eU.jsx)(e4.Badge,{variant:"secondary",className:"text-[10px]",children:"Optional"})]})}),(0,eU.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,eU.jsxs)("div",{children:[(0,eU.jsx)(e0.Label,{htmlFor:"org",className:"text-muted-foreground",children:"Organization (O)"}),(0,eU.jsx)(eQ.Input,{id:"org",placeholder:"Company Name",value:r.organization,onChange:e=>i({...r,organization:e.target.value}),className:"mt-1.5"}),(0,eU.jsx)("p",{className:"text-xs text-zinc-500 mt-1",children:"Your company or organization name"})]}),(0,eU.jsxs)("div",{children:[(0,eU.jsx)(e0.Label,{htmlFor:"ou",className:"text-muted-foreground",children:"Organizational Unit (OU)"}),(0,eU.jsx)(eQ.Input,{id:"ou",placeholder:"IT Department",value:r.organizationalUnit,onChange:e=>i({...r,organizationalUnit:e.target.value}),className:"mt-1.5"}),(0,eU.jsx)("p",{className:"text-xs text-zinc-500 mt-1",children:"Department or division"})]}),(0,eU.jsxs)("div",{children:[(0,eU.jsx)(e0.Label,{htmlFor:"country",className:"text-muted-foreground",children:"Country (C)"}),(0,eU.jsxs)(e1.Select,{value:r.country,onValueChange:e=>i({...r,country:e}),children:[(0,eU.jsx)(e1.SelectTrigger,{className:"mt-1.5 w-full",children:(0,eU.jsx)(e1.SelectValue,{placeholder:"Select country"})}),(0,eU.jsx)(e1.SelectContent,{children:ta.map(e=>(0,eU.jsxs)(e1.SelectItem,{value:e.code,children:[e.code," - ",e.name]},e.code))})]}),(0,eU.jsx)("p",{className:"text-xs text-zinc-500 mt-1",children:"2-letter country code"})]}),(0,eU.jsxs)("div",{children:[(0,eU.jsx)(e0.Label,{htmlFor:"state",className:"text-muted-foreground",children:"State/Province (ST)"}),(0,eU.jsx)(eQ.Input,{id:"state",placeholder:"California",value:r.state,onChange:e=>i({...r,state:e.target.value}),className:"mt-1.5"}),(0,eU.jsx)("p",{className:"text-xs text-zinc-500 mt-1",children:"State or province name"})]}),(0,eU.jsxs)("div",{children:[(0,eU.jsx)(e0.Label,{htmlFor:"locality",className:"text-muted-foreground",children:"Locality (L)"}),(0,eU.jsx)(eQ.Input,{id:"locality",placeholder:"San Francisco",value:r.locality,onChange:e=>i({...r,locality:e.target.value}),className:"mt-1.5"}),(0,eU.jsx)("p",{className:"text-xs text-zinc-500 mt-1",children:"City or locality name"})]}),(0,eU.jsxs)("div",{children:[(0,eU.jsx)(e0.Label,{htmlFor:"email",className:"text-muted-foreground",children:"Email Address"}),(0,eU.jsx)(eQ.Input,{id:"email",type:"email",placeholder:"admin@example.com",value:r.email,onChange:e=>i({...r,email:e.target.value}),className:"mt-1.5"}),(0,eU.jsx)("p",{className:"text-xs text-zinc-500 mt-1",children:"Contact email for the certificate"})]})]}),(0,eU.jsx)(e5.Separator,{className:"my-4"}),(0,eU.jsxs)("div",{children:[(0,eU.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,eU.jsxs)("div",{className:"flex items-center gap-2",children:[(0,eU.jsx)(e0.Label,{children:"Subject Alternative Names (SANs)"}),(0,eU.jsx)(e4.Badge,{variant:"secondary",className:"text-[10px]",children:"Optional"})]}),(0,eU.jsxs)(eX.Button,{variant:"outline",size:"sm",onClick:$,children:[(0,eU.jsx)(ez.Plus,{className:"h-4 w-4 mr-1"}),"Add SAN"]})]}),(0,eU.jsx)("p",{className:"text-xs text-zinc-500 mb-3",children:"Additional domains or IP addresses (recommended for modern browsers)"}),0===l.length?(0,eU.jsx)("p",{className:"text-sm text-zinc-500 italic",children:"No SANs configured"}):(0,eU.jsx)("div",{className:"space-y-2",children:l.map((e,t)=>(0,eU.jsxs)("div",{className:"flex items-center gap-2",children:[(0,eU.jsxs)(e1.Select,{value:e.type,onValueChange:e=>W(t,"type",e),children:[(0,eU.jsx)(e1.SelectTrigger,{className:"w-24",children:(0,eU.jsx)(e1.SelectValue,{})}),(0,eU.jsxs)(e1.SelectContent,{children:[(0,eU.jsx)(e1.SelectItem,{value:"dns",children:"DNS"}),(0,eU.jsx)(e1.SelectItem,{value:"ip",children:"IP"}),(0,eU.jsx)(e1.SelectItem,{value:"email",children:"Email"})]})]}),(0,eU.jsx)(eQ.Input,{placeholder:"dns"===e.type?"www.example.com":"ip"===e.type?"192.168.1.1":"user@example.com",value:e.value,onChange:e=>W(t,"value",e.target.value),className:"flex-1"}),(0,eU.jsx)(eX.Button,{variant:"ghost",size:"icon",onClick:()=>K(t),className:"text-zinc-400 hover:text-red-500",children:(0,eU.jsx)(e$.Trash2,{className:"h-4 w-4"})})]},t))})]})]}),(0,eU.jsxs)(e2.TabsContent,{value:"technical",className:"p-4 space-y-4 mt-0",children:[(0,eU.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,eU.jsxs)("h3",{className:"text-sm font-medium flex items-center justify-between",children:[(0,eU.jsx)("span",{children:"Key & Validity Settings"}),(0,eU.jsx)(e4.Badge,{variant:"destructive",className:"text-[10px]",children:"Required"})]}),(0,eU.jsx)("p",{className:"text-xs text-muted-foreground",children:"Configure cryptographic algorithm and certificate validity period"})]}),(0,eU.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,eU.jsxs)("div",{children:[(0,eU.jsxs)(e0.Label,{className:"flex items-center gap-1",children:["Key Algorithm ",(0,eU.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,eU.jsxs)(e1.Select,{value:s.algorithm,onValueChange:e=>n({...s,algorithm:e}),children:[(0,eU.jsx)(e1.SelectTrigger,{className:"mt-1.5 w-full",children:(0,eU.jsx)(e1.SelectValue,{})}),(0,eU.jsxs)(e1.SelectContent,{children:[(0,eU.jsx)(e1.SelectItem,{value:"RSA",children:"RSA"}),(0,eU.jsx)(e1.SelectItem,{value:"ECDSA",children:"ECDSA"})]})]})]}),"RSA"===s.algorithm?(0,eU.jsxs)("div",{children:[(0,eU.jsx)(e0.Label,{children:"RSA Key Size"}),(0,eU.jsxs)(e1.Select,{value:s.rsaKeySize,onValueChange:e=>n({...s,rsaKeySize:e}),children:[(0,eU.jsx)(e1.SelectTrigger,{className:"mt-1.5 w-full",children:(0,eU.jsx)(e1.SelectValue,{})}),(0,eU.jsxs)(e1.SelectContent,{children:[(0,eU.jsx)(e1.SelectItem,{value:"2048",children:"2048 bits"}),(0,eU.jsx)(e1.SelectItem,{value:"3072",children:"3072 bits"}),(0,eU.jsx)(e1.SelectItem,{value:"4096",children:"4096 bits"})]})]})]}):(0,eU.jsxs)("div",{children:[(0,eU.jsx)(e0.Label,{children:"ECDSA Curve"}),(0,eU.jsxs)(e1.Select,{value:s.ecdsaCurve,onValueChange:e=>n({...s,ecdsaCurve:e}),children:[(0,eU.jsx)(e1.SelectTrigger,{className:"mt-1.5 w-full",children:(0,eU.jsx)(e1.SelectValue,{})}),(0,eU.jsxs)(e1.SelectContent,{children:[(0,eU.jsx)(e1.SelectItem,{value:"P-256",children:"P-256 (secp256r1)"}),(0,eU.jsx)(e1.SelectItem,{value:"P-384",children:"P-384 (secp384r1)"}),(0,eU.jsx)(e1.SelectItem,{value:"P-521",children:"P-521 (secp521r1)"})]})]})]}),(0,eU.jsxs)("div",{children:[(0,eU.jsx)(e0.Label,{children:"Signing Algorithm"}),(0,eU.jsxs)(e1.Select,{value:s.signingAlgorithm,onValueChange:e=>n({...s,signingAlgorithm:e}),children:[(0,eU.jsx)(e1.SelectTrigger,{className:"mt-1.5 w-full",children:(0,eU.jsx)(e1.SelectValue,{})}),(0,eU.jsxs)(e1.SelectContent,{children:[(0,eU.jsx)(e1.SelectItem,{value:"SHA-256",children:"SHA-256"}),(0,eU.jsx)(e1.SelectItem,{value:"SHA-384",children:"SHA-384"}),(0,eU.jsx)(e1.SelectItem,{value:"SHA-512",children:"SHA-512"})]})]})]}),(0,eU.jsxs)("div",{children:[(0,eU.jsxs)(e0.Label,{className:"flex items-center gap-1",children:["Validity Period ",(0,eU.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,eU.jsxs)("div",{className:"flex items-center gap-2 mt-1.5",children:[(0,eU.jsx)(eQ.Input,{type:"number",min:"1",max:"7300",value:o.days,onChange:e=>a({...o,days:parseInt(e.target.value)||365}),className:"w-24",disabled:o.useCustomDates}),(0,eU.jsx)("span",{className:"text-sm text-zinc-500",children:"days"})]})]})]}),(0,eU.jsxs)("div",{className:"flex items-center gap-2 mt-4",children:[(0,eU.jsx)("input",{type:"checkbox",id:"customDates",checked:o.useCustomDates,onChange:e=>a({...o,useCustomDates:e.target.checked}),className:"rounded border-zinc-300"}),(0,eU.jsx)(e0.Label,{htmlFor:"customDates",className:"text-sm cursor-pointer",children:"Use custom date range"})]}),o.useCustomDates&&(0,eU.jsxs)("div",{className:"grid grid-cols-2 gap-4 mt-2",children:[(0,eU.jsxs)("div",{children:[(0,eU.jsx)(e0.Label,{children:"Start Date"}),(0,eU.jsx)(eQ.Input,{type:"date",value:o.customStartDate,onChange:e=>a({...o,customStartDate:e.target.value}),className:"mt-1.5"})]}),(0,eU.jsxs)("div",{children:[(0,eU.jsx)(e0.Label,{children:"End Date"}),(0,eU.jsx)(eQ.Input,{type:"date",value:o.customEndDate,onChange:e=>a({...o,customEndDate:e.target.value}),className:"mt-1.5"})]})]})]}),(0,eU.jsxs)(e2.TabsContent,{value:"extensions",className:"p-4 space-y-4 mt-0",children:[(0,eU.jsx)("p",{className:"text-xs text-muted-foreground mb-2",children:"Extension fields are optional but recommended for specific use cases"}),(0,eU.jsxs)("div",{children:[(0,eU.jsxs)("div",{className:"flex items-center justify-between",children:[(0,eU.jsx)(e0.Label,{className:"text-base",children:"Key Usage"}),(0,eU.jsx)(e4.Badge,{variant:"secondary",className:"text-[10px]",children:"Optional"})]}),(0,eU.jsx)("p",{className:"text-xs text-zinc-500 mb-3",children:"Define how the certificate key can be used (pre-configured based on template)"}),(0,eU.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[{key:"digitalSignature",label:"Digital Signature"},{key:"keyEncipherment",label:"Key Encipherment"},{key:"dataEncipherment",label:"Data Encipherment"},{key:"keyAgreement",label:"Key Agreement"},{key:"keyCertSign",label:"Certificate Signing"},{key:"crlSign",label:"CRL Signing"}].map(e=>(0,eU.jsxs)("label",{className:"flex items-center gap-2 p-2 rounded border border-zinc-200 dark:border-zinc-800 cursor-pointer hover:bg-zinc-50 dark:hover:bg-zinc-900",children:[(0,eU.jsx)("input",{type:"checkbox",checked:u[e.key],onChange:t=>h({...u,[e.key]:t.target.checked}),className:"rounded border-zinc-300"}),(0,eU.jsx)("span",{className:"text-sm",children:e.label})]},e.key))})]}),(0,eU.jsx)(e5.Separator,{}),(0,eU.jsxs)("div",{children:[(0,eU.jsxs)("div",{className:"flex items-center justify-between",children:[(0,eU.jsx)(e0.Label,{className:"text-base",children:"Extended Key Usage"}),(0,eU.jsx)(e4.Badge,{variant:"secondary",className:"text-[10px]",children:"Optional"})]}),(0,eU.jsx)("p",{className:"text-xs text-zinc-500 mb-3",children:"Additional purposes for certificate usage (pre-configured based on template)"}),(0,eU.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[{key:"serverAuth",label:"Server Auth"},{key:"clientAuth",label:"Client Auth"},{key:"codeSigning",label:"Code Signing"},{key:"emailProtection",label:"Email Protection"}].map(e=>(0,eU.jsxs)("label",{className:"flex items-center gap-2 p-2 rounded border border-zinc-200 dark:border-zinc-800 cursor-pointer hover:bg-zinc-50 dark:hover:bg-zinc-900",children:[(0,eU.jsx)("input",{type:"checkbox",checked:p[e.key],onChange:t=>d({...p,[e.key]:t.target.checked}),className:"rounded border-zinc-300"}),(0,eU.jsx)("span",{className:"text-sm",children:e.label})]},e.key))})]})]}),(0,eU.jsxs)(e2.TabsContent,{value:"ca",className:"p-4 space-y-4 mt-0",children:[(0,eU.jsx)("p",{className:"text-xs text-muted-foreground mb-2",children:"CA options are optional and only needed for certificate authority setups"}),(0,eU.jsxs)("div",{className:"space-y-4",children:[(0,eU.jsxs)("div",{children:[(0,eU.jsxs)("div",{className:"flex items-center justify-between",children:[(0,eU.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,eU.jsx)("input",{type:"checkbox",checked:f.isCA,onChange:e=>y({...f,isCA:e.target.checked}),className:"rounded border-zinc-300"}),(0,eU.jsx)("span",{className:"font-medium",children:"This is a CA Certificate"})]}),(0,eU.jsx)(e4.Badge,{variant:"secondary",className:"text-[10px]",children:"Optional"})]}),(0,eU.jsx)("p",{className:"text-xs text-zinc-500 mt-1 ml-6",children:"Enable if this certificate will sign other certificates"})]}),f.isCA&&(0,eU.jsxs)("div",{className:"ml-6",children:[(0,eU.jsx)(e0.Label,{children:"Path Length Constraint"}),(0,eU.jsxs)(e1.Select,{value:f.pathLengthConstraint?.toString()??"unlimited",onValueChange:e=>y({...f,pathLengthConstraint:"unlimited"===e?null:parseInt(e)}),children:[(0,eU.jsx)(e1.SelectTrigger,{className:"mt-1.5 w-48",children:(0,eU.jsx)(e1.SelectValue,{})}),(0,eU.jsxs)(e1.SelectContent,{children:[(0,eU.jsx)(e1.SelectItem,{value:"unlimited",children:"Unlimited"}),(0,eU.jsx)(e1.SelectItem,{value:"0",children:"0 (Cannot issue sub-CAs)"}),(0,eU.jsx)(e1.SelectItem,{value:"1",children:"1"}),(0,eU.jsx)(e1.SelectItem,{value:"2",children:"2"})]})]}),(0,eU.jsx)("p",{className:"text-xs text-zinc-500 mt-1",children:"How many levels of sub-CAs can be created"})]})]}),(0,eU.jsx)(e5.Separator,{}),(0,eU.jsxs)("div",{className:"space-y-4",children:[(0,eU.jsxs)("div",{children:[(0,eU.jsxs)("div",{className:"flex items-center justify-between",children:[(0,eU.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,eU.jsx)("input",{type:"checkbox",checked:g,onChange:e=>m(e.target.checked),className:"rounded border-zinc-300"}),(0,eU.jsx)("span",{className:"font-medium",children:"Sign with existing Root CA"})]}),(0,eU.jsx)(e4.Badge,{variant:"secondary",className:"text-[10px]",children:"Optional"})]}),(0,eU.jsx)("p",{className:"text-xs text-zinc-500 mt-1 ml-6",children:"Upload an existing CA certificate and key to sign this certificate (leave unchecked for self-signed)"})]}),g&&(0,eU.jsxs)("div",{className:"ml-6 space-y-4 p-4 bg-zinc-50 dark:bg-zinc-900 rounded-lg",children:[(0,eU.jsxs)("div",{children:[(0,eU.jsx)(e0.Label,{children:"CA Certificate (PEM)"}),(0,eU.jsx)("textarea",{placeholder:"-----BEGIN CERTIFICATE----- ... -----END CERTIFICATE-----",value:v.certificate,onChange:e=>b({...v,certificate:e.target.value}),className:"mt-1.5 w-full h-32 px-3 py-2 text-sm font-mono border border-zinc-200 dark:border-zinc-800 rounded-md bg-white dark:bg-zinc-950 resize-none"})]}),(0,eU.jsxs)("div",{children:[(0,eU.jsx)(e0.Label,{children:"CA Private Key (PEM)"}),(0,eU.jsx)("textarea",{placeholder:"-----BEGIN PRIVATE KEY----- ... -----END PRIVATE KEY-----",value:v.privateKey,onChange:e=>b({...v,privateKey:e.target.value}),className:"mt-1.5 w-full h-32 px-3 py-2 text-sm font-mono border border-zinc-200 dark:border-zinc-800 rounded-md bg-white dark:bg-zinc-950 resize-none"})]}),(0,eU.jsxs)("div",{children:[(0,eU.jsx)(e0.Label,{children:"Private Key Passphrase (if encrypted)"}),(0,eU.jsxs)("div",{className:"relative mt-1.5",children:[(0,eU.jsx)(eQ.Input,{type:N?"text":"password",placeholder:"Leave empty if not encrypted",value:v.passphrase,onChange:e=>b({...v,passphrase:e.target.value}),className:"pr-10"}),(0,eU.jsx)("button",{type:"button",onClick:()=>j(!N),className:"absolute right-3 top-1/2 -translate-y-1/2 text-zinc-400 hover:text-zinc-600",children:N?(0,eU.jsx)(eZ.EyeOff,{className:"h-4 w-4"}):(0,eU.jsx)(eY.Eye,{className:"h-4 w-4"})})]})]})]})]})]}),(0,eU.jsxs)(e2.TabsContent,{value:"output",className:"p-4 space-y-4 mt-0",children:[(0,eU.jsx)("p",{className:"text-xs text-muted-foreground mb-2",children:"Output format options (defaults are recommended for most use cases)"}),(0,eU.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,eU.jsxs)("div",{children:[(0,eU.jsxs)("div",{className:"flex items-center justify-between",children:[(0,eU.jsx)(e0.Label,{children:"Certificate Format"}),(0,eU.jsx)(e4.Badge,{variant:"secondary",className:"text-[10px]",children:"Optional"})]}),(0,eU.jsxs)(e1.Select,{value:x.certFormat,onValueChange:e=>S({...x,certFormat:e}),children:[(0,eU.jsx)(e1.SelectTrigger,{className:"mt-1.5 w-full",children:(0,eU.jsx)(e1.SelectValue,{})}),(0,eU.jsxs)(e1.SelectContent,{children:[(0,eU.jsx)(e1.SelectItem,{value:"pem",children:"PEM (Base64)"}),(0,eU.jsx)(e1.SelectItem,{value:"der",children:"DER (Binary)"})]})]})]}),(0,eU.jsxs)("div",{children:[(0,eU.jsxs)("div",{className:"flex items-center justify-between",children:[(0,eU.jsx)(e0.Label,{children:"Private Key Format"}),(0,eU.jsx)(e4.Badge,{variant:"secondary",className:"text-[10px]",children:"Optional"})]}),(0,eU.jsxs)(e1.Select,{value:x.keyFormat,onValueChange:e=>S({...x,keyFormat:e}),children:[(0,eU.jsx)(e1.SelectTrigger,{className:"mt-1.5 w-full",children:(0,eU.jsx)(e1.SelectValue,{})}),(0,eU.jsxs)(e1.SelectContent,{children:[(0,eU.jsx)(e1.SelectItem,{value:"pkcs8",children:"PKCS#8 (Recommended)"}),(0,eU.jsx)(e1.SelectItem,{value:"pkcs1",children:"PKCS#1 (Traditional)"})]})]})]})]}),(0,eU.jsxs)("div",{className:"flex items-center gap-2",children:[(0,eU.jsx)("input",{type:"checkbox",id:"includeChain",checked:x.includeChain,onChange:e=>S({...x,includeChain:e.target.checked}),className:"rounded border-zinc-300",disabled:!g}),(0,eU.jsx)(e0.Label,{htmlFor:"includeChain",className:`text-sm cursor-pointer ${!g?"opacity-50":""}`,children:"Include full certificate chain in output"})]})]})]})})}),(0,eU.jsx)("div",{className:"flex justify-center",children:(0,eU.jsx)(eX.Button,{onClick:J,disabled:A||!r.commonName,size:"lg",className:"bg-gradient-to-r from-violet-500 to-indigo-600 hover:from-violet-600 hover:to-indigo-700 text-white shadow-lg shadow-violet-500/25 px-8",children:A?(0,eU.jsxs)(eU.Fragment,{children:[(0,eU.jsx)("span",{className:"animate-spin mr-2",children:""}),"Generating..."]}):(0,eU.jsxs)(eU.Fragment,{children:[(0,eU.jsx)(eG.Key,{className:"mr-2 h-4 w-4"}),"Generate Certificate"]})})}),w&&(0,eU.jsxs)(e8.Card,{className:"border-green-200 dark:border-green-900",children:[(0,eU.jsx)(e8.CardHeader,{children:(0,eU.jsxs)(e8.CardTitle,{className:"text-base flex items-center gap-2 text-green-700 dark:text-green-400",children:[(0,eU.jsx)(eF.Check,{className:"h-5 w-5"}),"Certificate Generated Successfully"]})}),(0,eU.jsxs)(e8.CardContent,{className:"space-y-4",children:[(0,eU.jsxs)("div",{children:[(0,eU.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,eU.jsxs)(e0.Label,{className:"flex items-center gap-2",children:[(0,eU.jsx)(eJ,{className:"h-4 w-4"}),"Certificate"]}),(0,eU.jsxs)("div",{className:"flex gap-2",children:[(0,eU.jsx)(eX.Button,{variant:"outline",size:"sm",onClick:()=>q(w.certificate,"cert"),children:"cert"===C?(0,eU.jsx)(eF.Check,{className:"h-4 w-4"}):(0,eU.jsx)(eM.Copy,{className:"h-4 w-4"})}),(0,eU.jsx)(eX.Button,{variant:"outline",size:"sm",onClick:()=>G("pem"===x.certFormat?w.certificate:w.certificateDer,`certificate.${"pem"===x.certFormat?"crt":"der"}`,"pem"===x.certFormat?"application/x-pem-file":"application/x-x509-ca-cert"),children:(0,eU.jsx)(eH.Download,{className:"h-4 w-4"})})]})]}),(0,eU.jsx)("pre",{className:"p-3 bg-zinc-100 dark:bg-zinc-900 rounded-lg text-xs font-mono overflow-x-auto max-h-40",children:w.certificate})]}),(0,eU.jsxs)("div",{children:[(0,eU.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,eU.jsxs)(e0.Label,{className:"flex items-center gap-2",children:[(0,eU.jsx)(eG.Key,{className:"h-4 w-4"}),"Private Key",(0,eU.jsx)(e4.Badge,{variant:"destructive",className:"text-[10px]",children:"Keep Secret"})]}),(0,eU.jsxs)("div",{className:"flex gap-2",children:[(0,eU.jsx)(eX.Button,{variant:"outline",size:"sm",onClick:()=>q(w.privateKey,"key"),children:"key"===C?(0,eU.jsx)(eF.Check,{className:"h-4 w-4"}):(0,eU.jsx)(eM.Copy,{className:"h-4 w-4"})}),(0,eU.jsx)(eX.Button,{variant:"outline",size:"sm",onClick:()=>G(w.privateKey,"private.key","application/x-pem-file"),children:(0,eU.jsx)(eH.Download,{className:"h-4 w-4"})})]})]}),(0,eU.jsx)("pre",{className:"p-3 bg-zinc-100 dark:bg-zinc-900 rounded-lg text-xs font-mono overflow-x-auto max-h-40",children:w.privateKey})]}),(0,eU.jsxs)("div",{children:[(0,eU.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,eU.jsxs)(e0.Label,{className:"flex items-center gap-2",children:[(0,eU.jsx)(eq,{className:"h-4 w-4"}),"Public Key"]}),(0,eU.jsxs)("div",{className:"flex gap-2",children:[(0,eU.jsx)(eX.Button,{variant:"outline",size:"sm",onClick:()=>q(w.publicKey,"pub"),children:"pub"===C?(0,eU.jsx)(eF.Check,{className:"h-4 w-4"}):(0,eU.jsx)(eM.Copy,{className:"h-4 w-4"})}),(0,eU.jsx)(eX.Button,{variant:"outline",size:"sm",onClick:()=>G(w.publicKey,"public.pem","application/x-pem-file"),children:(0,eU.jsx)(eH.Download,{className:"h-4 w-4"})})]})]}),(0,eU.jsx)("pre",{className:"p-3 bg-zinc-100 dark:bg-zinc-900 rounded-lg text-xs font-mono overflow-x-auto max-h-40",children:w.publicKey})]}),(0,eU.jsx)("div",{className:"flex justify-center pt-2",children:(0,eU.jsxs)(eX.Button,{onClick:()=>{G(w.certificate,"certificate.crt","application/x-pem-file"),setTimeout(()=>G(w.privateKey,"private.key","application/x-pem-file"),100),setTimeout(()=>G(w.publicKey,"public.pem","application/x-pem-file"),200)},variant:"outline",children:[(0,eU.jsx)(eH.Download,{className:"mr-2 h-4 w-4"}),"Download All Files"]})})]})]})]})}var co=e.i(69216);function ca(){let{zenMode:e}=(0,co.useZenMode)();return(0,eU.jsx)(eV.PageLayout,{toolId:"cert-generator",children:(0,eU.jsxs)("main",{className:`max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 ${e?"py-6 sm:py-8":"py-12 sm:py-16"}`,children:[!e&&(0,eU.jsxs)("div",{className:"text-center mb-12",children:[(0,eU.jsxs)("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-violet-100 dark:bg-violet-900/30 text-violet-700 dark:text-violet-300 text-sm font-medium mb-4",children:[(0,eU.jsx)(eD.Sparkles,{className:"h-4 w-4"}),"Free & Secure"]}),(0,eU.jsxs)("h1",{className:"text-4xl sm:text-5xl font-bold text-zinc-900 dark:text-zinc-100 tracking-tight mb-4",children:["Generate",(0,eU.jsxs)("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-violet-500 to-indigo-600",children:[" ","TLS Certificates"]})]}),(0,eU.jsx)("p",{className:"text-lg text-zinc-600 dark:text-zinc-400 max-w-2xl mx-auto",children:"Create self-signed certificates for development and testing. Generate root CAs, server certificates, and client certificates with full X.509v3 support."})]}),(0,eU.jsx)(cn,{}),!e&&(0,eU.jsxs)("div",{className:"mt-16 grid grid-cols-1 sm:grid-cols-3 gap-6",children:[(0,eU.jsx)(cl,{title:"Full X.509v3 Support",description:"SANs, Key Usage, Extended Key Usage, Basic Constraints, and more"}),(0,eU.jsx)(cl,{title:"RSA & ECDSA",description:"Support for RSA (2048-4096 bit) and ECDSA (P-256, P-384, P-521) keys"}),(0,eU.jsx)(cl,{title:"100% Client-Side",description:"All cryptographic operations run locally. Private keys never leave your browser."})]})]})})}function cl({title:e,description:t}){return(0,eU.jsxs)("div",{className:"rounded-xl border border-zinc-200 dark:border-zinc-800 p-6 bg-white dark:bg-zinc-900/50",children:[(0,eU.jsx)("h3",{className:"font-semibold text-zinc-900 dark:text-zinc-100 mb-2",children:e}),(0,eU.jsx)("p",{className:"text-sm text-zinc-600 dark:text-zinc-400",children:t})]})}e.s(["default",()=>ca],88598)}]);